<!DOCTYPE html>
<html lang="en">

<!-- Head tag -->
<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!--Description-->
    
        <meta name="description" content="这次实验的目的是对局域网内其他设备进行断网操作，及者监听操作。简单分析下ARP协议ARP(Address Resolution Protocol)地址解析协议，是根据IP地址获取其物理地址/MAC地址(硬件地址)的一个TCP/IP协议。它的作用是让局域网内的设备可以正常互相通信。地址解析协议是建立在">
    

    <!--Author-->
    
        <meta name="author" content="0xEaS">
    

    <!--Open Graph Title-->
    
        <meta property="og:title" content="ARP欺骗实验"/>
    

    <!--Open Graph Description-->
    

    <!--Open Graph Site Name-->
    <meta property="og:site_name" content="船到桥头自然直"/>

    <!--Type page-->
    
        <meta property="og:type" content="article" />
    

    <!--Page Cover-->
    

    
        <meta name="twitter:card" content="summary" />
    
    
    

    <!-- Title -->
    
    <title>ARP欺骗实验 - 船到桥头自然直</title>

    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.2/css/bootstrap.min.css" integrity="sha384-y3tfxAZXuh4HwSYylfB+J125MxIs6mR5FOHamPBG064zB+AFeWH94NdvaCBm8qnd" crossorigin="anonymous">

    <!-- Custom Fonts -->
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="//oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="//oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- Gallery -->
    <link href="//cdnjs.cloudflare.com/ajax/libs/featherlight/1.3.5/featherlight.min.css" type="text/css" rel="stylesheet" />

    <!-- Custom CSS -->
    
<link rel="stylesheet" href="/css/style.css">


    <!-- Google Analytics -->
    


<meta name="generator" content="Hexo 5.2.0"><link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css"></head>


<body>

<div class="bg-gradient"></div>
<div class="bg-pattern"></div>

<!-- Menu -->
<!--Menu Links and Overlay-->
<div class="menu-bg">
    <div class="menu-container">
        <ul>
            
            <li class="menu-item">
                <a href="/">
                    Home
                </a>
            </li>
            
            <li class="menu-item">
                <a href="/archives">
                    Archives
                </a>
            </li>
            
            <li class="menu-item">
                <a href="/about.html">
                    About
                </a>
            </li>
            
            <li class="menu-item">
                <a href="/tags">
                    Tags
                </a>
            </li>
            
            <li class="menu-item">
                <a href="/categories">
                    Categories
                </a>
            </li>
            
            <li class="menu-item">
                <a href="/contact.html">
                    Contact
                </a>
            </li>
            
        </ul>
    </div>
</div>

<!--Hamburger Icon-->
<nav>
    <a href="#menu"></a>
</nav>

<div class="container">

    <!-- Main Content -->
    <div class="row">
    <div class="col-sm-12">

        <!--Title and Logo-->
        <header>
    <div class="logo">
        <a href="/"><i class="logo-icon fa fa-cube" aria-hidden="true"></i></a>
        
    </div>
</header>

        <section class="main">
            
<div class="post">

    <div class="post-header">
        <h1 class="title">
            <a href="/2020/12/28/ARP%E6%AC%BA%E9%AA%97%E5%AE%9E%E9%AA%8C/">
                ARP欺骗实验
            </a>
        </h1>
        <div class="post-info">
            
                <span class="date">2020-12-28</span>
            
            
            
        </div>
    </div>

    <div class="content">

        <!-- Gallery -->
        

        <!-- Post Content -->
        <h3 id="这次实验的目的是对局域网内其他设备进行断网操作，及者监听操作。"><a href="#这次实验的目的是对局域网内其他设备进行断网操作，及者监听操作。" class="headerlink" title="这次实验的目的是对局域网内其他设备进行断网操作，及者监听操作。"></a>这次实验的目的是对局域网内其他设备进行断网操作，及者监听操作。</h3><h4 id="简单分析下ARP协议"><a href="#简单分析下ARP协议" class="headerlink" title="简单分析下ARP协议"></a>简单分析下ARP协议</h4><p>ARP(Address Resolution Protocol)地址解析协议，是根据IP地址获取其物理地址/MAC地址(硬件地址)的一个TCP/IP协议。它的作用是让局域网内的设备可以正常互相通信。地址解析协议是建立在网络中各个主机互相信任的基础上的。<u><em>所以存在一个缺点</em></u>，局域网络上的主机可以自主发送ARP应答消息，其他主机收到应答报文时不会检测该报文的真实性就会将其记入本机ARP缓存；由此攻击者就可以向某一主机发送伪ARP应答报文，使其发送的信息无法到达预期的主机或到达错误的主机，这就构成了一个ARP欺骗(ARPspoofing)。</p>
<h4 id="局域网内两台设备如何通信的呢？"><a href="#局域网内两台设备如何通信的呢？" class="headerlink" title="局域网内两台设备如何通信的呢？"></a>局域网内两台设备如何通信的呢？</h4><p>局域网间的两台设备进行通信不是通过IP地址，而是通过MAC地址。</p>
<p>局域网内有3台设备A,B,C。A的IP地址为192.168.1.1，MAC地址为01-01-01-01-01-01。B的IP地址为192.168.1.2，MAC地址为02-02-02-02-02-02。如果知道了对方的MAC地址（MAC地址就像是身份证，IP地址就像是姓名，名字一样的人很多，但身份证是唯一的），就可以进行通信了。如果不知道对方的MAC地址怎么办呢？</p>
<p>之时A会发送一个ARP请求报文，里面包括了源IP地址(A的IP)，源MAC地址。目的IP地址(B的IP)，目的MAC地址(但此时不知道对方的MAC地址，就会设为广播地址FF-FF-FF-FF-FF-FF)。发送给交换机，交换机进行局域网内的广播，这个IP地址是谁的，C看到发现不是自己的IP地址就会丢弃掉，B发现是自己的就会接收，并把自己的MAC地址应答回去。此时应答就不是广播，而是单播。把ARP应答报文发送给交换机，交换机再转发给A。这样A的ARP缓存表里就有B的MAC地址。</p>
<h4 id="ARP欺骗-中间人攻击中的一种-怎么实现呢？"><a href="#ARP欺骗-中间人攻击中的一种-怎么实现呢？" class="headerlink" title="ARP欺骗(中间人攻击中的一种)怎么实现呢？"></a>ARP欺骗(中间人攻击中的一种)怎么实现呢？</h4><p>发现A和B进行通信时，有个中间人进行转发就是交换机。而ARP有个缺点，就是不会检测报文的真实性就会接收。</p>
<p>假如C要知道A和B之间在干啥怎么办呢？C可以发送一个应答报文给A(IP为交换机的IP，MAC地址为C的ACK地址)。这时A就会认为，C是转发人员，把传给B的信息传给C，C可以先把信息内容存起来再转发给B。对B也进行同样的操作，就可以知道A和B之间在干啥了，达到了窃听的效果。</p>
<p>断网就是给A一个假的MAC地址，进行重定性。这样A就上网不了。当然断网没有意思，ARP欺骗主要是用来监听，挂马等操作。</p>
<h4 id="如何进行断网、监听操作呢？"><a href="#如何进行断网、监听操作呢？" class="headerlink" title="如何进行断网、监听操作呢？"></a>如何进行断网、监听操作呢？</h4><p><u><em>前提：须在同一个局域网下，知道对方的IP。</em></u></p>
<p>使用kali作为攻击机。网络连接模式设为桥接模式。</p>
<p>先ifconfig查询自己的网段(192.168.1.  )及网卡信息(例如 eth0)</p>
<p>使用nmap扫描出，同网段下存活的主机IP。</p>
<p>在kali终端输入 route -n 可以查询网关</p>
<h4 id="为啥要查询网关呢？"><a href="#为啥要查询网关呢？" class="headerlink" title="为啥要查询网关呢？"></a>为啥要查询网关呢？</h4><p>一台局域网下的机子，如何访问外网的资源呢？如图</p>
<p><img src="/images/11.png"></p>
<p>会先经过交换机，再经过网关，由网关向外界发送信息，最后再原路返回。</p>
<p>断网操作，骗取机子网关的MAC地址是你的MAC地址，或者是不存在的MAC地址。让数据包走势如图</p>
<p><img src="/images/12.png"></p>
<p>输入 arpspoof -i eth0 -t 目标IP   网关</p>
<p>这样受害机子，就永远发不出包，也就收不到应答包。就上不了网。</p>
<p>监听，让对方能正常上网。但在网站上操作的数据会被你窃取走。</p>
<p>#需先打开IP转发功能。kali默认是关闭的。执行以下命令开启IP转发功能</p>
<p>echo 1 &gt; /proc/sys/net/ipv4/ip_forward</p>
<p>再进行以下操作</p>
<p>arpspoof -i eth0 -t 目标IP   网关</p>
<p>ettercap -Tq -i eth0</p>
<p>就可开启对目标机子的监听了。</p>
<h4 id="最后再附上两张图帮助ARP工作原理，欺骗原理。"><a href="#最后再附上两张图帮助ARP工作原理，欺骗原理。" class="headerlink" title="最后再附上两张图帮助ARP工作原理，欺骗原理。"></a>最后再附上两张图帮助ARP工作原理，欺骗原理。</h4><p><img src="/images/9.png"></p>
<p><img src="/images/10.png"></p>

    </div>

    

    

    <!-- Comments -->
    

</div>
        </section>

    </div>
</div>


</div>

<!-- Footer -->
<div class="push"></div>

<footer class="footer-content">
    <div class="container">
        <div class="row">
            <div class="col-xs-12 col-sm-12 col-md-6 col-lg-6 footer-about">
                <h2>About</h2>
                <p>
                    This theme was developed by <a target="_blank" rel="noopener" href="https://github.com/klugjo">Jonathan Klughertz</a>. The source code is available on Github. Create Websites. Make Magic.
                </p>
            </div>
            
    <div class="col-xs-6 col-sm-6 col-md-3 col-lg-3 recent-posts">
        <h2>Recent Posts</h2>
        <ul>
            
            <li>
                <a class="footer-post" href="/2022/03/10/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AF%87-NTLM-Relay%E6%94%BB%E5%87%BB/">内网渗透篇-NTLM Relay攻击</a>
            </li>
            
            <li>
                <a class="footer-post" href="/2022/03/06/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AF%87-%E9%9D%9E%E7%BA%A6%E6%9D%9F-%E7%BA%A6%E6%9D%9F%E5%A7%94%E6%B4%BE%E6%94%BB%E5%87%BB/">内网渗透篇-非约束/约束委派攻击</a>
            </li>
            
            <li>
                <a class="footer-post" href="/2022/02/24/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AF%87-%E9%9A%A7%E9%81%93%E4%BB%A3%E7%90%86/">内网渗透篇-隧道代理</a>
            </li>
            
            <li>
                <a class="footer-post" href="/2022/02/20/Thinkphp6-0-12LTS%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/">Thinkphp6.0.12LTS反序列化漏洞分析</a>
            </li>
            
        </ul>
    </div>



            
        </div>
        <div class="row">
            <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
                <ul class="list-inline footer-social-icons">
                    
                    <li class="list-inline-item">
                        <a target="_blank" rel="noopener" href="https://github.com/klugjo/hexo-theme-alpha-dust">
                            <span class="footer-icon-container">
                                <i class="fa fa-github"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li class="list-inline-item">
                        <a target="_blank" rel="noopener" href="https://twitter.com/?lang=en">
                            <span class="footer-icon-container">
                                <i class="fa fa-twitter"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li class="list-inline-item">
                        <a target="_blank" rel="noopener" href="https://www.facebook.com/">
                            <span class="footer-icon-container">
                                <i class="fa fa-facebook"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li class="list-inline-item">
                        <a target="_blank" rel="noopener" href="https://www.instagram.com/">
                            <span class="footer-icon-container">
                                <i class="fa fa-instagram"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li class="list-inline-item">
                        <a target="_blank" rel="noopener" href="https://dribbble.com/">
                            <span class="footer-icon-container">
                                <i class="fa fa-dribbble"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li class="list-inline-item">
                        <a target="_blank" rel="noopener" href="https://telegram.org/">
                            <span class="footer-icon-container">
                                <i class="fa fa-telegram"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li class="list-inline-item">
                        <a target="_blank" rel="noopener" href="https://www.behance.net/">
                            <span class="footer-icon-container">
                                <i class="fa fa-behance"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li class="list-inline-item">
                        <a target="_blank" rel="noopener" href="https://500px.com/">
                            <span class="footer-icon-container">
                                <i class="fa fa-500px"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li class="list-inline-item">
                        <a href="mailto:test@example.com">
                            <span class="footer-icon-container">
                                <i class="fa fa-envelope-o"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li class="list-inline-item">
                        <a href="\#">
                            <span class="footer-icon-container">
                                <i class="fa fa-rss"></i>
                            </span>
                        </a>
                    </li>
                    
                </ul>
            </div>
        </div>
        <div class="row">
            <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
                <div class="footer-copyright">
                    @Untitled. All right reserved | Design & Hexo <a target="_blank" rel="noopener" href="http://www.codeblocq.com/">Jonathan Klughertz</a>
                </div>
            </div>
        </div>
    </div>
</footer>

<!-- After footer scripts -->

<!-- jQuery -->
<script src="//code.jquery.com/jquery-2.1.4.min.js"></script>

<!-- Tween Max -->
<script src="//cdnjs.cloudflare.com/ajax/libs/gsap/1.18.5/TweenMax.min.js"></script>

<!-- Gallery -->
<script src="//cdnjs.cloudflare.com/ajax/libs/featherlight/1.3.5/featherlight.min.js" type="text/javascript" charset="utf-8"></script>

<!-- Custom JavaScript -->

<script src="/js/main.js"></script>


<!-- Disqus Comments -->



</body>

</html>